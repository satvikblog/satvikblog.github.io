[{"id":"5a327520fa9108575adc8c8430f6b8a0","title":"Sub Domain Enumeration - THM Walkthrough","content":"Hello Hackers üíåToday we are going to walkthrough a new room called ‚Äú Sub Domain Eneumeration‚Äù on TryHackMeLets start üöÄ\nTASK 1 - BriefSubdomain enumeration is the process of finding valid subdomains for a domain, but why do we do this? We do this to expand our attack surface to try and discover more potential points of vulnerability.\nWe will explore three different subdomain enumeration methods: Brute Force, OSINT (Open-Source Intelligence) and Virtual Host.\nStart the machine and then move onto the next task.\nQuestions and Answers in the task1. What is a subdomain enumeration method beginning with B?Answer: Brute Force2. What is a subdomain enumeration method beginning with O?Answer: OSINT3. What is a subdomain enumeration method beginning with V?Answer: Virtual Hosts\nTASK 2 - OSINT - SSL&#x2F;TLS CertificatesSSL&#x2F;TLS Certificates\nWhen an SSL&#x2F;TLS (Secure Sockets Layer&#x2F;Transport Layer Security) certificate is created for a domain by a CA (Certificate Authority), CA‚Äôs take part in what‚Äôs called ‚ÄúCertificate Transparency (CT) logs‚Äù. These are publicly accessible logs of every SSL&#x2F;TLS certificate created for a domain name. The purpose of Certificate Transparency logs is to stop malicious and accidentally made certificates from being used. We can use this service to our advantage to discover subdomains belonging to a domain, sites like https://crt.sh and https://ui.ctsearch.entrust.com/ui/ctsearchui offer a searchable database of certificates that shows current and historical results.\nGo to crt.sh and search for the domain name tryhackme.com, find the entry that was logged at 2020-12-26 and enter the domain below to answer the question.\nQuestions and Answers in the task1. What domain was logged on crt.sh at 2020-12-26?Answer:\n\nLets visit crt.sh website and search for the records on 2020-12-26\n\n\n\nDomain :  store.tryhackme.com\n\nTASK 3 - OSINT - Search EnginesSearch Engines üßë‚Äçüíª\nSearch engines contain trillions of links to more than a billion websites, which can be an excellent resource for finding new subdomains. Using advanced search methods on websites like Google, such as the site: filter, can narrow the search results. For example, ‚Äú-site:www.domain.com site:*.domain.com‚Äù would only contain results leading to the domain name domain.com but exclude any links to www.domain.com; therefore, it shows us only subdomain names belonging to domain.com.\nGo to Google and use the search term -site:www.tryhackme.com  site:*.tryhackme.com, which should reveal a subdomain for tryhackme.com; use that subdomain to answer the question below.\nQuestions and answers in the task1. What is the TryHackMe subdomain beginning with S discovered using the above Google search?Answer:\n\nGo to google and search for -site:www.tryhackme.com  site:*.tryhackme.com\n\nstore.tryhackme.com\n\nTASK 4 - DNS BruteforceBruteforce DNS (Domain Name System) enumeration is the method of trying tens, hundreds, thousands or even millions of different possible subdomains from a pre-defined list of commonly used subdomains. Because this method requires many requests, we automate it with tools to make the process quicker. In this instance, we are using a tool called dnsrecon to perform this. Click the ‚ÄúView Site‚Äù button to open the static site, press the ‚ÄúRun DNSrecon Request‚Äù button to start the simulation, and then answer the question below.\nQuestions and answers in the task1. What is the first subdomain found with the dnsrecon tool?Answers:\n\nclick on view site and the click on run DNSRecon button\nanswer: api.acmeitsupport.thm\n\nTASK 5 - OSINT - Sublist3rAutomation Using Sublist3rTo speed up the process of OSINT subdomain discovery, we can automate the above methods with the help of tools like Sublist3r, click the ‚ÄúView Site‚Äù button to open up the static site and run the sublist3r simulation to discover a new subdomain that will help answer the question below.\n**Questions and Answers in the task\n1. What is the first subdomain discovered by sublist3r?Answer:\n\nclick on vew site and then click on Run sublist3r\n\n\n\nanswer: web55.acmeitsupport.thm\n\nTASK 6 - Virtual HostsSome subdomains aren‚Äôt always hosted in publically accessible DNS results, such as development versions of a web application or administration portals. Instead, the DNS record could be kept on a private DNS server or recorded on the developer‚Äôs machines in their &#x2F;etc&#x2F;hosts file (or c:\\windows\\system32\\drivers\\etc\\hosts file for Windows users) which maps domain names to IP addresses. \nBecause web servers can host multiple websites from one server when a website is requested from a client, the server knows which website the client wants from the Host header. We can utilise this host header by making changes to it and monitoring the response to see if we‚Äôve discovered a new website.\nLike with DNS Bruteforce, we can automate this process by using a wordlist of commonly used subdomains.\nStart an AttackBox and then try the following command against the Acme IT Support machine to try and discover a new subdomain.\nffuf\n1user@machine$ ffuf -w /usr/share/wordlists/SecLists/Discovery/DNS/namelist.txt -H &quot;Host: FUZZ.acmeitsupport.thm&quot; -u http://MACHINE_IP\nThe above command uses the -w switch to specify the wordlist we are going to use. The -H switch adds&#x2F;edits a header (in this instance, the Host header), we have the FUZZ keyword in the space where a subdomain would normally go, and this is where we will try all the options from the wordlist.\nBecause the above command will always produce a valid result, we need to filter the output. We can do this by using the page size result with the -fs switch. Edit the below command replacing {size} with the most occurring size value from the previous result and try it on the AttackBox.ffuf\n1user@machine$ ffuf -w /usr/share/wordlists/SecLists/Discovery/DNS/namelist.txt -H &quot;Host: FUZZ.acmeitsupport.thm&quot; -u http://MACHINE_IP -fs &#123;size&#125;\nThis command has a similar syntax to the first apart from the -fs switch, which tells ffuf to ignore any results that are of the specified size.\nThe above command should have revealed two positive results that we haven‚Äôt come across before.\nQuestions and Answers in the task1. What is the first subdomain discovered?Answer: \n\nRun the following command to find subdomain \ncommand: ffuf -w namelist.txt -H &quot;Host: FUZZ.acmeitsupport.thm&quot; -u http://10.10.186.57 -fs 2395\n\n\n\ndomain: delta\n\n2. What is the second subdomain discovered?Answer: yellow\nThank You üíåAuthor: Satvik Shettyüßë‚ÄçüíªSee you again in another writeup\n","slug":"Sub-Domain-Enumeration-THM-Walkthrough","date":"2024-05-28T12:45:16.000Z","categories_index":"cybersecurity,THM,web","tags_index":"tryhackme,web","author_index":"Satvik"},{"id":"4c017bf823830f33adecd64aa365ea2f","title":"Linux Fundamentals Module - HTB","content":"Linux StructureHistoryMany events led up to creating the first Linux kernel and, ultimately, the Linux operating system (OS), starting with the Unix operating system‚Äôs release by Ken Thompson and Dennis Ritchie (whom both worked for AT&amp;T at the time) in 1970. The Berkeley Software Distribution (BSD) was released in 1977, but since it contained the Unix code owned by AT&amp;T, a resulting lawsuit limited the development of BSD. Richard Stallman started the GNU project in 1983. His goal was to create a free Unix-like operating system, and part of his work resulted in the GNU General Public License (GPL) being created. Projects by others over the years failed to result in a working, free kernel that would become widely adopted until the creation of the Linux kernel.\nAt first, Linux was a personal project started in 1991 by a Finnish student named Linus Torvalds. His goal was to create a new, free operating system kernel. Over the years, the Linux kernel has gone from a small number of files written in C under licensing that prohibited commercial distribution to the latest version with over 23 million source code lines (comments excluded), licensed under the GNU General Public License v2.\nLinux is available in over 600 distributions (or an operating system based on the Linux kernel and supporting software and libraries). Some of the most popular and well-known being Ubuntu, Debian, Fedora, OpenSUSE, elementary, Manjaro, Gentoo Linux, RedHat, and Linux Mint.\nLinux is generally considered more secure than other operating systems, and while it has had many kernel vulnerabilities in the past, it is becoming less and less frequent. It is less susceptible to malware than Windows operating systems and is very frequently updated. Linux is also very stable and generally affords very high performance to the end-user. However, it can be more difficult for beginners and does not have as many hardware drivers as Windows.\nSince Linux is free and open-source, the source code can be modified and distributed commercially or non-commercially by anyone. Linux-based operating systems run on servers, mainframes, desktops, embedded systems such as routers, televisions, video game consoles, and more. The overall Android operating system that runs on smartphones and tablets is based on the Linux kernel, and because of this, Linux is the most widely installed operating system.\nLinux is an operating system like Windows, iOS, Android, or macOS. An OS is software that manages all of the hardware resources associated with our computer. That means that an OS manages the whole communication between software and hardware. Also, there exist many different distributions (distro). It is like a version of Windows operating systems.\nWith the interactive instances, we get access to the Pwnbox, a customized version of Parrot OS. This will be the primary OS we will work with through the modules. Parrot OS is a Debian-based Linux distribution that focuses on security, privacy, and development.\nPhilosophyLinux follows five core principles:\n\n\n\nPrinciple\nDescription\n\n\n\nEverything is a file\nAll configuration files for the various services running on the Linux operating system are stored in one or more text files.\n\n\nSmall, single-purpose programs\nLinux offers many different tools that we will work with, which can be combined to work together.\n\n\nAbility to chain programs together\nThe integration and combination of different tools enable us to carry out many large and complex tasks, such as processing or filtering specific data results.\n\n\nAvoid captive user interfaces\nLinux is designed to work mainly with the shell (or terminal), which gives the user greater control over the operating system.\n\n\nConfiguration data stored in a text file\nAn example of such a file is the &#x2F;etc&#x2F;passwd file, which stores all users registered on the system.\n\n\nComponents\n\n\nComponent\nDescription\n\n\n\nBootloader\nA piece of code that runs to guide the booting process to start the operating system. Parrot Linux uses the GRUB Bootloader.\n\n\nOS Kernel\nThe kernel is the main component of an operating system. It manages the resources for system‚Äôs I&#x2F;O devices at the hardware level.\n\n\nDaemons\nBackground services are called ‚Äúdaemons‚Äù in Linux. Their purpose is to ensure that key functions such as scheduling, printing, and multimedia are working correctly. These small programs load after we booted or log into the computer.\n\n\nOS Shell\nThe operating system shell or the command language interpreter (also known as the command line) is the interface between the OS and the user. This interface allows the user to tell the OS what to do. The most commonly used shells are Bash, Tcsh&#x2F;Csh, Ksh, Zsh, and Fish.\n\n\nGraphics server\nThis provides a graphical sub-system (server) called ‚ÄúX‚Äù or ‚ÄúX-server‚Äù that allows graphical programs to run locally or remotely on the X-windowing system.\n\n\nWindow Manager\nAlso known as a graphical user interface (GUI). There are many options, including GNOME, KDE, MATE, Unity, and Cinnamon. A desktop environment usually has several applications, including file and web browsers. These allow the user to access and manage the essential and frequently accessed features and services of an operating system.\n\n\nUtilities\nApplications or utilities are programs that perform particular functions for the user or another program.\n\n\nLinux ArchitectureThe Linux operating system can be broken down into layers:\n\n\n\nLayer\nDescription\n\n\n\nHardware\nPeripheral devices such as the system‚Äôs RAM, hard drive, CPU, and others.\n\n\nKernel\nThe core of the Linux operating system whose function is to virtualize and control common computer hardware resources like CPU, allocated memory, accessed data, and others. The kernel gives each process its own virtual resources and prevents&#x2F;mitigates conflicts between different processes.\n\n\nShell\nA command-line interface (CLI), also known as a shell that a user can enter commands into to execute the kernel‚Äôs functions.\n\n\nSystem Utility\nMakes available to the user all of the operating system‚Äôs functionality.\n\n\nFile System HierarchyThe Linux operating system is structured in a tree-like hierarchy and is documented in the Filesystem Hierarchy Standard (FHS). Linux is structured with the following standard top-level directories:\n\n\n\n\nPath\nDescription\n\n\n\n&#x2F;\nThe top-level directory is the root filesystem and contains all of the files required to boot the operating system before other filesystems are mounted as well as the files required to boot the other filesystems. After boot, all of the other filesystems are mounted at standard mount points as subdirectories of the root.\n\n\n&#x2F;bin\nContains essential command binaries.\n\n\n&#x2F;boot\nConsists of the static bootloader, kernel executable, and files required to boot the Linux OS.\n\n\n&#x2F;dev\nContains device files to facilitate access to every hardware device attached to the system.\n\n\n&#x2F;etc\nLocal system configuration files. Configuration files for installed applications may be saved here as well.\n\n\n&#x2F;home\nEach user on the system has a subdirectory here for storage.\n\n\n&#x2F;lib\nShared library files that are required for system boot.\n\n\n&#x2F;media\nExternal removable media devices such as USB drives are mounted here.\n\n\n&#x2F;mnt\nTemporary mount point for regular filesystems.\n\n\n&#x2F;opt\nOptional files such as third-party tools can be saved here.\n\n\n&#x2F;root\nThe home directory for the root user.\n\n\n&#x2F;sbin\nThis directory contains executables used for system administration (binary system files).\n\n\n&#x2F;tmp\nThe operating system and many programs use this directory to store temporary files. This directory is generally cleared upon system boot and may be deleted at other times without any warning.\n\n\n&#x2F;usr\nContains executables, libraries, man files, etc.\n\n\n&#x2F;var\nThis directory contains variable data files such as log files, email in-boxes, web application related files, cron files, and more.\n\n\nLinux DistributionsLinux DistributionsLinux distributions - or distros - are operating systems based on the Linux kernel. They are used for various purposes, from servers and embedded devices to desktop computers and mobile phones. Each Linux distribution is different, with its own set of features, packages, and tools. Some popular examples include:\n\nUbuntu\nFedora\nCentOS\nDebian\nRed Hat Enterprise Linux\n\nMany users choose Linux for their desktop computers because it is free, open source, and highly customizable. Ubuntu and Fedora are two popular choices for desktop Linux and beginners. It is also widely used as a server operating system because it is secure, stable, and reliable and comes with frequent and regular updates. Finally, we, as cybersecurity specialists, often prefer Linux because it is open source, meaning its source code is available for scrutiny and customization. Because of such customization, we can optimize and customize our Linux distribution the way we want and configure it for specific use cases only if necessary.\nWe can use those distros everywhere, including (web) servers, mobile devices, embedded systems, cloud computing, and desktop computing. For cyber security specialists, some of the most popular Linux distributions are but are not limited to:\n\n\n\n\n\n\n\n\n\nParrotOS\t&gt; Ubuntu\t&gt; DebianRaspberry Pi OS\t&gt; CentOS\t&gt; BackBoxBlackArch\t&gt; Pentoo\nThe main differences between the various Linux distributions are the included packages, the user interface, and the tools available. Kali Linux is the most popular distribution for cyber security specialists, including a wide range of security-focused tools and packages. Ubuntu is widespread for desktop users, while Debian is popular for servers and embedded systems. Finally, red Hat Enterprise Linux and CentOS are popular for enterprise-level computing.\nDebianDebian is a widely used and well-respected Linux distribution known for its stability and reliability. It is used for various purposes, including desktop computing, servers, and embedded system. It uses an Advanced Package Tool (apt) package management system to handle software updates and security patches. The package management system helps keep the system up-to-date and secure by automatically downloading and installing security updates as soon as they are available. This can be executed manually or set up automatically.\nDebian can have a steeper learning curve than other distributions, but it is widely regarded as one of the most flexible and customizable Linux distros. The configuration and setup can be complex, but it also provides excellent control over the system, which can be good for advanced users. The more control we have over a Linux system, the more complex it feels to become. However, it just feels that way compared to the options and possibilities we get. Without learning it with the required depth, we might spend way more time configuring ‚Äúeasy‚Äù tasks and processes than when we would learn to use a few commands and tools more in-depth. We will see it in the Filter Contents and Find Files and Directories sections.\nStability and reliability are key strengths of Debian. The distribution is known for its long-term support releases, which can provide updates and security patches for up to five years. This can be especially important for servers and other systems that must be up and running 24&#x2F;7. It has had some vulnerabilities, but the development community has quickly released patches and security updates. In addition, Debian has a strong commitment to security and privacy, and the distribution has a well-established security track record. Debian is a versatile and reliable Linux distribution that is widely used for a range of purposes. Its stability, reliability, and commitment to security make it an attractive choice for various use cases, including cyber security.\nIntroduction to ShellIntroduction to ShellIt is crucial to learn how to use the Linux shell, as there are many servers based on Linux. These are often used because Linux is less error-prone as opposed to Windows servers. For example, web servers are often based on Linux. Knowing how to use the operating system to control it effectively requires understanding and mastering Linux‚Äôs essential part, the Shell. When we first switched from Windows to Linux, does it look something like this:\n\nA Linux terminal, also called a shell or command line, provides a text-based input&#x2F;output (I&#x2F;O) interface between users and the kernel for a computer system. The term console is also typical but does not refer to a window but a screen in text mode. In the terminal window, commands can be executed to control the system.\nWe can think of a shell as a text-based GUI in which we enter commands to perform actions like navigating to other directories, working with files, and obtaining information from the system but with way more capabilities.\nTerminal EmulatorsTerminal emulation is software that emulates the function of a terminal. It allows the use of text-based programs within a graphical user interface (GUI). There are also so-called command-line interfaces (CLI) that run as additional terminals in one terminal. In short, a terminal serves as an interface to the shell interpreter.\nTerminal emulators and multiplexers are beneficial extensions for the terminal. They provide us with different methods and functions to work with the terminal, such as splitting the terminal into one window, working in multiple directories, creating different workspaces, and much more. An example of the use of such a multiplexer called Tmux could look something like this:\n\nShellThe most commonly used shell in Linux is the Bourne-Again Shell (BASH), and is part of the GNU project. Everything we do through the GUI we can do with the shell. The shell gives us many more possibilities to interact with programs and processes to get information faster. Besides, many processes can be easily automated with smaller or larger scripts that make manual work much easier.\nBesides Bash, there also exist other shells like Tcsh&#x2F;Csh, Ksh, Zsh, Fish shell and others.\nPrompt DescriptionPrompt DescriptionThe bash prompt is easy to understand and, by default, includes information such as the user, hostname, and current working directory. It is a string of characters displayed on the terminal screen that indicates that the system is ready for our input. It typically includes information such as the current user, the computer‚Äôs hostname, and the current working directory. The prompt is usually displayed on a new line, and the cursor is positioned after the prompt, ready for the user to start typing a command.\nIt can be customized to provide useful information to the user. The format can look something like this: Prompt Description\n1&lt;username&gt;@&lt;hostname&gt;&lt;current working directory&gt;$\nThe home directory for a user is marked with a tilde &lt;~&gt; and is the default folder when we log in.Prompt Description\n@[~]$12345```The dollar sign, in this case, stands for a user. As soon as we log in as root, the character changes to a hash &lt;#&gt; and looks like this:Prompt Description``` bashroot@htb[/htb]#\nFor example, when we upload and run a shell on the target system, we may not see the username, hostname, and current working directory. This may be due to the PS1 variable in the environment not being set correctly. In this case, we would see the following prompts:\n\nUnprivileged - User Shell PromptPrompt Description\n1$\n\nPrivileged - Root Shell PromptPrompt Description\n1#\nIn addition to providing basic information like the current user and working directory, we can customize to display other information in the prompt, such as the IP address, date, time, the exit status of the last command, and more. This is especially useful for us during our penetration tests because we can use various tools and possibilities like script or the .bash_history to filter and print all the commands we used and sort them by date and time. For example, the prompt could be set to display the full path of the current working directory instead of just the current directory name, which can also include the target‚Äôs IP address if we work organized.\n\n\nThe prompt can be customized using special characters and variables in the shell‚Äôs configuration file (.bashrc for the Bash shell). For example, we can use: the \\u character to represent the current username, \\h for the hostname, and \\w for the current working directory.\n12345678910111213Special Character\tDescription\\d\tDate (Mon Feb 6)\\D&#123;%Y-%m-%d&#125;\tDate (YYYY-MM-DD)\\H\tFull hostname\\j\tNumber of jobs managed by the shell\\n\tNewline\\r\tCarriage return\\s\tName of the shell\\t\tCurrent time 24-hour (HH:MM:SS)\\T\tCurrent time 12-hour (HH:MM:SS)\\@\tCurrent time\\u\tCurrent username\\w\tFull path of the current working directory\nCustomizing the prompt can be a useful way to make your terminal experience more personalized and efficient. It can also be a helpful tool for troubleshooting and problem-solving, as it can provide important information about the system‚Äôs state at any given time.\nIn addition to customizing the prompt, we can customize their terminal environment with different color schemes, fonts, and other settings to make their work environment more visually appealing and easier to use.\nHowever, we see the same as when working on the Windows GUI here. We are logged in as a user on a computer with a specific name, and we know which directory we are in when we navigate through our system. Bash prompt can also be customized and changed to our own needs. The adjustment of the bash prompt is outside the scope of this module. However, we can look at the bash-prompt-generator and powerline, which gives us the possibility to adapt our prompt to our needs.\nGetting HelpGetting HelpWe will always stumble across tools whose optional parameters we do not know from memory or tools we have never seen before. Therefore it is vital to know how we can help ourselves to get familiar with those tools. The first two ways are the man pages and the help functions. It is always a good idea to familiarize ourselves with the tool we want to try first. We will also learn some possible tricks with some of the tools that we thought were not possible. In the man pages, we will find the detailed manuals with detailed explanations.\nSyntax:Getting Help\n1satvikbash@htb[/htb]$ man &lt;tool&gt;\n\nLet us have a look at an example:\nExample:\n\nGetting Help1satvikbash@htb[/htb]$ man curl\nGetting Help1234567891011121314151617curl(1)                                                             Curl Manual                                                            curl(1)NAME       curl - transfer a URLSYNOPSIS       curl [options] [URL...]DESCRIPTION       curl  is  a tool to transfer data from or to a server, using one of the supported protocols (DICT, FILE, FTP, FTPS, GOPHER, HTTP, HTTPS,         IMAP, IMAPS,  LDAP,  LDAPS,  POP3,  POP3S,  RTMP, RTSP, SCP, SFTP, SMB, SMBS, SMTP, SMTPS, TELNET, and TFTP). The command is designed to work without user interaction.       curl offers a busload of useful tricks like proxy support, user authentication, FTP upload, HTTP post, SSL connections, cookies, file transfer resume, Metalink,  and more. As we will see below, the number of features will make our head spin!       curl is powered by libcurl for all transfer-related features.  See libcurl(3) for details.Manual page curl(1) line 1 (press h for help or q to quit)\n\nAfter looking at some examples, we can also quickly look at the optional parameters without browsing through the complete documentation. We have several ways to do that.\n\nSyntax:Getting Help1satvikbash@htb[/htb]$ &lt;tool&gt; --help\nExample:Getting Help1234567891011satvikbash@htb[/htb]$ curl --helpUsage: curl [options...] &lt;url&gt;     --abstract-unix-socket &lt;path&gt; Connect via abstract Unix domain socket     --anyauth       Pick any authentication method -a, --append        Append to target file when uploading     --basic         Use HTTP Basic Authentication     --cacert &lt;file&gt; CA certificate to verify peer against     --capath &lt;dir&gt;  CA directory to verify peer against -E, --cert &lt;certificate[:password]&gt; Client certificate file and password&lt;SNIP&gt;\nWe can also use the short version of it:\n\nSyntax:  Getting Help  1satvikbash@htb[/htb]$ &lt;tool&gt; -h\n\nExample:Getting Help1234567891011satvikbash@htb[/htb]$ curl -hUsage: curl [options...] &lt;url&gt;     --abstract-unix-socket &lt;path&gt; Connect via abstract Unix domain socket     --anyauth       Pick any authentication method -a, --append        Append to target file when uploading     --basic         Use HTTP Basic Authentication     --cacert &lt;file&gt; CA certificate to verify peer against     --capath &lt;dir&gt;  CA directory to verify peer against -E, --cert &lt;certificate[:password]&gt; Client certificate file and password&lt;SNIP&gt;\nAs we can see, the results from each other do not differ in this example. Another tool that can be useful in the beginning is apropos. Each manual page has a short description available within it. This tool searches the descriptions for instances of a given keyword.\n\nSyntax:  Getting Help\n1satvikbash@htb[/htb]$ apropos &lt;keyword&gt;\n\nExample:Getting Help12345678910satvikbash@htb[/htb]$ apropos sudosudo (8)             - execute a command as another usersudo.conf (5)        - configuration for sudo front endsudo_plugin (8)      - Sudo Plugin APIsudo_root (8)        - How to run administrative commandssudoedit (8)         - execute a command as another usersudoers (5)          - default sudo security policy pluginsudoreplay (8)       - replay sudo session logsvisudo (8)           - edit the sudoers file\nAnother useful resource to get help if we have issues to understand a long command is: https://explainshell.com/\n\nSystem InformationSince we will be working with many different Linux systems, we needto learn the structure and the information about the system, itsprocesses, network configurations, users, directories, user settings,and the corresponding parameters. Here is a list of the necessary toolsthat will help us get the above information. Most of them are installedby default.\n\n\n\nCommand\nDescription\n\n\n\nwhoami\nDisplays current username.\n\n\nid\nReturns users identity\n\n\nhostname\nSets or prints the name of current host system.\n\n\nuname\nPrints basic information about the operating system name and system hardware.\n\n\npwd\nReturns working directory name.\n\n\nifconfig\nThe ifconfig utility is used to assign or to view an address to a\n\n\nnetwork interface and&#x2F;or configure network interface parameters.\n\n\n\nip\nIp is a utility to show or manipulate routing, network devices, interfaces and tunnels.\n\n\nnetstat\nShows network status.\n\n\nss\nAnother utility to investigate sockets.\n\n\nps\nShows process status.\n\n\nwho\nDisplays who is logged in.\n\n\nenv\nPrints environment or sets and executes command.\n\n\nlsblk\nLists block devices.\n\n\nlsusb\nLists USB devices\n\n\nlsof\nLists opened files.\n\n\nlspci\nLists PCI devices.\n\n\nLet us look at a few examples.\nHostnameThe hostname command is pretty self-explanatory and will just print the name of the computer that we are logged into\n12satvik@htb[/htb]$ hostnamenixfund\n\nWhoamiThis quick and easy command can be used on both Windows and Linuxsystems to get our current username. During a security assessment, weobtain reverse shell access on a host, and one of the first bits ofsituational awareness we should do is figuring out what user we arerunning as. From there, we can figure out if the user has any specialprivileges&#x2F;access.\n12cry0l1t3@htb[/htb]$ whoamicry0l1t3\n\nIdThe id command expands on the whoamicommand and prints out our effective group membership and IDs. This canbe of interest to penetration testers looking to see what access a usermay have and sysadmins looking to audit account permissions and groupmembership. In this output, the hackthebox group is of interest because it is non-standard, the adm group means that the user can read log files in /var/log and could potentially gain access to sensitive information, membership in the sudo group is of particular interest as this means our user can run some or all commands as the all-powerful root user. Sudo rights could help us escalate privileges or could be a signto a sysadmin that they may need to audit permissions and groupmemberships to remove any access that is not required for a given userto carry out their day-to-day tasks.\n12cry0l1t3@htb[/htb]$ iduid=1000(cry0l1t3) gid=1000(cry0l1t3) groups=1000(cry0l1t3),1337(hackthebox),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),116(lpadmin),126(sambashare)\n\nUnameLet‚Äôs dig into the uname command a bit more. If we type man uname in our terminal, we will bring up the man page for the command, whichwill show the possible options we can run with the command and theresults.\n123456789101112131415161718192021222324252627282930313233343536373839404142434445UNAME(1)                                    User Commands                                   UNAME(1)NAME       uname - print system informationSYNOPSIS       uname [OPTION]...DESCRIPTION       Print certain system information.  With no OPTION, same as -s.       -a, --all              print all information, in the following order, except omit -p and -i if unknown:       -s, --kernel-name              print the kernel name       -n, --nodename              print the network node hostname       -r, --kernel-release              print the kernel release       -v, --kernel-version              print the kernel version       -m, --machine              print the machine hardware name       -p, --processor              print the processor type (non-portable)       -i, --hardware-platform              print the hardware platform (non-portable)       -o, --operating-system``` bashRunning `uname -a` will print all information about the machine in a specific order: kernel name, hostname, the kernel release, kernel version, machine hardware name, and operating system. The `-a` flag will omit `-p` (processor type) and `-i` (hardware platform)  if they are unknown.``` bashcry0l1t3@htb[/htb]$ uname -aLinux box 4.15.0-99-generic #100-Ubuntu SMP Wed Apr 22 20:32:56 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\n\nFrom the above command, we can see that the kernel name is Linux, the hostname is box, the kernel release is 4.15.0-99-generic, the kernel version is #100-Ubuntu SMP Wed Apr 22 20:32:56 UTC 2020, and so on. Running any of these options on their own will give us the specific bit output we are interested in.\nUname to Obtain Kernel ReleaseSuppose we want to print out the kernel release to search for potential kernel exploits quickly. We can type uname -r to obtain this information.\n12cry0l1t3@htb[/htb]$ uname -r4.15.0-99-generic\n\nWith this info, we could go and search for ‚Äú4.15.0-99-generic exploit,‚Äù and the first  result immediately appears useful to us.\nIt is highly recommended to study the commands and understand whatthey are for and what information they can provide. Though a bittedious, we can learn much from studying the manpages for commoncommands. We may even find out things that we did not even know werepossible with a given command. This information is not only used forworking with Linux. However, it will also be used later to discovervulnerabilities and misconfigurations on the Linux system that maycontribute to privilege escalation. Here are a few optional exercisesthat we can solve for practice purposes, which will help us becomefamiliar with some of the commands.\nLogging In via SSHSecure Shell (SSH) refers to a protocolthat allows clients to access and execute commands or actions on remotecomputers. On Linux-based hosts and servers running or another Unix-like operating system, SSH is one of the permanently installed standardtools and is the preferred choice for many administrators to configureand maintain a computer through remote access. It is an older and veryproven protocol that does not require or offer a graphical userinterface (GUI). For this reason, it works very efficiently and occupies very few resources. We use this type of connection in the followingsections and in most of the other modules to offer the possibility totry out the learned commands and actions in a safe environment. We canconnect to our targets with the following command:\nSSH Login1satvikbash@htb[/htb]$ ssh [username]@[IP address]\n\nNavigationNavigation is essential, like working with the mouse as a standardWindows user. With it, we move across the system and work in directories and with files, we need and want. Therefore, we use different commandsand tools to print out information about a directory or a file and canuse advanced options to optimize the output to our needs.\nOne of the best ways to learn something new is to experiment with it. Here we cover the sections on navigating through Linux, creating,moving, editing, and deleting files and folders, finding them on theoperating system, different types of redirects, and what filedescriptors are. We will also find shortcuts to make our work with theshell much easier and more comfortable. We recommend experimenting onour locally hosted VM. Ensure we have created a snapshot for our VM incase our system gets unexpectedly damaged.\nLet us start with the navigation. Before we move through the system,we have to find out in which directory we are. We can find out where weare with the command pwd.\n12cry0l1t3@htb[~]$ pwd/home/cry0l1t3\n\nOnly the ls command is needed to list all the contentsinside a directory. It has many additional options that can complementthe display of the content in the current folder.\n12cry0l1t3@htb[~]$ lsDesktop  Documents  Downloads  Music  Pictures  Public  Templates  Videos\n\nUsing it without any additional options will display the directories and files only. However, we can also add the -l option to display more information on those directories and files.\n12345678910cry0l1t3@htb[~]$ ls -ltotal 32drwxr-xr-x 2 cry0l1t3 htbacademy 4096 Nov 13 17:37 Desktopdrwxr-xr-x 2 cry0l1t3 htbacademy 4096 Nov 13 17:34 Documentsdrwxr-xr-x 3 cry0l1t3 htbacademy 4096 Nov 15 03:26 Downloadsdrwxr-xr-x 2 cry0l1t3 htbacademy 4096 Nov 13 17:34 Musicdrwxr-xr-x 2 cry0l1t3 htbacademy 4096 Nov 13 17:34 Picturesdrwxr-xr-x 2 cry0l1t3 htbacademy 4096 Nov 13 17:34 Publicdrwxr-xr-x 2 cry0l1t3 htbacademy 4096 Nov 13 17:34 Templatesdrwxr-xr-x 2 cry0l1t3 htbacademy 4096 Nov 13 17:34 Videos\n\nFirst, we see the total amount of blocks (512-byte) used by the files and directories listed in the current directory, whichindicates the total size used. That means it used 32 * 512-byte &#x3D; 16384 bytes of disk space. Next, we see a few columns that are structured as follows:\n\n\n\nColumn Content\nDescription\n\n\n\ndrwxr-xr-x\nType and permissions\n\n\n2\nNumber of hard links to the file&#x2F;directory\n\n\ncry0l1t3\nOwner of the file&#x2F;directory\n\n\nhtbacademy\nGroup owner of the file&#x2F;directory\n\n\n4096\nSize of the file or the number of blocks used to store the directory information\n\n\nNov 13 17:37\nDate and time\n\n\nDesktop\nDirectory name\n\n\nHowever, we will not see everything that is in this folder. Adirectory can also have hidden files that start with a dot at thebeginning of its name (e.g., .bashrc or .bash_history). Therefore, we need to use the command ls -la to list all files of a directory:\n12345678910111213cry0l1t3@htb[~]$ ls -latotal 403188drwxr-xr-x 2 cry0l1t3 htbacademy 4096 Nov 13 17:37 .bash_historydrwxr-xr-x 2 cry0l1t3 htbacademy 4096 Nov 13 17:37 .bashrc...SNIP...drwxr-xr-x 2 cry0l1t3 htbacademy 4096 Nov 13 17:37 Desktopdrwxr-xr-x 2 cry0l1t3 htbacademy 4096 Nov 13 17:34 Documentsdrwxr-xr-x 3 cry0l1t3 htbacademy 4096 Nov 15 03:26 Downloadsdrwxr-xr-x 2 cry0l1t3 htbacademy 4096 Nov 13 17:34 Musicdrwxr-xr-x 2 cry0l1t3 htbacademy 4096 Nov 13 17:34 Picturesdrwxr-xr-x 2 cry0l1t3 htbacademy 4096 Nov 13 17:34 Publicdrwxr-xr-x 2 cry0l1t3 htbacademy 4096 Nov 13 17:34 Templatesdrwxr-xr-x 2 cry0l1t3 htbacademy 4096 Nov 13 17:34 Videos\n\nTo list the contents of a directory, we do not necessarily need to navigate there first. We can also use ‚Äúls‚Äù to specify the path where we want to know the contents.\n12345678cry0l1t3@htb[~]$ ls -l /var/total 52drwxr-xr-x  2 root root     4096 Mai 15 18:54 backupsdrwxr-xr-x 18 root root     4096 Nov 15 16:55 cachedrwxrwsrwt  2 root whoopsie 4096 Jul 25  2018 crashdrwxr-xr-x 66 root root     4096 Mai 15 03:08 libdrwxrwsr-x  2 root staff    4096 Nov 24  2018 local&lt;SNIP&gt;\n\nWe can do the same thing to navigate to the directory. To move through the directories, we use the command cd. Let us change to the /dev/shm directory. Of course, we can go to the /dev directory first and then /shm. Nevertheless, we can also enter the full path and jump there.\n12cry0l1t3@htb[~]$ cd /dev/shmcry0l1t3@htb[/dev/shm]$\n\nSince we were in the home directory before, we can quickly jump back to the directory we were last in.\n12cry0l1t3@htb[/dev/shm]$ cd -cry0l1t3@htb[~]$\n\nThe shell also offers us the auto-complete function, which makes navigation easier. If we now type cd /dev/s and press [TAB] twice, we will get all entries starting with the letter ‚Äús‚Äù in the directory of /dev/.\n12cry0l1t3@htb[~]$ cd /dev/s [TAB 2x]shm/ snd/\n\nIf we add the letter ‚Äúh‚Äù to the letter ‚Äús,‚Äù the shell will complete the input since otherwise there will be no folders in this directory beginning with the letters ‚Äúsh‚Äù. If we now display all contents of the directory, we will only see the following contents.\n1234cry0l1t3@htb[/dev/shm]$ ls -la /dev/shmtotal 0drwxrwxrwt  2 root root   40 Mai 15 18:31 .drwxr-xr-x 17 root root 4000 Mai 14 20:45 ..\n\nThe first entry with a single dot (.) indicates the current directory we are currently in. The second entry with two dots (..) represents the parent directory /dev. This means we can jump to the parent directory with the following command.\n12cry0l1t3@htb[/dev/shm]$ cd ..cry0l1t3@htb[/dev]$\n\nSince our shell is filled with some records, we can clean the shell with the command clear. First, however, let us return to the directory /dev/shm before and then execute the clear command to clean up our terminal.\n1cry0l1t3@htb[/dev]$ cd shm &amp;&amp; clear\n\nAnother way to clean up our terminal is to use the shortcut [Ctrl] + [L]. We can also use the arrow keys (‚Üë or ‚Üì) to scroll through the command history, which will show us the commandsthat we have used before. But we also can search through the commandhistory using the shortcut [Ctrl] + [R] and type some of the text that we are looking for.\nSTAY TUNED üßë‚ÄçüíªCONTENT WILL UPDATE SOON üòÅ\n","slug":"Linux-Fundamentals-Module-HTB","date":"2024-05-27T17:47:53.000Z","categories_index":"HTB,cybersecurity,Linux","tags_index":"cybersecurity,Linux","author_index":"Satvik"},{"id":"ec2c0857db02e59b1fe7edb40ad2f3b4","title":"Content Discovery - THM Walkthrough","content":"Hello Hackers üíåToday we are gonna walkthrough a new room in Web Fundamentals called Content Discovery on #TryHackMeLets start üöÄ\nTASK 1 - What is content DiscoveryFirstly, we should ask, in the context of web application security, what is content? Content can be many things, a file, video, picture, backup, a website feature. When we talk about content discovery, we‚Äôre not talking about the obvious things we can see on a website; it‚Äôs the things that aren‚Äôt immediately presented to us and that weren‚Äôt always intended for public access.\nThis content could be, for example, pages or portals intended for staff usage, older versions of the website, backup files, configuration files, administration panels, etc.\nThere are three main ways of discovering content on a website which we‚Äôll cover. Manually, Automated and OSINT (Open-Source Intelligence).\nQuestions and Answers in the Task1. What is the Content Discovery method that begins with M?Answer:Manually\n2. What is the Content Discovery method that begins with A?Answer:Automated\n3. What is the Content Discovery method that begins with O?Answer:OSINT\nTASK 2 - Manual Discovery - Robots.txtThere are multiple places we can manually check on a website to start discovering more content. \nRobots.txt\nThe robots.txt file is a document that tells search engines which pages they are and aren‚Äôt allowed to show on their search engine results or ban specific search engines from crawling the website altogether. It can be common practice to restrict certain website areas so they aren‚Äôt displayed in search engine results. These pages may be areas such as administration portals or files meant for the website‚Äôs customers. This file gives us a great list of locations on the website that the owners don‚Äôt want us to discover as penetration testers.\nTake a look at the robots.txt file on the Acme IT Support website to see if they have anything they don‚Äôt want to list - To do this open Firefox on the AttackBox, and enter the url: http://MACHINE_IP/robots.txt (this URL will update 2 minutes from when you start the machine in task 1)\nQuestions and Answers in the task1 . What is the directory in the robots.txt that isn‚Äôt allowed to be viewed by web crawlers?Answer:\n\nto know the answer , we need to visit /robots.txt\n\n\n\nso it‚Äôs disallowing search enginers to crawl over /staff-portal page \nso the answer is /staff-portal\n\nTASK 3 - Manual Discovery - FaviconFavicon\nThe favicon is a small icon displayed in the browser‚Äôs address bar or tab used for branding a website.\n\nSometimes when frameworks are used to build a website, a favicon that is part of the installation gets leftover, and if the website developer doesn‚Äôt replace this with a custom one, this can give us a clue on what framework is in use. OWASP host a database of common framework icons that you can use to check against the targets favicon https://wiki.owasp.org/index.php/OWASP_favicon_database. Once we know the framework stack, we can use external resources to discover more about it (see next section).\nPractical Exercise:\nOn the AttackBox, open firefox and enter the url https://static-labs.tryhackme.cloud/sites/favicon/ here you‚Äôll see a basic website with a note saying ‚ÄúWebsite coming soon‚Ä¶‚Äù, if you look at your tabs you‚Äôll notice an icon that confirms this site is using a favicon.\nViewing the page source you‚Äôll see line six contains a link to the images&#x2F;favicon.ico file. \n\nIf you run the following command on the AttackBox, it will download the favicon and get its md5 hash value which you can then lookup on thehttps://wiki.owasp.org/index.php/OWASP_favicon_database.\ncurl\n1user@machine$ curl https://static-labs.tryhackme.cloud/sites/favicon/images/favicon.ico | md5sum\nNote: This curl will fail on the AttackBox if you are a free user, in which case you should use a VM for this. If your hash ends with 427e then your curl failed, and you may need to try it again. You could also run this on Windows in Powershell as shown below.\n12PS C:\\&gt; curl https://static-labs.tryhackme.cloud/sites/favicon/images/favicon.ico -UseBasicParsing -o favicon.icoPS C:\\&gt; Get-FileHash .\\favicon.ico -Algorithm MD5 \n\nQuestions and answers in this task1. What framework did the favicon belong to?Answer:\n\nlets download the favicon of the site and extract its checksum first\ncommand:curl https://static-labs.tryhackme.cloud/sites/favicon/images/favicon.ico | md5sum\n\n\n\nnow copy the checksum we got and look out for any matches on OWASP Website\n\n\n\nso the favicon belongs to cgiirc framework\n\nTASK 4 - Manual Discovery - Sitemap.xmlSitemap.xml\nUnlike the robots.txt file, which restricts what search engine crawlers can look at, the sitemap.xml file gives a list of every file the website owner wishes to be listed on a search engine. These can sometimes contain areas of the website that are a bit more difficult to navigate to or even list some old webpages that the current site no longer uses but are still working behind the scenes.\nTake a look at the sitemap.xml file on the Acme IT Support website to see if there‚Äôs any new content we haven‚Äôt yet discovered: http://10.10.80.162/sitemap.xml (open this in the FireFox browser on the AttackBox).\nQUestions and Answers in the Task1. What is the path of the secret area that can be found in the sitemap.xml file?Answer:\n\nLets visit /sitemap.xml page and analyze it\n\n\n\nSo the answer is /s3cr3t-area\n\nTASK 5 Manual Discover - HTTP HEADERSHTTP Headers\nWhen we make requests to the web server, the server returns various HTTP headers. These headers can sometimes contain useful information such as the webserver software and possibly the programming&#x2F;scripting language in use. In the below example, we can see the webserver is NGINX version 1.18.0 and runs PHP version 7.4.3. Using this information, we could find vulnerable versions of software being used. Try running the below curl command against the web server, where the -v switch enables verbose mode, which will output the headers (there might be something interesting!).\nQuestions and Answers in the task1. What is the flag value from the X-FLAG header?answer:\n\nLets check the HTTP Response first \ncommand: curl http://10.10.80.162 -v\n\n\n\nFlag is &#96;THM{HEADER_FLAG}\n\nTASK 6 - Manual Discovery - Framework StackFramework Stack\nOnce you‚Äôve established the framework of a website, either from the above favicon example or by looking for clues in the page source such as comments, copyright notices or credits, you can then locate the framework‚Äôs website. From there, we can learn more about the software and other information, possibly leading to more content we can discover.\nLooking at the page source of our Acme IT Support website (http://10.10.80.162), you‚Äôll see a comment at the end of every page with a page load time and also a link to the framework‚Äôs website, which is https://static-labs.tryhackme.cloud/sites/thm-web-framework. Let‚Äôs take a look at that website. Viewing the documentation page gives us the path of the framework‚Äôs administration portal, which gives us a flag if viewed on the Acme IT Support website.\nQuestions and Answers in the task1. What is the flag from the framework‚Äôs administration portal?Answer:\n\nLets visit documentation first\nhttps://static-labs.tryhackme.cloud/sites/thm-web-framework/documentation.html\n\n \n\nwe got the credentials of web-framework\n\nnow lets login and check if it has anything for us \n\nflag: THM&#123;CHANGE_DEFAULT_CREDENTIALS&#125;\n\n\nTASK 7 - OSINT - Google Hacking &#x2F; DorkingThere are also external resources available that can help in discovering information about your target website; these resources are often referred to as OSINT or (Open-Source Intelligence) as they‚Äôre freely available tools that collect information:\nGoogle Hacking &#x2F; Dorking\nGoogle hacking &#x2F; Dorking utilizes Google‚Äôs advanced search engine features, which allow you to pick out custom content. You can, for instance, pick out results from a certain domain name using the site: filter. For example, site:tryhackme.com will only return results from the tryhackme.com website. You can then match this up with certain search terms. For example, the word admin (site:tryhackme.com admin) will return results from the tryhackme.com website that contain the word admin in its content. You can combine multiple filters as well. Here are some examples of more filters you can use:\n\n\n\nFilter\nExample\nDescription\n\n\n\nsite\nsite:tryhackme.com\nReturns results only from the specified website address\n\n\ninurl\ninurl:admin\nReturns results that have the specified word in the URL\n\n\nfiletype\nfiletype:pdf\nReturns results which are a particular file extension\n\n\nintitle\nintitle:admin\nReturns results that contain the specified word in the title\n\n\nMore information about google hacking can be found here: Google hacking\nQuestions and answers in the task1. What Google dork operator can be used to only show results from a particular site?Answer: site:\nTASK 8 - OSINT - WappalyzerWappalyzer\nWappalyzer (https://www.wappalyzer.com/) is an online tool and browser extension that helps identify what technologies a website uses, such as frameworks, Content Management Systems (CMS), payment processors and much more, and it can even find version numbers as well.\nQuestions and Answers in the task1. What online tool can be used to identify what technologies a website is running?Answer: wappalyzer\nTASK 9 - OSINT Wayback MachineWayback Machine\nThe Wayback Machine (https://archive.org/web/) is a historical archive of websites that dates back to the late 90s. You can search a domain name, and it will show you all the times the service scraped the web page and saved the contents. This service can help uncover old pages that may still be active on the current website.\nQuestions and answers in the task1. What is the website address for the Wayback Machine?Answer: https://archive.org/web/\nTASK 10 - OSINT GITHUBGitHub\nTo understand GitHub, you first need to understand Git. Git is a version control system that tracks changes to files in a project. Working in a team is easier because you can see what each team member is editing and what changes they made to files. When users have finished making their changes, they commit them with a message and then push them back to a central location (repository) for the other users to then pull those changes to their local machines. GitHub is a hosted version of Git on the internet. Repositories can either be set to public or private and have various access controls. You can use GitHub‚Äôs search feature to look for company names or website names to try and locate repositories belonging to your target. Once discovered, you may have access to source code, passwords or other content that you hadn‚Äôt yet found.\nAnswer the questions below1. What is Git?Answer: Version Control System\nTASK 11 - OSINT - S3 BUCKETSS3 Buckets\nS3 Buckets are a storage service provided by Amazon AWS, allowing people to save files and even static website content in the cloud accessible over HTTP and HTTPS. The owner of the files can set access permissions to either make files public, private and even writable. Sometimes these access permissions are incorrectly set and inadvertently allow access to files that shouldn‚Äôt be available to the public. The format of the S3 buckets is http(s)://&#123;name&#125;.s3.amazonaws.com where &#123;name&#125; is decided by the owner, such as tryhackme-assets.s3.amazonaws.com. S3 buckets can be discovered in many ways, such as finding the URLs in the website‚Äôs page source, GitHub repositories, or even automating the process. One common automation method is by using the company name followed by common terms such as &#123;name&#125;-assets, &#123;name&#125;-www, &#123;name&#125;-public, &#123;name&#125;-private, etc.\nAnswer the questions below1. What URL format do Amazon S3 buckets end in?Answer: .s3.amazonaws.com\nTASK 12 - Automated DiscoveryWhat is Automated Discovery?\nAutomated discovery is the process of using tools to discover content rather than doing it manually. This process is automated as it usually contains hundreds, thousands or even millions of requests to a web server. These requests check whether a file or directory exists on a website, giving us access to resources we didn‚Äôt previously know existed. This process is made possible by using a resource called wordlists.\nWhat are wordlists?\nWordlists are just text files that contain a long list of commonly used words; they can cover many different use cases. For example, a password wordlist would include the most frequently used passwords, whereas we‚Äôre looking for content in our case, so we‚Äôd require a list containing the most commonly used directory and file names. An excellent resource for wordlists that is preinstalled on the THM AttackBox is https://github.com/danielmiessler/SecLists which Daniel Miessler curates.\nAutomation Tools\nAlthough there are many different content discovery tools available, all with their features and flaws, we‚Äôre going to cover three which are preinstalled on our attack box, ffuf, dirb and gobuster.\nOn the AttackBox execute the following three commands, targeting the Acme IT Support website and see what results you get.\nUsing ffuf:\n1user@machine$ ffuf -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -u http://10.10.163.15/FUZZ\nUsing dirb:\n1user@machine$ dirb http://10.10.163.15/ /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt\n\nUsing Gobuster:\n1user@machine$ gobuster dir --url http://10.10.163.15/ -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt\nUsing the results from the commands above, please answer the below questions:\nQuestions and answers in the task\nfirst lets eneumerte the web server using gobuster \ncommand: gobuster dir --url http://10.10.163.15/ -w /usr/share/wordlists/dirb/common.txt\n\n1. What is the name of the directory beginning ‚Äú&#x2F;mo‚Ä¶.‚Äù that was discovered?Answer:\n\n/monthly\n\n2. What is the name of the log file that was discovered?Answer: development.log\nThank You üíåAuthor: Satvik Shettyüßë‚ÄçüíªSee you again in another writeup\n","slug":"Content-Discovery-THM-Walkthrough","date":"2024-05-27T13:26:57.000Z","categories_index":"cybersecurity,THM,web","tags_index":"tryhackme,web","author_index":"Satvik"},{"id":"3f7217341e6a6154d773e1a5d0dd33e9","title":"Walking an Application - THM","content":"Welcome to Another writeup guys üíåToday we will be walking through another room called as &quot;Walking an Application&quot; which is a part of &quot;Web Fundamentals&quot; path on TryHackMeyou can find all rooms of web fundamentals in the &quot;WEB&quot; category in our BlogLet‚Äôs start solving the challenges Ahead ! üöÄ\nTASK 1 - Walking an ApplicationIn this room you will learn how to manually review a web application for security issues using only the in-built tools in your browser. More often than not, automated security tools and scripts will miss many potential vulnerabilities and useful information.\nHere is a short breakdown of the in-built browser tools you will use throughout this room:\nView Source - Use your browser to view the human-readable source code of a website.Inspector - Learn how to inspect page elements and make changes to view usually blocked content.Debugger - Inspect and control the flow of a page‚Äôs JavaScriptNetwork - See all the network requests a page makes.Start the virtual machine on this task, wait 2 minutes, and visit the following URL: https://LAB_WEB_URL.p.thmlabs.com (this URL will update 2 minutes from when you start the machine)Now start the machine and move on next task\nTASK 2 - Exploring the websiteAs a penetration tester, your role when reviewing a website or web application is to discover features that could potentially be vulnerable and attempt to exploit them to assess whether or not they are. These features are usually parts of the website that require some interactivity with the user.\nFinding interactive portions of the website can be as easy as spotting a login form to manually reviewing the website‚Äôs JavaScript. An excellent place to start is just with your browser exploring the website and noting down the individual pages&#x2F;areas&#x2F;features with a summary for each one.\nAn example site review for the Acme IT Support website would look something like this:\n\n\n\nFeature\nURL\nSummary\n\n\n\nHome Page\n&#x2F;\nThis page contains a summary of what Acme IT Support does with a company photo of their staff.\n\n\nLatest News\n&#x2F;news\nThis page contains a list of recently published news articles by the company, and each news article has a link with an id number, i.e. &#x2F;news&#x2F;article?id&#x3D;1.\n\n\nNews Article\n&#x2F;news&#x2F;article?id&#x3D;1\nDisplays the individual news article. Some articles seem to be blocked and reserved for premium customers only.\n\n\nContact Page\n&#x2F;contact\nThis page contains a form for customers to contact the company. It contains name, email and message input fields and a send button.\n\n\nCustomers\n&#x2F;customers\nThis link redirects to &#x2F;customers&#x2F;login.\n\n\nCustomer Login\n&#x2F;customers&#x2F;login\nThis page contains a login form with username and password fields.\n\n\nCustomer Signup\n&#x2F;customers&#x2F;signup\nThis page contains a user-signup form that consists of a username, email, password and password confirmation input fields.\n\n\nCustomer Reset Password\n&#x2F;customers&#x2F;reset\nPassword reset form with an email address input field.\n\n\nCustomer Dashboard\n&#x2F;customers\nThis page contains a list of the user‚Äôs tickets submitted to the IT support company and a ‚ÄúCreate Ticket‚Äù button.\n\n\nCreate Ticket\n&#x2F;customers&#x2F;ticket&#x2F;new\nThis page contains a form with a textbox for entering the IT issue and a file upload option to create an IT support ticket.\n\n\nCustomer Account\n&#x2F;customers&#x2F;account\nThis page allows the user to edit their username, email and password.\n\n\nCustomer Logout\n&#x2F;customers&#x2F;logout\nThis link logs the user out of the customer area.\n\n\nWe will start taking a deeper look into some of the pages we have discovered in the next task\n\n\n\n\nUnderstand the website structure by looking the table above and move to the next challenge\nTASK 3 - Viewing the page sourceThe page source is the human-readable code returned to our browser&#x2F;client from the web server each time we make a request.\nThe returned code is made up of HTML ( HyperText Markup Language), CSS ( Cascading Style Sheets ) and JavaScript, and it‚Äôs what tells our browser what content to display, how to show it and adds an element of interactivity with JavaScript.\nFor our purposes, viewing the page source can help us discover more information about the web application.\nHow do I view the Page Source?While viewing a website, you can right-click on the page, and you‚Äôll see an option on the menu that says View Page Source.Most browsers support putting view-source: in front of the URL for example, view-source:https://www.google.com/In your browser menu, you‚Äôll find an option to view the page source. This option can sometimes be in submenus such as developer tools or more tools.\nLet‚Äôs view some Page Source!Try viewing the page source of the home page of the Acme IT Support website. Unfortunately, explaining everything you can see here is well out of the scope of this room, and you‚Äôll need to look into website design&#x2F;development courses to understand it fully. What we can do, is pick out bits of information that are of importance to us.\nAt the top of the page, you‚Äôll notice some code starting with&lt;!-- and ending with --&gt; these are comments. Comments are messages left by the website developer, usually to explain something in the code to other programmers or even notes&#x2F;reminders for themselves. These comments don‚Äôt get displayed on the actual webpage. This comment describes how the homepage is temporary while a new one is in development. View the webpage in the comment to get your first flag.\nLinks to different pages in HTML are written in anchor tags ( these are HTML elements that start with &lt;a ), and the link that you‚Äôll be directed to is stored in the href attribute.\nFor example, you‚Äôll see the contact page link on line 31:\n\nIf you view further down the page source, there is a hidden link to a page starting with ‚Äúsecr‚Äù, view this link to get another flag. You obviously wouldn‚Äôt get a flag in a real-world situation, but you may discover some private area used by the business for storing company&#x2F;staff&#x2F;customer information.\nExternal files such as CSS, JavaScript and Images can be included using the HTML code. In this example, you‚Äôll notice that these files are all stored in the same directory. If you view this directory in your web browser, there is a configuration error. What should be displayed is either a blank page or a 403 Forbidden page with an error stating you don‚Äôt have access to the directory. Instead, the directory listing feature has been enabled, which in fact, lists every file in the directory. Sometimes this isn‚Äôt an issue, and all the files in the directory are safe to be viewed by the public, but in some instances, backup files, source code or other confidential information could be stored here. In this instance, we get a flag in the flag.txt file.\nMany websites these days aren‚Äôt made from scratch and use what‚Äôs called a framework. A framework is a collection of premade code that easily allows a developer to include common features that a website would require, such as blogs, user management, form processing, and much more, saving the developers hours or days of development.\nViewing the page source can often give us clues into whether a framework is in use and, if so, which framework and even what version. Knowing the framework and version can be a powerful find as there may be public vulnerabilities in the framework, and the website might not be using the most up to date version. At the bottom of the page, you‚Äôll find a comment about the framework and version in use and a link to the framework‚Äôs website. Viewing the framework‚Äôs website, you‚Äôll see that our website is, in fact, out of date. Read the update notice and use the information that you find to discover another flag.\nQuestions and Answers of the task1. What is the flag from the HTML comment?Answer:\n\nLet‚Äôs open the site and view its source first\n\n\n\nif we look at the comments in the source , it saying that the current home page is temporary and new page is developing at @new-home-beta\nso let‚Äôs go to the source of &#x2F;new-page-beta and look if it has anything for us\n\n\n\nOh yes Guys , Here‚Äôs our flag THM&#123;HTML_COMMENTS_ARE_DANGEROUS&#125;\n\n2. What is the flag from the secret link?Answer:\n\nLets find out where that secret link is hiding \nfor that we should look carefully at the source code of home page\nLets do it\n\n\n\nSo there is something called secret-page . Lets check it out\n\n\n\nYayy ! We got it ‚Ä¶\nso the answer is THM&#123;NOT_A_SECRET_ANYMORE&#125;\n\n3. What is the directory listing flag?Answer:\n\nif we look at the website structure , we can understand that all the files on the website in stored in /assets directory . so let‚Äôs go and check it out\n\n\n\nWe have something interesting called flag.txt , open it\n\n\n\nso the flag is : THM&#123;INVALID_DIRECTORY_PERMISSIONS&#125;\n\n4. What is the framework flag?Answer:\n\nif we look at the ending line of the source code which is comment &lt;!--Page Generated in 0.04820 Seconds using the THM Framework v1.2 ( https://static-labs.tryhackme.cloud/sites/thm-web-framework )--&gt;\nso let‚Äôs go to that web url and look if there is anything interesting\n\n\n\nwe can find three pages there\nHome - which is our actual homepage\nChangelog - which is about the latest changes in the site and things that are patched\nDocumentation - Ofcourse you guys know what would be there inside it\n\n\nSo out of these , we can find something interest in changelog as it tells about the fixes and may reveal some important information about the current version of the page\nlets go to change log page and look if it has anything interesting for us\n\n\n\nif we look at log vserion 1.3 , we can understand that some potential information is storing in &#x2F;tmp.zip file in the web server\nso now will try to access that\n\n\n\nwoah ! we got that tmp.zip file guys so let‚Äôs extract it and see the contents\nso guys there it is ! we got flag.txt\n\n\n\nyay! The Flag is THM&#123;KEEP_YOUR_SOFTWARE_UPDATED&#125;\n\nTASK 4 - Developer Tools - InspectorDeveloper Tools\nEvery modern browser includes developer tools; this is a tool kit used to aid web developers in debugging web applications and gives you a peek under the hood of a website to see what is going on. As a pentester, we can leverage these tools to provide us with a much better understanding of the web application. We‚Äôre specifically focusing on three features of the developer tool kit, Inspector, Debugger and Network.\nOpening Developer ToolsThe way to access developer tools is different for every browser. If you‚Äôre not sure how to access it, click the ‚ÄúView Site‚Äù button on the top right of this task to get instructions to how to access the tools for your browser.\nInspectorThe page source doesn‚Äôt always represent what‚Äôs shown on a webpage; this is because CSS, JavaScript and user interaction can change the content and style of the page, which means we need a way to view what‚Äôs been displayed in the browser window at this exact time. Element inspector assists us with this by providing us with a live representation of what is currently on the website.\nAs well as viewing this live view, we can also edit and interact with the page elements, which is helpful for web developers to debug issues.\nOn the Acme IT Support website, click into the news section, where you‚Äôll see three news articles.\nThe first two articles are readable, but the third has been blocked with a floating notice above the content stating you have to be a premium customer to view the article. These floating boxes blocking the page contents are often referred to as paywalls as they put up a metaphorical wall in front of the content you wish to see until you pay.\n\nRight-clicking on the premium notice ( paywall ), you should be able to select the Inspect option from the menu, which opens the developer tools either on the bottom or right-hand side depending on your browser or preferences. You‚Äôll now see the elements&#x2F;HTML that make up the website ( similar to the screenshots below ).\n\n(Click on the image to enlarge)\nLocate the DIV element with the class premium-customer-blocker and click on it. You‚Äôll see all the CSS styles in the styles box that apply to this element, such as margin-top: 60px and text-align: center. The style we‚Äôre interested in is the display: block. If you click on the word block, you can type a value of your own choice. Try typing none, and this will make the box disappear, revealing the content underneath it and a flag. If the element didn‚Äôt have a display field, you could click below the last style and add in your own. Have a play with the element inspector, and you‚Äôll see you can change any of the information on the website, including the content. Remember this is only edited on your browser window, and when you press refresh, everything will be back to normal.\nQuestions and Answers in the task1. What is the flag behind the paywall?Answer:\n\ngo to news page and click inspect on paywall block\n\n\n\n\nAfter changing the value to none . view the site again\n\n\n\nHaha ! we got it THM&#123;NOT_SO_HIDDEN&#125;\n\nTASK 5 - Developer Tools - DebuggerDeveloper Tools - Debugger\nThis panel in the developer tools is intended for debugging JavaScript, and again is an excellent feature for web developers wanting to work out why something might not be working. But as penetration testers, it gives us the option of digging deep into the JavaScript code. In Firefox and Safari, this feature is called Debugger, but in Google Chrome, it‚Äôs called Sources.\nOn the Acme IT Support website, click on the contact page, each time the page is loaded, you might notice a rapid flash of red on the screen. We‚Äôre going to use the Debugger to work out what this red flash is and if it contains anything interesting. Debugging a red dot wouldn‚Äôt be something you‚Äôd do in the real world as a penetration tester, but it does allow us to use this feature and get used to the Debugger.\nIn both browsers, on the left-hand side, you see a list of all the resources the current webpage is using. If you click into the assets folder, you‚Äôll see a file named flash.min.js. Clicking on this file displays the contents of the JavaScript file.\nMany times when viewing javascript files, you‚Äôll notice that everything is on one line, which is because it has been minimised, which means all formatting ( tabs, spacing and newlines ) have been removed to make the file smaller. This file is no exception to this, and it has also been obfusticated, which makes it purposely difficult to read, so it can‚Äôt be copied as easily by other developers.\nWe can return some of the formattings by using the ‚ÄúPretty Print‚Äù option, which looks like two braces { } to make it a little more readable, although due to the obfustication, it‚Äôs still difficult to comprehend what is going on with the file. If you scroll to the bottom of the flash.min.js file, you‚Äôll see the line: flash[&#39;remove&#39;]();\n\n(Click on the image to enlarge)\nThis little bit of JavaScript is what is removing the red popup from the page. We can utilise another feature of debugger called breakpoints. These are points in the code that we can force the browser to stop processing the JavaScript and pause the current execution.\nIf you click the line number that contains the above code, you‚Äôll notice it turns blue; you‚Äôve now inserted a breakpoint on this line. Now try refreshing the page, and you‚Äôll notice the red box stays on the page instead of disappearing, and it contains a flag.\nQuestions and Answers in the Task1. What is the flag in the red box?Answer:\n\nGoto contact page and open Debugger \nclick on line no.110 and select the three options in the side bar as shown in the image below\n\n\n\nNow refresh the page\n\n\n\nFlag THM&#123;CATCH_ME_IF_YOU_CAN&#125;\n\nTASK 6 - Developer Tools - NetworkDeveloper Tools - NetworkThe network tab on the developer tools can be used to keep track of every external request a webpage makes. If you click on the Network tab and then refresh the page, you‚Äôll see all the files the page is requesting. \nTry doing this on the contact page; you can press the trash can icon to delete the list if it gets a bit overpopulated.\nWith the network tab open, try filling in the contact form and pressing the Send Message button. You‚Äôll notice an event in the network tab, and this is the form being submitted in the background using a method called AJAX. AJAX is a method for sending and receiving network data in a web application background without interfering by changing the current web page.\n\nExamine the new entry on the network tab that the contact form created and view the page the data was sent to in order to reveal a flag.\nQuestions and Answers in the Task1. What is the flag shown on the contact-msg network request?Answer:\n\nGo to contact page and click on inspect and then go to Network Tab\n\n\n\nNow fill the form with random information and click on send message ( make sure you have network tab open)\n\n\n\nNow you can observe some response in network tab \nclick on it and in sidebar goto Response tab\n\n\n\nFlag: THM&#123;GOT_AJAX_FLAG&#125;\n\nThats it guys ! You havve succesfully completed the room ü•≥Thank You üíåAuthor: Satvik Shettyüßë‚ÄçüíªSee you again in another writeup\n","slug":"Walking-an-Application-THM","date":"2024-05-25T09:35:07.000Z","categories_index":"cybersecurity,THM,web","tags_index":"tryhackme,web","author_index":"Satvik"},{"id":"04c3f082e63bec82336499ba808815fb","title":"How Websites Work - THM Walkthrough","content":"Hello Hackers üíåToday we will be walking through a new room on tryhackme called How Websites workLet‚Äôs dive into the room and solve the challenges ahead !üöÄ\nTASK 1 - How Websites WorkBy the end of this room, you‚Äôll know how websites are created and will be introduced to some basic security issues.\nWhen you visit a website, your browser (like Safari or Google Chrome) makes a request to a web server asking for information about the page you‚Äôre visiting. It will respond with data that your browser uses to show you the page; a web server is just a dedicated computer somewhere else in the world that handles your requests.\n\nThere are two major components that make up a website:\nFront End (Client-Side) - the way your browser renders a website.Back End (Server-Side) - a server that processes your request and returns a response.There are many other processes involved in your browser making a request to a web server, but for now, you just need to understand that you make a request to a server, and it responds with data your browser uses to render information to you.\nQuestions and Answers in the Task1. What term best describes the component of a web application rendered by your browser?\n\nAnswer: Front End\n\nTASK 2 - HTMLWebsites are primarily created using:\n\nHTML, to build websites and define their structure.\nCSS, to make websites look pretty by adding styling options.\nJavaScript, to implement complex features on pages using interactivity.\n\nHyperText Markup Language (HTML) is the language websites are written in. Elements (also known as tags) are the building blocks of HTML pages and tell the browser how to display content. The code snippet below shows a simple HTML document, the structure of which is the same for every website:\n\nThe HTML structure (as shown in the screenshot) has the following components:\n\nThe &lt;!DOCTYPE html&gt; defines that the page is an HTML5 document. This helps with standardization across different browsers and tells the browser to use HTML5 to interpret the page.\nThe &lt;html&gt; element is the root element of the HTML page - all other elements come after this element.\nThe &lt;head&gt; element contains information about the page (such as the page title).\nThe &lt;body&gt; element defines the HTML document‚Äôs body; only content inside of the body is shown in the browser.\nThe &lt;h1&gt; element defines a large heading.\nThe &lt;p&gt; element defines a paragraph.\n\nThere are many other elements (tags) used for different purposes. For example, there are tags for buttons (&lt;button&gt;), images (&lt;img&gt;), lists, and much more. \nTags can contain attributes such as the class attribute, which can be used to style an element (e.g., make the tag a different color) &lt;p class=&quot;bold-text&quot;&gt;, or the src attribute, which is used on images to specify the location of an image: &lt;img src=&quot;img/cat.jpg&quot;&gt;. An element can have multiple attributes each with its own unique purpose, e.g., &lt;p attribute1=&quot;value1&quot; attribute2=&quot;value2&quot;&gt;.\nElements can also have an id attribute (&lt;p id=&quot;example&quot;&gt;), which is unique to the element. Unlike the class attribute, where multiple elements can use the same class, an element must have different ids to identify them uniquely. Element ids are used for styling and to identify it by JavaScript.\nYou can view the HTML of any website by right-clicking and selecting ‚ÄúView Page Source‚Äù (Chrome) &#x2F; ‚ÄúShow Page Source‚Äù (Safari).\nQuestions and answers in the task1. One of the images on the cat website is broken - fix it, and the image will reveal the hidden text answer! \n\nAnswer: HTMLHERO\n2. Add a dog image to the page by adding another img tag () on line 11. The dog image location is img&#x2F;dog-1.png. What is the text in the dog image?\n\nAnswer: DOGHTML\n\nTASK 3 - JavascriptJavaScript (JS) is one of the most popular coding languages in the world and allows pages to become interactive. HTML is used to create the website structure and content, while JavaScript is used to control the functionality of web pages - without JavaScript, a page would not have interactive elements and would always be static. JS can dynamically update the page in real-time, giving functionality to change the style of a button when a particular event on the page occurs (such as when a user clicks a button) or to display moving animations.\nJavaScript is added within the page source code and can be either loaded within &lt;script&gt; tags or can be included remotely with the src attribute: &lt;script src=&quot;/location/of/javascript_file.js&quot;&gt;&lt;/script&gt;\nThe following JavaScript code finds a HTML element on the page with the id of &quot;demo&quot; and changes the element‚Äôs contents to &quot;Hack the Planet&quot; : document.getElementById(&quot;demo&quot;).innerHTML = &quot;Hack the Planet&quot;;\nHTML elements can also have events, such as ‚Äúonclick‚Äù or ‚Äúonhover‚Äù that execute JavaScript when the event occurs. The following code changes the text of the element with the demo ID to Button Clicked: &lt;button onclick=&#39;document.getElementById(&quot;demo&quot;).innerHTML = &quot;Button Clicked&quot;;&#39;&gt;Click Me!&lt;/button&gt; - onclick events can also be defined inside the JavaScript script tags, and not on elements directly.\nQuestions and Answers in the task1. Click the ‚ÄúView Site‚Äù button on this task. On the right-hand side, add JavaScript that changes the demo element‚Äôs content to ‚ÄúHack the Planet‚Äù\n\nAnswer: JSISFUN\n\nTASK 4 - Sensitive Data ExposureSensitive Data Exposure occurs when a website doesn‚Äôt properly protect (or remove) sensitive clear-text information to the end-user; usually found in a site‚Äôs frontend source code.\nWe now know that websites are built using many HTML elements (tags), all of which we can see simply by ‚Äúviewing the page source‚Äù. A website developer may have forgotten to remove login credentials, hidden links to private parts of the website or other sensitive data shown in HTML or JavaScript.\nSensitive information can be potentially leveraged to further an attacker‚Äôs access within different parts of a web application. For example, there could be HTML comments with temporary login credentials, and if you viewed the page‚Äôs source code and found this, you could use these credentials to log in elsewhere on the application (or worse, used to access other backend components of the site).\nWhenever you‚Äôre assessing a web application for security issues, one of the first things you should do is review the page source code to see if you can find any exposed login credentials or hidden links.\nQuestions and Answers in the Task1. View the website on this link. What is the password hidden in the source code?\n\nAnswer: testpasswd\n\nTASK 5 - HTML InjectionHTML Injection is a vulnerability that occurs when unfiltered user input is displayed on the page. If a website fails to sanitise user input (filter any ‚Äúmalicious‚Äù text that a user inputs into a website), and that input is used on the page, an attacker can inject HTML code into a vulnerable website.\nInput sanitisation is very important in keeping a website secure, as information a user inputs into a website is often used in other frontend and backend functionality. A vulnerability you‚Äôll explore in another lab is database injection, where you can manipulate a database lookup query to log in as another user by controlling the input that‚Äôs directly used in the query - but for now, let‚Äôs focus on HTML injection (which is client-side).\nWhen a user has control of how their input is displayed, they can submit HTML (or JavaScript) code, and the browser will use it on the page, allowing the user to control the page‚Äôs appearance and functionality.\n\nThe image above shows how a form outputs text to the page. Whatever the user inputs into the ‚ÄúWhat‚Äôs your name‚Äù field is passed to a JavaScript function and output to the page, which means if the user adds their own HTML or JavaScript in the field, it‚Äôs used in the sayHi function and is added to the page - this means you can add your own HTML (such as a &lt;h1&gt; tag) and it will output your input as pure HTML\nThe general rule is never to trust user input. To prevent malicious input, the website developer should sanitise everything the user enters before using it in the JavaScript function; in this case, the developer could remove any HTML tags.\nQuestions and Answers in the task1. View the website on this task and inject HTML so that a malicious link to http://hacker.com is shown.\n\nAnswer: HTML_INJ3CTI0N\n\nThank You üíåAuthor: Satvik Shettyüßë‚ÄçüíªSee you again in another writeup\n","slug":"How-Websites-Work-THM-Walkthrough","date":"2024-05-23T09:28:53.000Z","categories_index":"cybersecurity,THM,web","tags_index":"tryhackme,web","author_index":"Satvik"},{"id":"5904c8f0bb1680bf04de5ca4eafa3e53","title":"HTTP in detail - THM","content":"HTTP in DetailWhat is HTTP? (HyperText Transfer Protocol)HTTP is what‚Äôs used whenever you view a website, developed by Tim Berners-Lee and his team between 1989-1991. HTTP is the set of rules used for communicating with web servers for the transmitting of webpage data, whether that is HTML, Images, Videos, etc.\nWhat is HTTPS? (HyperText Transfer Protocol Secure)\nHTTPS is the secure version of HTTP. HTTPS data is encrypted so it not only stops people from seeing the data you are receiving and sending, but it also gives you assurances that you‚Äôre talking to the correct web server and not something impersonating it.\nQuestions and Answers in the task1. What does HTTP stands for ?Answer:\n\nHyperText Transfer Protocol2. What does S in HTTPS stands for ?Answer:\nSecure3. On the mock webpage on the right there is an issue, once you‚Äôve found it, click on it. What is the challenge flag?Answer:\nClick on Lock SymbolFalg : THM&#123;INVALID_HTTP_CERT&#125;\n\nRequests and ResponsesWhen we access a website, your browser will need to make requests to a web server for assets such as HTML, Images, and download the responses. Before that, you need to tell the browser specifically how and where to access these resources, this is where URLs will help.\nWhat is a URL? (Uniform Resource Locator)If you‚Äôve used the internet, you‚Äôve used a URL before. A URL is predominantly an instruction on how to access a resource on the internet. The below image shows what a URL looks like with all of its features (it does not use all features in every request).\n\nA diagram showing different parts of a URL on an example, where http is the scheme, user:password is the user, tryhackme.com is a domain or the host, 80 is the port, view-room is the path, ?id&#x3D;1 is the query string, and #task3 is the fragment. The full address is http://user:password@tryhackme.com:80/view-room?id=1#task3.\nScheme: This instructs on what protocol to use for accessing the resource such as HTTP, HTTPS, FTP (File Transfer Protocol).\nUser: Some services require authentication to log in, you can put a username and password into the URL to log in.\nHost: The domain name or IP address of the server you wish to access.\nPort: The Port that you are going to connect to, usually 80 for HTTP and 443 for HTTPS, but this can be hosted on any port between 1 - 65535.\nPath: The file name or location of the resource you are trying to access.\nQuery String: Extra bits of information that can be sent to the requested path. For example, &#x2F;blog?id&#x3D;1 would tell the blog path that you wish to receive the blog article with the id of 1.\nFragment: This is a reference to a location on the actual page requested. This is commonly used for pages with long content and can have a certain part of the page directly linked to it, so it is viewable to the user as soon as they access the page.\nMaking a Request\nIt‚Äôs possible to make a request to a web server with just one line ‚ÄúGET &#x2F; HTTP&#x2F;1.1‚Äù\n\nBut for a much richer web experience, you‚Äôll need to send other data as well. This other data is sent in what is called headers, where headers contain extra information to give to the web server you‚Äôre communicating with, but we‚Äôll go more into this in the Header task.\nExample Request:\n1234GET / HTTP/1.1Host: tryhackme.comUser-Agent: Mozilla/5.0 Firefox/87.0Referer: https://tryhackme.com/\nTo breakdown each line of this request:\nLine 1: This request is sending the GET method ( more on this in the HTTP Methods task ), request the home page with &#x2F; and telling the web server we are using HTTP protocol version 1.1.\nLine 2: We tell the web server we want the website tryhackme.com\nLine 3: We tell the web server we are using the Firefox version 87 Browser\nLine 4: We are telling the web server that the web page that referred us to this one is https://tryhackme.com\nLine 5: HTTP requests always end with a blank line to inform the web server that the request has finished.\nExample Response:\n1234567891011121314HTTP/1.1 200 OKServer: nginx/1.15.8Date: Fri, 09 Apr 2021 13:34:03 GMTContent-Type: text/htmlContent-Length: 98&lt;html&gt;&lt;head&gt;    &lt;title&gt;TryHackMe&lt;/title&gt;&lt;/head&gt;&lt;body&gt;    Welcome To TryHackMe.com&lt;/body&gt;&lt;/html&gt;\nTo breakdown each line of the response:\nLine 1: HTTP 1.1 is the version of the HTTP protocol the server is using and then followed by the HTTP Status Code in this case ‚Äú200 Ok‚Äù which tells us the request has completed successfully.\nLine 2: This tells us the web server software and version number.\nLine 3: The current date, time and timezone of the web server.\nLine 4: The Content-Type header tells the client what sort of information is going to be sent, such as HTML, images, videos, pdf, XML.\nLine 5: Content-Length tells the client how long the response is, this way we can confirm no data is missing.\nLine 6: HTTP response contains a blank line to confirm the end of the HTTP response.\nLines 7-14: The information that has been requested, in this instance the homepage.\nQuestions and Answers in the task1. What HTTP protocol is being used in the above example?Answer:\n\nHTTP/1.12. What response header tells the browser how much data to expect?Answer:\ncontent-length\n\nHTTP MethodsHTTP methods are a way for the client to show their intended action when making an HTTP request. There are a lot of HTTP methods but we‚Äôll cover the most common ones, although mostly you‚Äôll deal with the GET and POST method.\nGET Request\nThis is used for getting information from a web server.\nPOST Request\nThis is used for submitting data to the web server and potentially creating new records\nPUT Request\nThis is used for submitting data to a web server to update information\nDELETE Request\nThis is used for deleting information&#x2F;records from a web server.\nQuestions and Answers in the Task\nWhat method would be used to create a new user account?\n\n\nAnswer: POST\n\n\nWhat method would be used to update your email address?\n\n\nAnswer: PUT\n\n\nWhat method would be used to remove a picture you‚Äôve uploaded to your account?\n\n\nAnswer: DELETE\n\n\nWhat method would be used to view a news article?\n\n\nAnswer: GET\n\nHTTP Status CodesHTTP Status Codes:In the previous task, you learnt that when a HTTP server responds, the first line always contains a status code informing the client of the outcome of their request and also potentially how to handle it. These status codes can be broken down into 5 different ranges:\n\n\n\nStatus Code Range\nDescription\n\n\n\n100-199\nInformation Response - These are sent to tell the client the first part of their request has been accepted and they should continue sending the rest of their request. These codes are no longer very common.\n\n\n200-299\nSuccess - This range of status codes is used to tell the client their request was successful.\n\n\n300-399\nRedirection - These are used to redirect the client‚Äôs request to another resource. This can be either to a different webpage or a different website altogether.\n\n\n400-499\nClient Errors - Used to inform the client that there was an error with their request.\n\n\n500-599\nServer Errors - This is reserved for errors happening on the server-side and usually indicate quite a major problem with the server handling the request.\n\n\nCommon HTTP Status Codes\n\n\nStatus Code\nDescription\n\n\n\n200 - OK\nThe request was completed successfully.\n\n\n201 - Created\nA resource has been created (for example a new user or new blog post).\n\n\n301 - Moved Permanently\nThis redirects the client‚Äôs browser to a new webpage or tells search engines that the page has moved somewhere else and to look there instead.\n\n\n302 - Found\nSimilar to the above permanent redirect, but as the name suggests, this is only a temporary change and it may change again in the near future.\n\n\n400 - Bad Request\nThis tells the browser that something was either wrong or missing in their request. This could sometimes be used if the web server resource that is being requested expected a certain parameter that the client didn‚Äôt send.\n\n\n401 - Not Authorised\nYou are not currently allowed to view this resource until you have authorised with the web application, most commonly with a username and password.\n\n\n403 - Forbidden\nYou do not have permission to view this resource whether you are logged in or not.\n\n\n404 - Page Not Found\nThe page&#x2F;resource you requested does not exist.\n\n\n405 - Method Not Allowed\nThe resource does not allow this method request, for example, you send a GET request to the resource &#x2F;create-account when it was expecting a POST request instead.\n\n\n500 - Internal Service Error\nThe server has encountered some kind of error with your request that it doesn‚Äôt know how to handle properly.\n\n\n503 - Service Unavailable\nThis server cannot handle your request as it‚Äôs either overloaded or down for maintenance.\n\n\nQuestions and Answers in the Task1. What response code might you receive if you‚Äôve created a new user or blog post article?\n\nAnswer: 201\n\n2. What response code might you receive if you‚Äôve tried to access a page that doesn‚Äôt exist?\n\nAnswer: 404\n\n3. What response code might you receive if the web server cannot access its database and the application crashes?\n\nAnswer: 503\n\n4. What response code might you receive if you try to edit your profile without logging in first?\n\nAnswer: 401\n\nTASK 5 - HeadersHeaders are additional bits of data you can send to the web server when making requests.\nAlthough no headers are strictly required when making a HTTP request, you‚Äôll find it difficult to view a website properly.\nCommon Request HeadersThese are headers that are sent from the client (usually your browser) to the server.\nHost: Some web servers host multiple websites so by providing the host headers you can tell it which one you require, otherwise you‚Äôll just receive the default website for the server.\nUser-Agent: This is your browser software and version number, telling the web server your browser software helps it format the website properly for your browser and also some elements of HTML, JavaScript and CSS are only available in certain browsers.\nContent-Length: When sending data to a web server such as in a form, the content length tells the web server how much data to expect in the web request. This way the server can ensure it isn‚Äôt missing any data.\nAccept-Encoding: Tells the web server what types of compression methods the browser supports so the data can be made smaller for transmitting over the internet.\nCookie: Data sent to the server to help remember your information (see cookies task for more information).Common Response Headers\nThese are the headers that are returned to the client from the server after a request.\nSet-Cookie: Information to store which gets sent back to the web server on each request (see cookies task for more information).\nCache-Control: How long to store the content of the response in the browser‚Äôs cache before it requests it again.\nContent-Type: This tells the client what type of data is being returned, i.e., HTML, CSS, JavaScript, Images, PDF, Video, etc. Using the content-type header the browser then knows how to process the data.\nContent-Encoding: What method has been used to compress the data to make it smaller when sending it over the internet.\nAnswer the questions below\nWhat header tells the web server what browser is being used?\n\n\nAnswer: user-agent\n\n\nWhat header tells the browser what type of data is being returned?\n\n\nAnswer: content-type\n\n\nWhat header tells the web server which website is being requested?\n\n\nAnswer: host\n\nTASK 6 - CookiesYou‚Äôve probably heard of cookies before, they‚Äôre just a small piece of data that is stored on your computer. Cookies are saved when you receive a ‚ÄúSet-Cookie‚Äù header from a web server. Then every further request you make, you‚Äôll send the cookie data back to the web server. Because HTTP is stateless (doesn‚Äôt keep track of your previous requests), cookies can be used to remind the web server who you are, some personal settings for the website or whether you‚Äôve been to the website before. Let‚Äôs take a look at this as an example HTTP request:A diagram visualizing how cookies are introduced in http requests to allow storing user information\nCookies can be used for many purposes but are most commonly used for website authentication. The cookie value won‚Äôt usually be a clear-text string where you can see the password, but a token (unique secret code that isn‚Äôt easily humanly guessable).\nViewing Your Cookies\nYou can easily view what cookies your browser is sending to a website by using the developer tools, in your browser.\nQuestions and Answers in the Task ?1. which header is used to save cookies in your computer\n\nAnswer: set-cookie\n\nMaking Requests\nClick the ‚ÄúView Site‚Äù button on the right.\nThis is an emulator for making demo HTTP requests, using what you‚Äôve learnt from the above tasks you can use it to complete the below questions.\nQuestions and answers in the task1. Make a GET request to &#x2F;room\n\n\nAnswer: THM&#123;YOU&#39;RE_IN_THE_ROOM&#125;\n\n2. Make a GET request to &#x2F;blog and using the gear icon set the id parameter to 1 in the URL field\n\n\nAnswer: THM&#123;YOU_FOUND_THE_BLOG&#125;\n\n3. Make a DELETE request to &#x2F;user&#x2F;1\n\n\nAnswer: THM&#123;USER_IS_DELETED&#125;\n\n4. Make a PUT request to &#x2F;user&#x2F;2 with the username parameter set to admin\n\n\nAnswer: THM&#123;USER_HAS_UPDATED&#125;\n\n5. POST the username of thm and a password of letmein to &#x2F;login\n\n\nAnswer: THM&#123;HTTP_REQUEST_MASTER&#125;\n\nThank You üíåAuthor: Satvik Shettyüßë‚ÄçüíªSee you again in another writeup\n","slug":"HTTP-in-detail-THM","date":"2024-05-22T18:09:01.000Z","categories_index":"cybersecurity,THM,web","tags_index":"tryhackme,web","author_index":"Satvik"},{"id":"47e2aeaa7cfad81b420e64c0e671a73f","title":"Encryption - Crypto 101 - THM Walkthrough","content":"Hello Hackers üöÄToday we are gonna walkthrough a new room on Try Hack Me called ‚ÄúEncryption - Crypto 101‚Äú\nTASK 1 - What will this room cover?This room will cover:\n\nWhy cryptography matters for security and CTFs\nThe two main classes of cryptography and their uses\nRSA, and some of the uses of RSA\n2 methods of Key Exchange\nNotes about the future of encryption with the rise of Quantum ComputingNote: This room expects some familiarity with tools, and some research into how to use them yourself!\n\nTASK 2 - Key TermsMany of these key terms are shared with https://tryhackme.com/room/hashingcrypto101, so you might be able to skip over some if you‚Äôre already familiar.\n\nCiphertext - The result of encrypting a plaintext, encrypted data\nCipher - A method of encrypting or decrypting data. Modern ciphers are cryptographic, but there are many non cryptographic ciphers like Caesar.\nPlaintext - Data before encryption, often text but not always. Could be a photograph or other file\nEncryption - Transforming data into ciphertext, using a cipher.\nEncoding - NOT a form of encryption, just a form of data representation like base64. Immediately reversible.\nKey - Some information that is needed to correctly decrypt the ciphertext and obtain the plaintext.\nPassphrase - Separate to the key, a passphrase is similar to a password and used to protect a key.\nAsymmetric encryption - Uses different keys to encrypt and decrypt.\nSymmetric encryption - Uses the same key to encrypt and decrypt\nBrute force - Attacking cryptography by trying every different password or every different key\nCryptanalysis - Attacking cryptography by finding a weakness in the underlying maths\n\nAlice and Bob - Used to represent 2 people who generally want to communicate. They‚Äôre named Alice and Bob because this gives them the initials A and B. https://en.wikipedia.org/wiki/Alice_and_Bob for more information, as these extend through the alphabet to represent many different people involved in communication.\nWARNING: This room is very theory heavy. Cryptography is a big topic, and this room is designed to just scratch the surface.\nQuestions and Answers in the Task\nAre SSH keys protected with a passphrase or a password?Answer: Passphrase\n\nTASK 3 - Why Encryption is important ?Cryptography is used to protect confidentiality, ensure integrity, ensure authenticity. You use cryptography every day most likely, and you‚Äôre almost certainly reading this now over an encrypted connection.When logging into TryHackMe, your credentials were sent to the server. These were encrypted, otherwise someone would be able to capture them by snooping on your connection.When you connect to SSH, your client and the server establish an encrypted tunnel so that no one can snoop on your session.When you connect to your bank, there‚Äôs a certificate that uses cryptography to prove that it is actually your bank rather than a hacker.When you download a file, how do you check if it downloaded right? You can use cryptography here to verify a checksum of the data.You rarely have to interact directly with cryptography, but it silently protects almost everything you do digitally.\nWhenever sensitive user data needs to be stored, it should be encrypted. Standards like PCI-DSS state that the data should be encrypted both at rest (in storage) AND while being transmitted. If you‚Äôre handling payment card details, you need to comply with these PCI regulations. Medical data has similar standards. With legislation like GDPR and California‚Äôs data protection, data breaches are extremely costly and dangerous to you as either a consumer or a business.\nDO NOT encrypt passwords unless you‚Äôre doing something like a password manager. Passwords should not be stored in plaintext, and you should use hashing to manage them safely.\nQuestions and Answers in the task\nWhat Does SSH Stands For ?Answer: Secure Shell\nHow to Webservers prove their Identity?Answer: Certificates\nWhat is the main set of standards you need to comply with if you store or process payment card details?Answer: PCI-DSS\n\nTASK 4 - crucial Crypto MathsThere‚Äôs a little bit of math(s) that comes up relatively often in cryptography. The Modulo operator. Pretty much every programming language implements this operator, or has it available through a library. When you need to work with large numbers, use a programming language. Python is good for this as integers are unlimited in size, and you can easily get an interpreter.\nWhen learning division for the first time, you were probably taught to use remainders in your answer. X % Y is the remainder when X is divided by Y.\nExamples\n\n25 % 5 &#x3D; 0 (5*5 &#x3D; 25 so it divides exactly with no remainder)\n23 % 6 &#x3D; 5 (23 does not divide evenly by 6, there would be a remainder of 5)An important thing to remember about modulo is that it‚Äôs not reversible. If I gave you an equation: x % 5 &#x3D; 4, there are infinite values of x that will be valid.\n\nQuestions and Answers in the Task\nWhat‚Äôs 30 % 5?Answer : 0 \nWhat‚Äôs 25 % 7?Answer: 4\nWhat‚Äôs 118613842 % 9091?Answer: 3565\n\nTASK 5 - Types of EncryptionThe two main categories of Encryption are symmetric and symmetric.\nSymmetric encryption uses the same key to encrypt and decrypt the data. Examples of Symmetric encryption are DES (Broken) and AES. These algorithms tend to be faster than asymmetric cryptography, and use smaller keys (128 or 256 bit keys are common for AES, DES keys are 56 bits long).\nAsymmetric encryption uses a pair of keys, one to encrypt and the other in the pair to decrypt. Examples are RSA and Elliptic Curve Cryptography. Normally these keys are referred to as a public key and a private key. Data encrypted with the private key can be decrypted with the public key, and vice versa. Your private key needs to be kept private, hence the name. Asymmetric encryption tends to be slower and uses larger keys, for example RSA typically uses 2048 to 4096 bit keys.\nRSA and Elliptic Curve cryptography are based around different mathematically difficult (intractable) problems, which give them their strength. More about RSA later.\nQuestions and Answers in the task\nShould you trust DES? Yea&#x2F;NayAnswer: Nay\nWhat was the result of the attempt to make DES more secure so that it could be used for longer?Answer: Triple DES\nIs it ok to share your public key? Yea&#x2F;NayAnswer: Yea\n\nTask 6 - RSA - Rivest Shamir AdlemanThe math(s) sideRSA is based on the mathematically difficult problem of working out the factors of a large number. It‚Äôs very quick to multiply two prime numbers together, say 17*23 &#x3D; 391, but it‚Äôs quite difficult to work out what two prime numbers multiply together to make 14351 (113x127 for reference).\nThe attacking sideThe maths behind RSA seems to come up relatively often in CTFs, normally requiring you to calculate variables or break some encryption based on them. The wikipedia page for RSA seems complicated at first, but will give you almost all of the information you need in order to complete challenges.\nThere are some excellent tools for defeating RSA challenges in CTFs, and my personal favorite is https://github.com/Ganapati/RsaCtfTool which has worked very well for me. I‚Äôve also had some success with https://github.com/ius/rsatool.\nThe key variables that you need to know about for RSA in CTFs are p, q, m, n, e, d, and c.\n‚Äúp‚Äù and ‚Äúq‚Äù are large prime numbers, ‚Äún‚Äù is the product of p and q.\n\nThe public key is n and e, the private key is n and d.\n\n‚Äúm‚Äù is used to represent the message (in plaintext) and ‚Äúc‚Äù represents the ciphertext (encrypted text).\n\n\nCTFs involving RSACrypto CTF challenges often present you with a set of these values, and you need to break the encryption and decrypt a message to retrieve the flag.\nThere‚Äôs a lot more maths to RSA, and it gets quite complicated fairly quickly. If you want to learn the maths behind it, I recommend reading MuirlandOracle‚Äôs blog post here: https://muirlandoracle.co.uk/2020/01/29/rsa-encryption/.\nQuestions and Answers of the Task\np &#x3D; 4391, q &#x3D; 6659. What is n?Answer:Let‚Äôs Recall what is p , q &amp; np &amp; q are prime numbers and n is product of p&amp;qso n = p*qn = 4391*6659n = 29239669\n\nTASK 7 - Establishing Keys Using Asymmetric CryptographyA very common use of asymmetric cryptography is exchanging keys for symmetric encryption.Asymmetric encryption tends to be slower, so for things like HTTPS symmetric encryption is better.But the question is, how do you agree a key with the server without transmitting the key for people snooping to see?\nMetaphor timeImagine you have a secret code, and instructions for how to use the secret code. If you want to send your friend the instructions without anyone else being able to read it, what you could do is ask your friend for a lock.\nOnly they have the key for this lock, and we‚Äôll assume you have an indestructible box that you can lock with it.If you send the instructions in a locked box to your friend, they can unlock it once it reaches them and read the instructions.After that, you can communicate in the secret code without risk of people snooping.In this metaphor, the secret code represents a symmetric encryption key, the lock represents the server‚Äôs public key, and the key represents the server‚Äôs private key.You‚Äôve only used asymmetric cryptography once, so it‚Äôs fast, and you can now communicate privately with symmetric encryption.\nThe Real WorldIn reality, you need a little more cryptography to verify the person you‚Äôre talking to is who they say they are, which is done using digital signatures and certificates. You can find a lot more detail on how HTTPS (one example where you need to exchange keys) really works from this excellent blog post. https://robertheaton.com/2014/03/27/how-does-https-actually-work/\nTASK 8 - Digital Signatures and CertificatesWhat‚Äôs a Digital Signature?Digital signatures are a way to prove the authenticity of files, to prove who created or modified them. Using asymmetric cryptography, you produce a signature with your private key and it can be verified using your public key. As only you should have access to your private key, this proves you signed the file. Digital signatures and physical signatures have the same value in the UK, legally.\nThe simplest form of digital signature would be encrypting the document with your private key, and then if someone wanted to verify this signature they would decrypt it with your public key and check if the files match.\nCertificates - Prove who you are!Certificates are also a key use of public key cryptography, linked to digital signatures. A common place where they‚Äôre used is for HTTPS. How does your web browser know that the server you‚Äôre talking to is the real tryhackme.com?\nThe answer is certificates. The web server has a certificate that says it is the real tryhackme.com. The certificates have a chain of trust, starting with a root CA (certificate authority). Root CAs are automatically trusted by your device, OS, or browser from install. Certs below that are trusted because the Root CAs say they trust that organisation. Certificates below that are trusted because the organisation is trusted by the Root CA and so on. There are long chains of trust. Again, this blog post explains this much better than I can. https://robertheaton.com/2014/03/27/how-does-https-actually-work/\nYou can get your own HTTPS certificates for domains you own using Let‚Äôs Encrypt for free. If you run a website, it‚Äôs worth setting it up.\nQuestions and Answers of the Taks\nWho is TryHackMe‚Äôs HTTPS certificate issued by?Answer:you can check that using site setting which are generally showed in the address bar of your browserclikc on view certificate or lock icon to view the details of the siteso answer is E1\n\nTASK 9 - SSH AuthenticationEncryption and SSH authenticationBy default, SSH is authenticated using usernames and passwords in the same way that you would log in to the physical machine.\nAt some point, you‚Äôre almost certain to hit a machine that has SSH configured with key authentication instead. This uses public and private keys to prove that the client is a valid and authorised user on the server. By default, SSH keys are RSA keys. You can choose which algorithm to generate, and&#x2F;or add a passphrase to encrypt the SSH key. ssh-keygen is the program used to generate pairs of keys most of the time.\nSSH Private KeysYou should treat your private SSH keys like passwords. Don‚Äôt share them, they‚Äôre called private keys for a reason. If someone has your private key, they can use it to log in to servers that will accept it unless the key is encrypted.\nIt‚Äôs very important to mention that the passphrase to decrypt the key isn‚Äôt used to identify you to the server at all, all it does is decrypt the SSH key. The passphrase is never transmitted, and never leaves your system.\nUsing tools like John the Ripper, you can attack an encrypted SSH key to attempt to find the passphrase, which highlights the importance of using a secure passphrase and keeping your private key private.\nWhen generating an SSH key to log in to a remote machine, you should generate the keys on your machine and then copy the public key over as this means the private key never exists on the target machine. For temporary keys generated for access to CTF boxes, this doesn‚Äôt matter as much.\nHow do I use these keys?The ~/.ssh folder is the default place to store these keys for OpenSSH. The authorized_keys (note the US English spelling) file in this directory holds public keys that are allowed to access the server if key authentication is enabled. By default on many distros, key authentication is enabled as it is more secure than using a password to authenticate. Normally for the root user, only key authentication is enabled.\nIn order to use a private SSH key, the permissions must be set up correctly otherwise your SSH client will ignore the file with a warning. Only the owner should be able to read or write to the private key (600 or stricter). ssh -i keyNameGoesHere user@host is how you specify a key for the standard Linux OpenSSH client.\nUsing SSH keys to get a better shellSSH keys are an excellent way to ‚Äúupgrade‚Äù a reverse shell, assuming the user has login enabled (www-data normally does not, but regular users and root will). Leaving an SSH key in authorized_keys on a box can be a useful backdoor, and you don‚Äôt need to deal with any of the issues of unstabilised reverse shells like Control-C or lack of tab completion.Download the task files from here\nQuestions and answers in the task\nWhat algorithm does the key use?Answer:By looking at the file name we can say it uses rsa algorithm\nCrack the password with John The Ripper and rockyou, what‚Äôs the passphrase for the key?Answer:\n\n\nwe can crack the password &#x2F; passphrase of the key using John\nFirst we need extract the hash of the file by using:ssh2john id_rsa_1593558668558.id_rsa &gt; ssh_key.txt\nThen we need to crack the hash to find passphrase by usingjohn --wordlist=/usr/share/wordlists/rockyou.txt ssh_key.txt output:  So passphrase for the key is delicious\n\nTASK 10 - Explaining Diffie Hellman Key Exchange**What is Key Exchange?Key exchange allows 2 people&#x2F;parties to establish a set of common cryptographic keys without an observer being able to get these keys. Generally, to establish common symmetric keys.\nHow does Diffie Hellman Key Exchange work?Alice and Bob want to talk securely. They want to establish a common key, so they can use symmetric cryptography, but they don‚Äôt want to use key exchange with asymmetric cryptography. This is where DH Key Exchange comes in.\nAlice and Bob both have secrets that they generate, let‚Äôs call these A and B. They also have some common material that‚Äôs public, let‚Äôs call this C.\nWe need to make some assumptions. Firstly, whenever we combine secrets&#x2F;material it‚Äôs impossible or very very difficult to separate. Secondly, the order that they‚Äôre combined in doesn‚Äôt matter.\nAlice and Bob will combine their secrets with the common material, and form AC and BC. They will then send these to each other, and combine that with their secrets to form two identical keys, both ABC. Now they can use this key to communicate.\nExtra ResourcesAn excellent video if you want a visual explanation is available here. https://www.youtube.com/watch?v=NmM9HA2MQGI\nDH Key Exchange is often used alongside RSA public key cryptography, to prove the identity of the person you‚Äôre talking to with digital signing. This prevents someone from attacking the connection with a man-in-the-middle attack by pretending to be Bob.\nTASK 11 - PGP, GPG and AESWhat is PGP?PGP stands for Pretty Good Privacy. It‚Äôs a software that implements encryption for encrypting files, performing digital signing and more.\nWhat is GPG?GnuPG or GPG is an Open Source implementation of PGP from the GNU project. You may need to use GPG to decrypt files in CTFs. With PGP&#x2F;GPG, private keys can be protected with passphrases in a similar way to SSH private keys. If the key is passphrase protected, you can attempt to crack this passphrase using John The Ripper and gpg2john. The key provided in this task is not protected with a passphrase.The man page for GPG can be found online here.\nWhat about AES?AES, sometimes called Rijndael after its creators, stands for Advanced Encryption Standard. It was a replacement for DES which had short keys and other cryptographic flaws.\nAES and DES both operate on blocks of data (a block is a fixed size series of bits).\nAES is complicated to explain, and doesn‚Äôt seem to come up as often. If you‚Äôd like to learn how it works, here‚Äôs an excellent video from Computerphile https://www.youtube.com/watch?v=O4xNJsjtN6E\nDownload the Task Files From Here\nQuestions and Answers of the Task\nYou have the private key, and a file encrypted with the public key. Decrypt the file. What‚Äôs the secret word?Answer:\n\n\nwe can decrypt the message by using gpg utility in linux\nfirst we need to import the key usinggpg --import tryhackme.key\nNow we can directly decrypt the message by usinggpg message.gpg\nLet‚Äôs see the content of the message using catcat messageOUTPUT:so secret word is pineapple\n\nTask 12 The Future - Quantum Computers and EncryptionQuantum computers will soon be a problem for many types of encryption.\nAsymmetric and QuantumWhile it‚Äôs unlikely we‚Äôll have sufficiently powerful quantum computers until around 2030, once these exist encryption that uses RSA or Elliptical Curve Cryptography will be very fast to break. This is because quantum computers can very efficiently solve the mathematical problems that these algorithms rely on for their strength.\nAES&#x2F;DES and QuantumAES with 128 bit keys is also likely to be broken by quantum computers in the near future, but 256 bit AES can‚Äôt be broken as easily. Triple DES is also vulnerable to attacks from quantum computers.\nCurrent RecommendationsThe NSA recommends using RSA-3072 or better for asymmetric encryption and AES-256 or better for symmetric encryption. There are several competitions currently running for quantum safe cryptographic algorithms, and it‚Äôs likely that we will have a new encryption standard before quantum computers become a threat to RSA and AES.\nLearn More about Quantum Computers and CryptographyIf you‚Äôd like to learn more about this, NIST has resources that detail what the issues with current encryption is and the currently proposed solutions for these. https://doi.org/10.6028/NIST.IR.8105\nI also recommend the book &quot;Cryptography Apocalypse&quot; By Roger A. Grimes, as this was my introduction to quantum computing and quantum safe cryptography.\nThank You üíåAuthor: Satvik Shettyüßë‚ÄçüíªSee you again in another writeup\n","slug":"Encryption-101","date":"2024-05-21T10:34:20.000Z","categories_index":"cybersecurity,THM,cryptography","tags_index":"tryhackme,cryptography,hashing","author_index":"Satvik"},{"id":"2fabf1408eddff0177ed3e3bbe3ade2f","title":"Nmap Post Port Scans","content":"TASK 1 - Introduction:This room is the last in the Nmap series (part of the Introduction to Network Security module). In this room, we focus on the steps that follow port-scanning: in particular, service detection, OS detection, Nmap scripting engine, and saving the scan results.\nNmap Live Host DiscoveryNmap Basic Port ScansNmap Advanced Port ScansNmap Post Port ScansIn the first room of this series, we have learned how Nmap can enumerate targets, discover live hosts, and use reverse-DNS to find interesting names. The second and third rooms of the series focused on the basic and advanced types of scans for network ports.\nIn the last room, as shown in the figure below, we focus on how Nmap can be used to:\nDetect versions of the running services (on all open ports)Detect the OS based on any signs revealed by the targetRun Nmap‚Äôs tracerouteRun select Nmap scriptsSave the scan results in various formats\nThis room will focus on these steps and how to execute them after the port scan.\nQuestions and Answers of the task:\nTASK 2 - Service Detection:Once Nmap discovers open ports, you can probe the available port to detect the running service. Further investigation of open ports is an essential piece of information as the pentester can use it to learn if there are any known vulnerabilities of the service. Join Vulnerabilities 101 to learn more about searching for vulnerable services.\nAdding -sV to your Nmap command will collect and determine service and version information for the open ports. You can control the intensity with --version-intensity LEVEL where the level ranges between 0, the lightest, and 9, the most complete. -sV --version-light has an intensity of 2, while -sV --version-all has an intensity of 9.\nIt is important to note that using -sV will force Nmap to proceed with the TCP 3-way handshake and establish the connection. The connection establishment is necessary because Nmap cannot discover the version without establishing a connection fully and communicating with the listening service. In other words, stealth SYN scan -sS is not possible when -sV option is chosen.\nThe console output below shows a simple Nmap stealth SYN scan with the -sV option. Adding the -sV option leads to a new column in the output showing the version for each detected service. For instance, in the case of TCP port 22 being open, instead of 22&#x2F;tcp open ssh, we obtain 22&#x2F;tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0). Notice that the SSH protocol is guessed as the service because TCP port 22 is open; Nmap didn‚Äôt need to connect to port 22 to confirm. However, -sV required connecting to this open port to grab the service banner and any version information it can get, such as nginx 1.6.2. Hence, unlike the service column, the version column is not a guess.\nPentester Terminal\n1234567891011121314151617pentester@TryHackMe$ sudo nmap -sV MACHINE_IPStarting Nmap 7.60 ( https://nmap.org ) at 2021-09-10 05:03 BSTNmap scan report for MACHINE_IPHost is up (0.0040s latency).Not shown: 995 closed portsPORT    STATE SERVICE VERSION22/tcp  open  ssh     OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0)25/tcp  open  smtp    Postfix smtpd80/tcp  open  http    nginx 1.6.2110/tcp open  pop3    Dovecot pop3d111/tcp open  rpcbind 2-4 (RPC #100000)MAC Address: 02:A0:E7:B5:B6:C5 (Unknown)Service Info: Host:  debra2.thm.local; OS: Linux; CPE: cpe:/o:linux:linux_kernelService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 8.40 seconds\nNote that many Nmap options require root privileges. Unless you are running Nmap as root, you need to use sudo as in the example above.\nStart the VM. Once it is ready, open the terminal on the AttackBox to answer the following questions.\nQuestions and answers of the task\nTASK 3 - OS Detection and TraceRouteOS DetectionNmap can detect the Operating System (OS) based on its behaviour and any telltale signs in its responses. OS detection can be enabled using -O ; this is an uppercase O as in OS. In this example, we ran nmap -sS -O  MACHINE_IP on the AttackBox. Nmap detected the OS to be Linux 3.X, and then it guessed further that it was running kernel 3.13.\nPentester Terminal\n12345678910111213141516171819202122pentester@TryHackMe$ sudo nmap -sS -O  MACHINE_IPStarting Nmap 7.60 ( https://nmap.org ) at 2021-09-10 05:04 BSTNmap scan report for MACHINE_IPHost is up (0.00099s latency).Not shown: 994 closed portsPORT    STATE SERVICE22/tcp  open  ssh25/tcp  open  smtp80/tcp  open  http110/tcp open  pop3111/tcp open  rpcbind143/tcp open  imapMAC Address: 02:A0:E7:B5:B6:C5 (Unknown)Device type: general purposeRunning: Linux 3.XOS CPE: cpe:/o:linux:linux_kernel:3.13OS details: Linux 3.13Network Distance: 1 hopOS detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 3.91 seconds\nThe system that we scanned and attempted to detect its OS version is running kernel version 3.16. Nmap was able to make a close guess in this case. In another case, we scanned a Fedora Linux system with kernel 5.13.14; however, Nmap detected it as Linux 2.6.X. The good news is that Nmap detected the OS correctly; the not-so-good news is that the kernel version was wrong.\nThe OS detection is very convenient, but many factors might affect its accuracy. First and foremost, Nmap needs to find at least one open and one closed port on the target to make a reliable guess. Furthermore, the guest OS fingerprints might get distorted due to the rising use of virtualization and similar technologies. Therefore, always take the OS version with a grain of salt.\nTracerouteIf you want Nmap to find the routers between you and the target, just add --traceroute. In the following example, Nmap appended a traceroute to its scan results. Note that Nmap‚Äôs traceroute works slightly different than the traceroute command found on Linux and macOS or tracert found on MS Windows. Standard traceroute starts with a packet of low TTL (Time to Live) and keeps increasing until it reaches the target. Nmap‚Äôs traceroute starts with a packet of high TTL and keeps decreasing it.\nIn the following example, we executed nmap -sS --traceroute MACHINE_IP on the AttackBox. We can see that there are no routers&#x2F;hops between the two as they are connected directly.\nPentester Terminal\n1234567891011121314151617181920pentester@TryHackMe$ sudo nmap -sS --traceroute MACHINE_IPStarting Nmap 7.60 ( https://nmap.org ) at 2021-09-10 05:05 BSTNmap scan report for MACHINE_IPHost is up (0.0015s latency).Not shown: 994 closed portsPORT    STATE SERVICE22/tcp  open  ssh25/tcp  open  smtp80/tcp  open  http110/tcp open  pop3111/tcp open  rpcbind143/tcp open  imapMAC Address: 02:A0:E7:B5:B6:C5 (Unknown)TRACEROUTEHOP RTT     ADDRESS1   1.48 ms MACHINE_IPNmap done: 1 IP address (1 host up) scanned in 1.59 seconds\nIt is worth mentioning that many routers are configured not to send ICMP Time-to-Live exceeded, which would prevent us from discovering their IP addresses. For more information, visit the Active Reconnaissance room.\nQuestions and answers of this Task\nTASK -4 NMAP Scripting Engine[NSE]A script is a piece of code that does not need to be compiled. In other words, it remains in its original human-readable form and does not need to be converted to machine language. Many programs provide additional functionality via scripts; moreover, scripts make it possible to add custom functionality that did not exist via the built-in commands. Similarly, Nmap provides support for scripts using the Lua language. A part of Nmap, Nmap Scripting Engine (NSE) is a Lua interpreter that allows Nmap to execute Nmap scripts written in Lua language. However, we don‚Äôt need to learn Lua to make use of Nmap scripts.\nYour Nmap default installation can easily contain close to 600 scripts. Take a look at your Nmap installation folder. On the AttackBox, check the files at &#x2F;usr&#x2F;share&#x2F;nmap&#x2F;scripts, and you will notice that there are hundreds of scripts conveniently named starting with the protocol they target. We listed all the scripts starting with the HTTP on the AttackBox in the console output below; we found around 130 scripts starting with http. With future updates, you can only expect the number of installed scripts to increase.\nPentester Terminal\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566pentester@AttackBox /usr/share/nmap/scripts# ls http*http-adobe-coldfusion-apsa1301.nse      http-passwd.nsehttp-affiliate-id.nse                   http-php-version.nsehttp-apache-negotiation.nse             http-phpmyadmin-dir-traversal.nsehttp-apache-server-status.nse           http-phpself-xss.nsehttp-aspnet-debug.nse                   http-proxy-brute.nsehttp-auth-finder.nse                    http-put.nsehttp-auth.nse                           http-qnap-nas-info.nsehttp-avaya-ipoffice-users.nse           http-referer-checker.nsehttp-awstatstotals-exec.nse             http-rfi-spider.nsehttp-axis2-dir-traversal.nse            http-robots.txt.nsehttp-backup-finder.nse                  http-robtex-reverse-ip.nsehttp-barracuda-dir-traversal.nse        http-robtex-shared-ns.nsehttp-brute.nse                          http-security-headers.nsehttp-cakephp-version.nse                http-server-header.nsehttp-chrono.nse                         http-shellshock.nsehttp-cisco-anyconnect.nse               http-sitemap-generator.nsehttp-coldfusion-subzero.nse             http-slowloris-check.nsehttp-comments-displayer.nse             http-slowloris.nsehttp-config-backup.nse                  http-sql-injection.nsehttp-cookie-flags.nse                   http-stored-xss.nsehttp-cors.nse                           http-svn-enum.nsehttp-cross-domain-policy.nse            http-svn-info.nsehttp-csrf.nse                           http-title.nsehttp-date.nse                           http-tplink-dir-traversal.nsehttp-default-accounts.nse               http-trace.nsehttp-devframework.nse                   http-traceroute.nsehttp-dlink-backdoor.nse                 http-unsafe-output-escaping.nsehttp-dombased-xss.nse                   http-useragent-tester.nsehttp-domino-enum-passwords.nse          http-userdir-enum.nsehttp-drupal-enum-users.nse              http-vhosts.nsehttp-drupal-enum.nse                    http-virustotal.nsehttp-enum.nse                           http-vlcstreamer-ls.nsehttp-errors.nse                         http-vmware-path-vuln.nsehttp-exif-spider.nse                    http-vuln-cve2006-3392.nsehttp-favicon.nse                        http-vuln-cve2009-3960.nsehttp-feed.nse                           http-vuln-cve2010-0738.nsehttp-fetch.nse                          http-vuln-cve2010-2861.nsehttp-fileupload-exploiter.nse           http-vuln-cve2011-3192.nsehttp-form-brute.nse                     http-vuln-cve2011-3368.nsehttp-form-fuzzer.nse                    http-vuln-cve2012-1823.nsehttp-frontpage-login.nse                http-vuln-cve2013-0156.nsehttp-generator.nse                      http-vuln-cve2013-6786.nsehttp-git.nse                            http-vuln-cve2013-7091.nsehttp-gitweb-projects-enum.nse           http-vuln-cve2014-2126.nsehttp-google-malware.nse                 http-vuln-cve2014-2127.nsehttp-grep.nse                           http-vuln-cve2014-2128.nsehttp-headers.nse                        http-vuln-cve2014-2129.nsehttp-huawei-hg5xx-vuln.nse              http-vuln-cve2014-3704.nsehttp-icloud-findmyiphone.nse            http-vuln-cve2014-8877.nsehttp-icloud-sendmsg.nse                 http-vuln-cve2015-1427.nsehttp-iis-short-name-brute.nse           http-vuln-cve2015-1635.nsehttp-iis-webdav-vuln.nse                http-vuln-cve2017-1001000.nsehttp-internal-ip-disclosure.nse         http-vuln-cve2017-5638.nsehttp-joomla-brute.nse                   http-vuln-cve2017-5689.nsehttp-litespeed-sourcecode-download.nse  http-vuln-cve2017-8917.nsehttp-ls.nse                             http-vuln-misfortune-cookie.nsehttp-majordomo2-dir-traversal.nse       http-vuln-wnr1000-creds.nsehttp-malware-host.nse                   http-waf-detect.nsehttp-mcmp.nse                           http-waf-fingerprint.nsehttp-method-tamper.nse                  http-webdav-scan.nsehttp-methods.nse                        http-wordpress-brute.nsehttp-mobileversion-checker.nse          http-wordpress-enum.nsehttp-ntlm-info.nse                      http-wordpress-users.nsehttp-open-proxy.nse                     http-xssed.nsehttp-open-redirect.nse\nYou can specify to use any or a group of these installed scripts; moreover, you can install other user‚Äôs scripts and use them for your scans. Let‚Äôs begin with the default scripts. You can choose to run the scripts in the default category using ‚Äìscript&#x3D;default or simply adding -sC. In addition to default, categories include auth, broadcast, brute, default, discovery, dos, exploit, external, fuzzer, intrusive, malware, safe, version, and vuln. A brief description is shown in the following table.\n\n\n\nScript Category\nDescription\n\n\n\nauth\nAuthentication related scripts\n\n\nbroadcast\nDiscover hosts by sending broadcast messages\n\n\nbrute\nPerforms brute-force password auditing against logins\n\n\ndefault\nDefault scripts, same as -sC\n\n\ndiscovery\nRetrieve accessible information, such as database tables and DNS names\n\n\ndos\nDetects servers vulnerable to Denial of Service (DoS)\n\n\nexploit\nAttempts to exploit various vulnerable services\n\n\nexternal\nChecks using a third-party service, such as Geoplugin and Virustotal\n\n\nfuzzer\nLaunch fuzzing attacks\n\n\nintrusive\nIntrusive scripts such as brute-force attacks and exploitation\n\n\nmalware\nScans for backdoors\n\n\nsafe\nSafe scripts that won‚Äôt crash the target\n\n\nversion\nRetrieve service versions\n\n\nvuln\nChecks for vulnerabilities or exploit vulnerable services\n\n\nSome scripts belong to more than one category. Moreover, some scripts launch brute-force attacks against services, while others launch DoS attacks and exploit systems. Hence, it is crucial to be careful when selecting scripts to run if you don‚Äôt want to crash services or exploit them.\nWe use Nmap to run a SYN scan against MACHINE_IP and execute the default scripts in the console shown below. The command is sudo nmap -sS -sC MACHINE_IP, where -sC will ensure that Nmap will execute the default scripts following the SYN scan. There are new details that appear below. Take a look at the SSH service at port 22; Nmap recovered all four public keys related to the running server. Consider another example, the HTTP service at port 80; Nmap retrieved the default page title. We can see that the page has been left as default.\nPentester Terminal\n1234567891011121314151617181920212223242526272829303132333435pentester@TryHackMe$ sudo nmap -sS -sC MACHINE_IPStarting Nmap 7.60 ( https://nmap.org ) at 2021-09-10 05:08 BSTNmap scan report for ip-10-10-161-170.eu-west-1.compute.internal (10.10.161.170)Host is up (0.0011s latency).Not shown: 994 closed portsPORT    STATE SERVICE22/tcp  open  ssh| ssh-hostkey: |   1024 d5:80:97:a3:a8:3b:57:78:2f:0a:78:ae:ad:34:24:f4 (DSA)|   2048 aa:66:7a:45:eb:d1:8c:00:e3:12:31:d8:76:8e:ed:3a (RSA)|   256 3d:82:72:a3:07:49:2e:cb:d9:87:db:08:c6:90:56:65 (ECDSA)|_  256 dc:f0:0c:89:70:87:65:ba:52:b1:e9:59:f7:5d:d2:6a (EdDSA)25/tcp  open  smtp|_smtp-commands: debra2.thm.local, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, | ssl-cert: Subject: commonName=debra2.thm.local| Not valid before: 2021-08-10T12:10:58|_Not valid after:  2031-08-08T12:10:58|_ssl-date: TLS randomness does not represent time80/tcp  open  http|_http-title: Welcome to nginx on Debian!110/tcp open  pop3|_pop3-capabilities: RESP-CODES CAPA TOP SASL UIDL PIPELINING AUTH-RESP-CODE111/tcp open  rpcbind| rpcinfo: |   program version   port/proto  service|   100000  2,3,4        111/tcp  rpcbind|   100000  2,3,4        111/udp  rpcbind|   100024  1          38099/tcp  status|_  100024  1          54067/udp  status143/tcp open  imap|_imap-capabilities: LITERAL+ capabilities IMAP4rev1 OK Pre-login ENABLE have LOGINDISABLEDA0001 listed SASL-IR ID more post-login LOGIN-REFERRALS IDLEMAC Address: 02:A0:E7:B5:B6:C5 (Unknown)Nmap done: 1 IP address (1 host up) scanned in 2.21 seconds \nYou can also specify the script by name using ‚Äìscript ‚ÄúSCRIPT-NAME‚Äù or a pattern such as ‚Äìscript ‚Äúftp*‚Äù, which would include ftp-brute. If you are unsure what a script does, you can open the script file with a text reader, such as less, or a text editor. In the case of ftp-brute, it states: ‚ÄúPerforms brute force password auditing against FTP servers.‚Äù You have to be careful as some scripts are pretty intrusive. Moreover, some scripts might be for a specific server and, if chosen at random, will waste your time with no benefit. As usual, make sure that you are authorized to launch such tests on the target server.\nLet‚Äôs consider a benign script, http-date, which we guess would retrieve the http server date and time, and this is indeed confirmed in its description: ‚ÄúGets the date from HTTP-like services. Also, it prints how much the date differs from local time‚Ä¶‚Äù On the AttackBox, we execute sudo nmap -sS -n ‚Äìscript ‚Äúhttp-date‚Äù MACHINE_IP as shown in the console below.\nPentester Terminal\n1234567891011121314151617pentester@TryHackMe$ sudo nmap -sS -n --script &quot;http-date&quot; MACHINE_IPStarting Nmap 7.60 ( https://nmap.org ) at 2021-09-10 08:04 BSTNmap scan report for MACHINE_IPHost is up (0.0011s latency).Not shown: 994 closed portsPORT    STATE SERVICE22/tcp  open  ssh25/tcp  open  smtp80/tcp  open  http|_http-date: Fri, 10 Sep 2021 07:04:26 GMT; 0s from local time.110/tcp open  pop3111/tcp open  rpcbind143/tcp open  imapMAC Address: 02:44:87:82:AC:83 (Unknown)Nmap done: 1 IP address (1 host up) scanned in 1.78 seconds\nFinally, you might expand the functionality of Nmap beyond the official Nmap scripts; you can write your script or download Nmap scripts from the Internet. Downloading and using a Nmap script from the Internet holds a certain level of risk. So it is a good idea not to run a script from an author you don‚Äôt trust.\nQuestions and Answers of the Task\nTASK - 5 Saving the Output:Whenever you run a Nmap scan, it is only reasonable to save the results in a file. Selecting and adopting a good naming convention for your filenames is also crucial. The number of files can quickly grow and hinder your ability to find a previous scan result. The three main formats are:\n-Normal-Grepable (grepable)-XMLThere is a fourth one that we cannot recommend:-Script Kiddie\nNormalAs the name implies, the normal format is similar to the output you get on the screen when scanning a target. You can save your scan in normal format by using -oN FILENAME; N stands for normal. Here is an example of the result.\nPentester Terminal\n12345678910111213141516171819202122pentester@TryHackMe$ cat MACHINE_IP_scan.nmap # Nmap 7.60 scan initiated Fri Sep 10 05:14:19 2021 as: nmap -sS -sV -O -oN MACHINE_IP_scan MACHINE_IPNmap scan report for MACHINE_IPHost is up (0.00086s latency).Not shown: 994 closed portsPORT    STATE SERVICE VERSION22/tcp  open  ssh     OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0)25/tcp  open  smtp    Postfix smtpd80/tcp  open  http    nginx 1.6.2110/tcp open  pop3    Dovecot pop3d111/tcp open  rpcbind 2-4 (RPC #100000)143/tcp open  imap    Dovecot imapdMAC Address: 02:A0:E7:B5:B6:C5 (Unknown)Device type: general purposeRunning: Linux 3.XOS CPE: cpe:/o:linux:linux_kernel:3.13OS details: Linux 3.13Network Distance: 1 hopService Info: Host:  debra2.thm.local; OS: Linux; CPE: cpe:/o:linux:linux_kernelOS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .# Nmap done at Fri Sep 10 05:14:28 2021 -- 1 IP address (1 host up) scanned in 9.99 seconds\nGrepableThe grepable format has its name from the command grep; grep stands for Global Regular Expression Printer. In simple terms, it makes filtering the scan output for specific keywords or terms efficient. You can save the scan result in grepable format using -oG FILENAME. The scan output, displayed above in normal format, is shown in the console below using grepable format. The normal output is 21 lines; however, the grepable output is only 4 lines. The main reason is that Nmap wants to make each line meaningful and complete when the user applies grep. As a result, in grepable output, the lines are so long and are not convenient to read compared to normal output.\nPentester Terminal\n12345pentester@TryHackMe$ cat MACHINE_IP_scan.gnmap # Nmap 7.60 scan initiated Fri Sep 10 05:14:19 2021 as: nmap -sS -sV -O -oG MACHINE_IP_scan MACHINE_IPHost: MACHINE_IP\tStatus: UpHost: MACHINE_IP\tPorts: 22/open/tcp//ssh//OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0)/, 25/open/tcp//smtp//Postfix smtpd/, 80/open/tcp//http//nginx 1.6.2/, 110/open/tcp//pop3//Dovecot pop3d/, 111/open/tcp//rpcbind//2-4 (RPC #100000)/, 143/open/tcp//imap//Dovecot imapd/\tIgnored State: closed (994)\tOS: Linux 3.13\tSeq Index: 257\tIP ID Seq: All zeros# Nmap done at Fri Sep 10 05:14:28 2021 -- 1 IP address (1 host up) scanned in 9.99 seconds\nAn example use of grep is grep KEYWORD TEXT_FILE; this command will display all the lines containing the provided keyword. Let‚Äôs compare the output of using grep on normal output and grepable output. You will notice that the former does not provide the IP address of the host. Instead, it returned 80&#x2F;tcp open http nginx 1.6.2, making it very inconvenient if you are sifting through the scan results of multiple systems. However, the latter provides enough information, such as the host‚Äôs IP address, in each line to make it complete.\nPentester Terminal\n123456pentester@TryHackMe$ grep http MACHINE_IP_scan.nmap 80/tcp  open  http    nginx 1.6.2OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .Pentester Terminalpentester@TryHackMe$ grep http MACHINE_IP_scan.gnmap Host: MACHINE_IP\tPorts: 22/open/tcp//ssh//OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0)/, 25/open/tcp//smtp//Postfix smtpd/, 80/open/tcp//http//nginx 1.6.2/, 110/open/tcp//pop3//Dovecot pop3d/, 111/open/tcp//rpcbind//2-4 (RPC #100000)/, 143/open/tcp//imap//Dovecot imapd/\tIgnored State: closed (994)\tOS: Linux 3.13\tSeq Index: 257\tIP ID Seq: All zeros\nXMLThe third format is XML. You can save the scan results in XML format using -oX FILENAME. The XML format would be most convenient to process the output in other programs. Conveniently enough, you can save the scan output in all three formats using -oA FILENAME to combine -oN, -oG, and -oX for normal, grepable, and XML.\nScript KiddieA fourth format is script kiddie. You can see that this format is useless if you want to search the output for any interesting keywords or keep the results for future reference. However, you can use it to save the output of the scan nmap -sS 127.0.0.1 -oS FILENAME, display the output filename, and look 31337 in front of friends who are not tech-savvy.\nPentester Terminal\n12345678910111213141516171819pentester@TryHackMe$ cat MACHINE_IP_scan.kiddie $tart!ng nMaP 7.60 ( httpz://nMap.0rG ) at 2021-09-10 05:17 B$TNmap scan rEp0rt f0r |p-10-10-161-170.EU-w3$t-1.C0mputE.intErnaL (10.10.161.170)HOSt !s uP (0.00095s LatEncy).N0T $H0wn: 994 closed pOrtSPoRT    st4Te SeRViC3 VERS1on22/tcp  Open  ssH     Op3n$$H 6.7p1 Deb|an 5+dEb8u8 (pr0t0COl 2.0)25/tCp  Op3n  SmTp    P0$Tf!x Smtpd80/tcp  0p3n  http    Ng1nx 1.6.2110/tCP 0pen  pOP3    d0v3coT P0p3D111/TcP op3n  RpcbInd 2-4 (RPC #100000)143/Tcp opEn  Imap    Dovecot 1mApdmAC 4Ddr3sz: 02:40:e7:B5:B6:c5 (Unknown)Netw0rk d!stanc3: 1 h0p$3rv1c3 InFO: Ho$t:  dEBra2.thM.lOcal; 0s: Linux; cPe: cP3:/0:linux:l|nux_k3rnel0S and servIc3 D3tEcti0n pErf0rm3d. Plea$e r3p0rt any !nc0RrecT rE$ultz at hTtpz://nmap.0rg/$ubmit/ .Nmap d0nE: 1 |P addr3SS (1 hoSt up) $CaNnEd !n 21.80 s3c0Ndz \n\nQuestions and answers of this Task\nSUMMARYSummary of Nmap Options\nIn this room, we learned how to detect the running services and their versions along with the host operating system. We learned how to enable traceroute and we covered selecting one or more scripts to aid in penetration testing. Finally, we covered the different formats to save the scan results for future reference. The table below summarizes the most important options we covered in this room.\n\n\n\nOption\nMeaning\n\n\n\n-sV\ndetermine service&#x2F;version info on open ports\n\n\n-sV ‚Äìversion-light\ntry the most likely probes (2)\n\n\n-sV ‚Äìversion-all\ntry all available probes (9)\n\n\n-O\ndetect OS\n\n\n‚Äìtraceroute\nrun traceroute to target\n\n\n‚Äìscript&#x3D;SCRIPTS\nNmap scripts to run\n\n\n-sC or ‚Äìscript&#x3D;default\nrun default scripts\n\n\n-A\nequivalent to -sV -O -sC ‚Äìtraceroute\n\n\n-oN\nsave output in normal format\n\n\n-oG\nsave output in grepable format\n\n\n-oX\nsave output in XML format\n\n\n-oA\nsave output in normal, XML and Grepable formats\n\n\nThank you,Author : Satvik ‚ù§Ô∏è\n","slug":"Nmap-Post-Port-Scans","date":"2024-05-18T11:07:59.000Z","categories_index":"cybersecurity,THM,NMAP","tags_index":"tryhackme,nmap,information-gathering","author_index":"Satvik"},{"id":"cea3414c622367bb74c9fe88dd9fca82","title":"Nmap Advanced Port Scans","content":"Cheatsheet of the commands used in this room\n\n\nPort Scan Type\nExample Command\n\n\n\nTCP Null Scan\nsudo nmap -sN 10.10.214.83\n\n\nTCP FIN Scan\nsudo nmap -sF 10.10.214.83\n\n\nTCP Xmas Scan\nsudo nmap -sX 10.10.214.83\n\n\nTCP Maimon Scan\nsudo nmap -sM 10.10.214.83\n\n\nTCP ACK Scan\nsudo nmap -sA 10.10.214.83\n\n\nTCP Window Scan\nsudo nmap -sW 10.10.214.83\n\n\nCustom TCP Scan\nsudo nmap ‚Äìscanflags URGACKPSHRSTSYNFIN 10.10.214.83\n\n\nSpoofed Source IP\nsudo nmap -S SPOOFED_IP 10.10.214.83\n\n\nSpoofed MAC Address\n‚Äìspoof-mac SPOOFED_MAC\n\n\nDecoy Scan\nnmap -D DECOY_IP,ME 10.10.214.83\n\n\nIdle (Zombie) Scan\nsudo nmap -sI ZOMBIE_IP 10.10.214.83\n\n\nFragment IP data into 8 bytes\n-f\n\n\nFragment IP data into 16 bytes\n-ff\n\n\n\n\n\nOption\nPurpose\n\n\n\n‚Äìsource-port PORT_NUM\nspecify source port number\n\n\n‚Äìdata-length NUM\nappend random data to reach given length\n\n\nThese scan types rely on setting TCP flags in unexpected ways to prompt ports for a reply. Null, FIN, and Xmas scans provoke a response from closed ports, while Maimon, ACK, and Window scans provoke a response from open and closed ports.\n\n\n\nOption\nPurpose\n\n\n\n‚Äìreason\nexplains how Nmap made its conclusion\n\n\n-v\nverbose\n\n\n-vv\nvery verbose\n\n\n-d\ndebugging\n\n\n-dd\nmore details for debugging\n\n\n\nIntroductionThis room is the third in the Nmap series (part of the Introduction to Network Security module). In the first two rooms, we learned about live host discovery and basic port scans.\n\nNmap Live Host Discovery\nNmap Basic Port Scans\nNmap Advanced Port Scans\nNmap Post Port ScansIn Nmap Basic Port Scans, we covered TCP flags and reviewed the TCP 3-way handshake. To initiate a connection, TCP requires the first packet to have the SYN flag set. Consequently, we can tell if a TCP port is open based on the response we receive.\n\nSecurity researchers and hackers contemplated the TCP flags, shown in the figure below and explained in the previous room, and started to experiment. They wanted to know what would happen if we send a TCP packet, which is not part of any ongoing TCP connection, with one or more flags set.\n\nFor instance, an ACK flag is set when you want to acknowledge received data. An ACK scan is like trying to acknowledge data that was neither sent nor received in the first place. Consider this simple analogy, someone coming to you out of nowhere to tell you, ‚Äúyes, I hear you, please continue.‚Äù when you haven‚Äôt said anything.\nThis room explains advanced types of scans and scan options. Some of these scan types can be useful against specific systems, while others are useful in particular network setups. We will cover the following types of port scans:\nNull ScanFIN ScanXmas ScanMaimon ScanACK ScanWindow ScanCustom Scan\nMoreover, we will cover the following:\nSpoofing IPSpoofing MACDecoy ScanFragmented PacketsIdle&#x2F;Zombie ScanWe will discuss options and techniques to evade firewalls and IDS systems. We also cover options to get more verbose details from Nmap.\nQuestions &amp; Answers in the TaskLaunch the AttackBox by using the Start AttackBox button and get ready to experiment with different types of Nmap scans against different virtual machines.Answer : Click Submit\nTASK-2 TCP Null Scan, FIN Scan, and Xmas ScanLet‚Äôs start with the following three types of scans:\n\nNull Scan\nFIN Scan\nXmas Scan\n\nNull ScanThe null scan does not set any flag; all six flag bits are set to zero. You can choose this scan using the -sN option. A TCP packet with no flags set will not trigger any response when it reaches an open port, as shown in the figure below. Therefore, from Nmap‚Äôs perspective, a lack of reply in a null scan indicates that either the port is open or a firewall is blocking the packet.\n\nHowever, we expect the target server to respond with an RST packet if the port is closed. Consequently, we can use the lack of RST response to figure out the ports that are not closed: open or filtered.\n\nBelow is an example of a null scan against a Linux server. The null scan we carried out has successfully identified the six open ports on the target system. Because the null scan relies on the lack of a response to infer that the port is not closed, it cannot indicate with certainty that these ports are open; there is a possibility that the ports are not responding due to a firewall rule.\nPentester Terminal\n12345678910111213141516pentester@TryHackMe$ sudo nmap -sN MACHINE_IPStarting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 10:30 BSTNmap scan report for MACHINE_IPHost is up (0.00066s latency).Not shown: 994 closed portsPORT    STATE         SERVICE22/tcp  open|filtered ssh25/tcp  open|filtered smtp80/tcp  open|filtered http110/tcp open|filtered pop3111/tcp open|filtered rpcbind143/tcp open|filtered imapMAC Address: 02:45:BF:8A:2D:6B (Unknown)Nmap done: 1 IP address (1 host up) scanned in 96.50 seconds\nNote that many Nmap options require root privileges. Unless you are running Nmap as root, you need to use sudo as in the example above using the -sN option.\nFIN ScanThe FIN scan sends a TCP packet with the FIN flag set. You can choose this scan type using the -sF option. Similarly, no response will be sent if the TCP port is open. Again, Nmap cannot be sure if the port is open or if a firewall is blocking the traffic related to this TCP port.\n\nHowever, the target system should respond with an RST if the port is closed. Consequently, we will be able to know which ports are closed and use this knowledge to infer the ports that are open or filtered. It‚Äôs worth noting some firewalls will ‚Äòsilently‚Äô drop the traffic without sending an RST.\n\nBelow is an example of a FIN scan against a Linux server. The result is quite similar to the result we obtained earlier using a null scan.\nPentester Terminal\n12345678910111213141516pentester@TryHackMe$ sudo nmap -sF MACHINE_IPStarting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 10:32 BSTNmap scan report for MACHINE_IPHost is up (0.0018s latency).Not shown: 994 closed portsPORT    STATE         SERVICE22/tcp  open|filtered ssh25/tcp  open|filtered smtp80/tcp  open|filtered http110/tcp open|filtered pop3111/tcp open|filtered rpcbind143/tcp open|filtered imapMAC Address: 02:45:BF:8A:2D:6B (Unknown)Nmap done: 1 IP address (1 host up) scanned in 96.52 seconds\n\nXmas ScanThe Xmas scan gets its name after Christmas tree lights. An Xmas scan sets the FIN, PSH, and URG flags simultaneously. You can select Xmas scan with the option -sX.\nLike the Null scan and FIN scan, if an RST packet is received, it means that the port is closed. Otherwise, it will be reported as open|filtered.\nThe following two figures show the case when the TCP port is open and the case when the TCP port is closed.\n\nThe console output below shows an example of a Xmas scan against a Linux server. The obtained results are pretty similar to that of the null scan and the FIN scan.\nPentester Terminal\n1234567891011121314151617pentester@TryHackMe$ sudo nmap -sX MACHINE_IPStarting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 10:34 BSTNmap scan report for MACHINE_IPHost is up (0.00087s latency).Not shown: 994 closed portsPORT    STATE         SERVICE22/tcp  open|filtered ssh25/tcp  open|filtered smtp80/tcp  open|filtered http110/tcp open|filtered pop3111/tcp open|filtered rpcbind143/tcp open|filtered imapMAC Address: 02:45:BF:8A:2D:6B (Unknown)Nmap done: 1 IP address (1 host up) scanned in 84.85 seconds\nOne scenario where these three scan types can be efficient is when scanning a target behind a stateless (non-stateful) firewall. A stateless firewall will check if the incoming packet has the SYN flag set to detect a connection attempt. Using a flag combination that does not match the SYN packet makes it possible to deceive the firewall and reach the system behind it. However, a stateful firewall will practically block all such crafted packets and render this kind of scan useless.\nQuestions and answers of the task\nTASK 3 - TCP  Maimon ScanUriel Maimon first described this scan in 1996. In this scan, the FIN and ACK bits are set. The target should send an RST packet as a response. However, certain BSD-derived systems drop the packet if it is an open port exposing the open ports. This scan won‚Äôt work on most targets encountered in modern networks; however, we include it in this room to better understand the port scanning mechanism and the hacking mindset. To select this scan type, use the -sM option.\nMost target systems respond with an RST packet regardless of whether the TCP port is open. In such a case, we won‚Äôt be able to discover the open ports. The figure below shows the expected behaviour in the cases of both open and closed TCP ports.\n\nThe console output below is an example of a TCP Maimon scan against a Linux server. As mentioned, because open ports and closed ports are behaving the same way, the Maimon scan could not discover any open ports on the target system.\nPentester Terminal\n123456789pentester@TryHackMe$ sudo nmap -sM 10.10.252.27Starting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 10:36 BSTNmap scan report for ip-10-10-252-27.eu-west-1.compute.internal (10.10.252.27)Host is up (0.00095s latency).All 1000 scanned ports on ip-10-10-252-27.eu-west-1.compute.internal (10.10.252.27) are closedMAC Address: 02:45:BF:8A:2D:6B (Unknown)Nmap done: 1 IP address (1 host up) scanned in 1.61 seconds\nThis type of scan is not the first scan one would pick to discover a system; however, it is important to know about it as you don‚Äôt know when it could come in handy.\nQuestions&amp;Answers of the task\nTASK 4 - TCP ACK, Window, and Custom ScanThis task will cover how to perform a TCP ACK scan, a TCP window scan, and how to create your custom flag scan.\nTCP ACK ScanLet‚Äôs start with the TCP ACK scan. As the name implies, an ACK scan will send a TCP packet with the ACK flag set. Use the -sA option to choose this scan. As we show in the figure below, the target would respond to the ACK with RST regardless of the state of the port. This behaviour happens because a TCP packet with the ACK flag set should be sent only in response to a received TCP packet to acknowledge the receipt of some data, unlike our case. Hence, this scan won‚Äôt tell us whether the target port is open in a simple setup.\n\nIn the following example, we scanned the target VM before installing a firewall on it. As expected, we couldn‚Äôt learn which ports were open.\nPentester Terminal\n123456789pentester@TryHackMe$ sudo nmap -sA MACHINE_IPStarting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 10:37 BSTNmap scan report for MACHINE_IPHost is up (0.0013s latency).All 1000 scanned ports on MACHINE_IP are unfilteredMAC Address: 02:45:BF:8A:2D:6B (Unknown)Nmap done: 1 IP address (1 host up) scanned in 1.68 seconds\nThis kind of scan would be helpful if there is a firewall in front of the target. Consequently, based on which ACK packets resulted in responses, you will learn which ports were not blocked by the firewall. In other words, this type of scan is more suitable to discover firewall rule sets and configuration.\nAfter setting up the target VM MACHINE_IP with a firewall, we repeated the ACK scan. This time, we received some interesting results. As seen in the console output below, we have three ports that aren‚Äôt being blocked by the firewall. This result indicates that the firewall is blocking all other ports except for these three ports.\nPentester Terminal\n12345678910111213pentester@TryHackMe$ sudo nmap -sA MACHINE_IPStarting Nmap 7.60 ( https://nmap.org ) at 2021-09-07 11:34 BSTNmap scan report for MACHINE_IPHost is up (0.00046s latency).Not shown: 997 filtered portsPORT    STATE      SERVICE22/tcp  unfiltered ssh25/tcp  unfiltered smtp80/tcp  unfiltered httpMAC Address: 02:78:C0:D0:4E:E9 (Unknown)Nmap done: 1 IP address (1 host up) scanned in 15.45 seconds\n\nWindow ScanAnother similar scan is the TCP window scan. The TCP window scan is almost the same as the ACK scan; however, it examines the TCP Window field of the RST packets returned. On specific systems, this can reveal that the port is open. You can select this scan type with the option -sW. As shown in the figure below, we expect to get an RST packet in reply to our ‚Äúuninvited‚Äù ACK packets, regardless of whether the port is open or closed.\n\nSimilarly, launching a TCP window scan against a Linux system with no firewall will not provide much information. As we can see in the console output below, the results of the window scan against a Linux server with no firewall didn‚Äôt give any extra information compared to the ACK scan executed earlier.\nPentester Terminal\n123456789pentester@TryHackMe$ sudo nmap -sW MACHINE_IPStarting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 10:38 BSTNmap scan report for MACHINE_IPHost is up (0.0011s latency).All 1000 scanned ports on ip-10-10-252-27.eu-west-1.compute.internal (10.10.252.27) are closedMAC Address: 02:45:BF:8A:2D:6B (Unknown)Nmap done: 1 IP address (1 host up) scanned in 1.60 seconds\nHowever, as you would expect, if we repeat our TCP window scan against a server behind a firewall, we expect to get more satisfying results. In the console output shown below, the TCP window scan pointed that three ports are detected as closed. (This is in contrast with the ACK scan that labelled the same three ports as unfiltered.) Although we know that these three ports are not closed, we realize they responded differently, indicating that the firewall does not block them.\nPentester Terminal\npentester@TryHackMe$ sudo nmap -sW MACHINE_IP123456789101112Starting Nmap 7.60 ( https://nmap.org ) at 2021-09-07 11:39 BSTNmap scan report for MACHINE_IPHost is up (0.00040s latency).Not shown: 997 filtered portsPORT    STATE  SERVICE22/tcp  closed ssh25/tcp  closed smtp80/tcp  closed httpMAC Address: 02:78:C0:D0:4E:E9 (Unknown)Nmap done: 1 IP address (1 host up) scanned in 14.84 seconds\n\nCustom ScanIf you want to experiment with a new TCP flag combination beyond the built-in TCP scan types, you can do so using ‚Äìscanflags. For instance, if you want to set SYN, RST, and FIN simultaneously, you can do so using ‚Äìscanflags RSTSYNFIN. As shown in the figure below, if you develop your custom scan, you need to know how the different ports will behave to interpret the results in different scenarios correctly.\n\nFinally, it is essential to note that the ACK scan and the window scan were very efficient at helping us map out the firewall rules. However, it is vital to remember that just because a firewall is not blocking a specific port, it does not necessarily mean that a service is listening on that port. For example, there is a possibility that the firewall rules need to be updated to reflect recent service changes. Hence, ACK and window scans are exposing the firewall rules, not the services.\nQuestions and Answers of this Task\nTASK 5 Spoofing and DecoysIn some network setups, you will be able to scan a target system using a spoofed IP address and even a spoofed MAC address. Such a scan is only beneficial in a situation where you can guarantee to capture the response. If you try to scan a target from some random network using a spoofed IP address, chances are you won‚Äôt have any response routed to you, and the scan results could be unreliable.\nThe following figure shows the attacker launching the command nmap -S SPOOFED_IP MACHINE_IP. Consequently, Nmap will craft all the packets using the provided source IP address SPOOFED_IP. The target machine will respond to the incoming packets sending the replies to the destination IP address SPOOFED_IP. For this scan to work and give accurate results, the attacker needs to monitor the network traffic to analyze the replies.\n\nIn brief, scanning with a spoofed IP address is three steps:\nAttacker sends a packet with a spoofed source IP address to the target machine.Target machine replies to the spoofed IP address as the destination.Attacker captures the replies to figure out open ports.In general, you expect to specify the network interface using -e and to explicitly disable ping scan -Pn. Therefore, instead of nmap -S SPOOFED_IP MACHINE_IP, you will need to issue nmap -e NET_INTERFACE -Pn -S SPOOFED_IP MACHINE_IP to tell Nmap explicitly which network interface to use and not to expect to receive a ping reply. It is worth repeating that this scan will be useless if the attacker system cannot monitor the network for responses.\nWhen you are on the same subnet as the target machine, you would be able to spoof your MAC address as well. You can specify the source MAC address using ‚Äìspoof-mac SPOOFED_MAC. This address spoofing is only possible if the attacker and the target machine are on the same Ethernet (802.3) network or same WiFi (802.11).\nSpoofing only works in a minimal number of cases where certain conditions are met. Therefore, the attacker might resort to using decoys to make it more challenging to be pinpointed. The concept is simple, make the scan appear to be coming from many IP addresses so that the attacker‚Äôs IP address would be lost among them. As we see in the figure below, the scan of the target machine will appear to be coming from 3 different sources, and consequently, the replies will go the decoys as well.\n\nYou can launch a decoy scan by specifying a specific or random IP address after -D. For example, nmap -D 10.10.0.1,10.10.0.2,ME MACHINE_IP will make the scan of MACHINE_IP appear as coming from the IP addresses 10.10.0.1, 10.10.0.2, and then ME to indicate that your IP address should appear in the third order. Another example command would be nmap -D 10.10.0.1,10.10.0.2,RND,RND,ME MACHINE_IP, where the third and fourth source IP addresses are assigned randomly, while the fifth source is going to be the attacker‚Äôs IP address. In other words, each time you execute the latter command, you would expect two new random IP addresses to be the third and fourth decoy sources.\nTASK 6 - Fragmented PacketsFirewallA firewall is a piece of software or hardware that permits packets to pass through or blocks them. It functions based on firewall rules, summarized as blocking all traffic with exceptions or allowing all traffic with exceptions. For instance, you might block all traffic to your server except those coming to your web server. A traditional firewall inspects, at least, the IP header and the transport layer header. A more sophisticated firewall would also try to examine the data carried by the transport layer.\nIDSAn intrusion detection system (IDS) inspects network packets for select behavioural patterns or specific content signatures. It raises an alert whenever a malicious rule is met. In addition to the IP header and transport layer header, an IDS would inspect the data contents in the transport layer and check if it matches any malicious patterns. How can you make it less likely for a traditional firewall&#x2F;IDS to detect your Nmap activity? It is not easy to answer this; however, depending on the type of firewall&#x2F;IDS, you might benefit from dividing the packet into smaller packets.\nFragmented PacketsNmap provides the option -f to fragment packets. Once chosen, the IP data will be divided into 8 bytes or less. Adding another -f (-f -f or -ff) will split the data into 16 byte-fragments instead of 8. You can change the default value by using the ‚Äìmtu; however, you should always choose a multiple of 8.\nTo properly understand fragmentation, we need to look at the IP header in the figure below. It might look complicated at first, but we notice that we know most of its fields. In particular, notice the source address taking 32 bits (4 bytes) on the fourth row, while the destination address is taking another 4 bytes on the fifth row. The data that we will fragment across multiple packets is highlighted in red. To aid in the reassembly on the recipient side, IP uses the identification (ID) and fragment offset, shown on the second row of the figure below.\n\nLet‚Äôs compare running sudo nmap -sS -p80 10.20.30.144 and sudo nmap -sS -p80 -f 10.20.30.144. As you know by now, this will use stealth TCP SYN scan on port 80; however, in the second command, we are requesting Nmap to fragment the IP packets.\nIn the first two lines, we can see an ARP query and response. Nmap issued an ARP query because the target is on the same Ethernet. The second two lines show a TCP SYN ping and a reply. The fifth line is the beginning of the port scan; Nmap sends a TCP SYN packet to port 80. In this case, the IP header is 20 bytes, and the TCP header is 24 bytes. Note that the minimum size of the TCP header is 20 bytes.\n\nWith fragmentation requested via -f, the 24 bytes of the TCP header will be divided into multiples of 8 bytes, with the last fragment containing 8 bytes or less of the TCP header. Since 24 is divisible by 8, we got 3 IP fragments; each has 20 bytes of IP header and 8 bytes of TCP header. We can see the three fragments between the fifth and the seventh lines.\n\nNote that if you added -ff (or -f -f), the fragmentation of the data will be multiples of 16. In other words, the 24 bytes of the TCP header, in this case, would be divided over two IP fragments, the first containing 16 bytes and the second containing 8 bytes of the TCP header.\nOn the other hand, if you prefer to increase the size of your packets to make them look innocuous, you can use the option ‚Äìdata-length NUM, where num specifies the number of bytes you want to append to your packets.\nQuestion and Answers of the task\nTASK 7 - Idle &#x2F; Zombie ScanSpoofing the source IP address can be a great approach to scanning stealthily. However, spoofing will only work in specific network setups. It requires you to be in a position where you can monitor the traffic. Considering these limitations, spoofing your IP address can have little use; however, we can give it an upgrade with the idle scan.\nThe idle scan, or zombie scan, requires an idle system connected to the network that you can communicate with. Practically, Nmap will make each probe appear as if coming from the idle (zombie) host, then it will check for indicators whether the idle (zombie) host received any response to the spoofed probe. This is accomplished by checking the IP identification (IP ID) value in the IP header. You can run an idle scan using nmap -sI ZOMBIE_IP MACHINE_IP, where ZOMBIE_IP is the IP address of the idle host (zombie).\nThe idle (zombie) scan requires the following three steps to discover whether a port is open:\nTrigger the idle host to respond so that you can record the current IP ID on the idle host.Send a SYN packet to a TCP port on the target. The packet should be spoofed to appear as if it was coming from the idle host (zombie) IP address.Trigger the idle machine again to respond so that you can compare the new IP ID with the one received earlier.Let‚Äôs explain with figures. In the figure below, we have the attacker system probing an idle machine, a multi-function printer. By sending a SYN&#x2F;ACK, it responds with an RST packet containing its newly incremented IP ID.\n\nThe attacker will send a SYN packet to the TCP port they want to check on the target machine in the next step. However, this packet will use the idle host (zombie) IP address as the source. Three scenarios would arise. In the first scenario, shown in the figure below, the TCP port is closed; therefore, the target machine responds to the idle host with an RST packet. The idle host does not respond; hence its IP ID is not incremented.\n\nIn the second scenario, as shown below, the TCP port is open, so the target machine responds with a SYN&#x2F;ACK to the idle host (zombie). The idle host responds to this unexpected packet with an RST packet, thus incrementing its IP ID.\n\nIn the third scenario, the target machine does not respond at all due to firewall rules. This lack of response will lead to the same result as with the closed port; the idle host won‚Äôt increase the IP ID.\nFor the final step, the attacker sends another SYN&#x2F;ACK to the idle host. The idle host responds with an RST packet, incrementing the IP ID by one again. The attacker needs to compare the IP ID of the RST packet received in the first step with the IP ID of the RST packet received in this third step. If the difference is 1, it means the port on the target machine was closed or filtered. However, if the difference is 2, it means that the port on the target was open.\nIt is worth repeating that this scan is called an idle scan because choosing an idle host is indispensable for the accuracy of the scan. If the ‚Äúidle host‚Äù is busy, all the returned IP IDs would be useless.\nQuestions and answers of this task\nTASK 8 - Getting more dteailsYou might consider adding ‚Äìreason if you want Nmap to provide more details regarding its reasoning and conclusions. Consider the two scans below to the system; however, the latter adds ‚Äìreason.\nPentester Terminal\n12345678910111213141516pentester@TryHackMe$ sudo nmap -sS 10.10.252.27Starting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 10:39 BSTNmap scan report for ip-10-10-252-27.eu-west-1.compute.internal (10.10.252.27)Host is up (0.0020s latency).Not shown: 994 closed portsPORT    STATE SERVICE22/tcp  open  ssh25/tcp  open  smtp80/tcp  open  http110/tcp open  pop3111/tcp open  rpcbind143/tcp open  imapMAC Address: 02:45:BF:8A:2D:6B (Unknown)Nmap done: 1 IP address (1 host up) scanned in 1.60 seconds\nPentester Terminal\npentester@TryHackMe$ sudo nmap -sS --reason 10.10.252.2712345678910111213141516Starting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 10:40 BSTNmap scan report for ip-10-10-252-27.eu-west-1.compute.internal (10.10.252.27)Host is up, received arp-response (0.0020s latency).Not shown: 994 closed portsReason: 994 resetsPORT    STATE SERVICE REASON22/tcp  open  ssh     syn-ack ttl 6425/tcp  open  smtp    syn-ack ttl 6480/tcp  open  http    syn-ack ttl 64110/tcp open  pop3    syn-ack ttl 64111/tcp open  rpcbind syn-ack ttl 64143/tcp open  imap    syn-ack ttl 64MAC Address: 02:45:BF:8A:2D:6B (Unknown)Nmap done: 1 IP address (1 host up) scanned in 1.59 seconds\nProviding the ‚Äìreason flag gives us the explicit reason why Nmap concluded that the system is up or a particular port is open. In this console output above, we can see that this system is considered online because Nmap ‚Äúreceived arp-response.‚Äù On the other hand, we know that the SSH port is deemed to be open because Nmap received a ‚Äúsyn-ack‚Äù packet back.\nFor more detailed output, you can consider using -v for verbose output or -vv for even more verbosity.\nPentester Terminal12345678910111213141516171819202122232425262728293031323334pentester@TryHackMe$ sudo nmap -sS -vv 10.10.252.27Starting Nmap 7.60 ( https://nmap.org ) at 2021-08-30 10:41 BSTInitiating ARP Ping Scan at 10:41Scanning 10.10.252.27 [1 port]Completed ARP Ping Scan at 10:41, 0.22s elapsed (1 total hosts)Initiating Parallel DNS resolution of 1 host. at 10:41Completed Parallel DNS resolution of 1 host. at 10:41, 0.00s elapsedInitiating SYN Stealth Scan at 10:41Scanning ip-10-10-252-27.eu-west-1.compute.internal (10.10.252.27) [1000 ports]Discovered open port 22/tcp on 10.10.252.27Discovered open port 25/tcp on 10.10.252.27Discovered open port 80/tcp on 10.10.252.27Discovered open port 110/tcp on 10.10.252.27Discovered open port 111/tcp on 10.10.252.27Discovered open port 143/tcp on 10.10.252.27Completed SYN Stealth Scan at 10:41, 1.25s elapsed (1000 total ports)Nmap scan report for ip-10-10-252-27.eu-west-1.compute.internal (10.10.252.27)Host is up, received arp-response (0.0019s latency).Scanned at 2021-08-30 10:41:02 BST for 1sNot shown: 994 closed portsReason: 994 resetsPORT    STATE SERVICE REASON22/tcp  open  ssh     syn-ack ttl 6425/tcp  open  smtp    syn-ack ttl 6480/tcp  open  http    syn-ack ttl 64110/tcp open  pop3    syn-ack ttl 64111/tcp open  rpcbind syn-ack ttl 64143/tcp open  imap    syn-ack ttl 64MAC Address: 02:45:BF:8A:2D:6B (Unknown)Read data files from: /usr/bin/../share/nmapNmap done: 1 IP address (1 host up) scanned in 1.59 seconds           Raw packets sent: 1002 (44.072KB) | Rcvd: 1002 (40.092KB)\nIf -vv does not satisfy your curiosity, you can use -d for debugging details or -dd for even more details. You can guarantee that using -d will create an output that extends beyond a single screen.\nQuestions and answers of this task\nSUMMARY\n\n\nPort Scan Type\nExample Command\n\n\n\nTCP Null Scan\nsudo nmap -sN 10.10.214.83\n\n\nTCP FIN Scan\nsudo nmap -sF 10.10.214.83\n\n\nTCP Xmas Scan\nsudo nmap -sX 10.10.214.83\n\n\nTCP Maimon Scan\nsudo nmap -sM 10.10.214.83\n\n\nTCP ACK Scan\nsudo nmap -sA 10.10.214.83\n\n\nTCP Window Scan\nsudo nmap -sW 10.10.214.83\n\n\nCustom TCP Scan\nsudo nmap ‚Äìscanflags URGACKPSHRSTSYNFIN 10.10.214.83\n\n\nSpoofed Source IP\nsudo nmap -S SPOOFED_IP 10.10.214.83\n\n\nSpoofed MAC Address\n‚Äìspoof-mac SPOOFED_MAC\n\n\nDecoy Scan\nnmap -D DECOY_IP,ME 10.10.214.83\n\n\nIdle (Zombie) Scan\nsudo nmap -sI ZOMBIE_IP 10.10.214.83\n\n\nFragment IP data into 8 bytes\n-f\n\n\nFragment IP data into 16 bytes\n-ff\n\n\n\n\n\nOption\nPurpose\n\n\n\n‚Äìsource-port PORT_NUM\nspecify source port number\n\n\n‚Äìdata-length NUM\nappend random data to reach given length\n\n\nThese scan types rely on setting TCP flags in unexpected ways to prompt ports for a reply. Null, FIN, and Xmas scans provoke a response from closed ports, while Maimon, ACK, and Window scans provoke a response from open and closed ports.\n\n\n\nOption\nPurpose\n\n\n\n‚Äìreason\nexplains how Nmap made its conclusion\n\n\n-v\nverbose\n\n\n-vv\nvery verbose\n\n\n-d\ndebugging\n\n\n-dd\nmore details for debugging\n\n\n\n","slug":"Nmap-Advanced-Port-Scans","date":"2024-05-16T15:27:44.000Z","categories_index":"cybersecurity,THM,NMAP","tags_index":"tryhackme,nmap,information-gathering","author_index":"Satvik"},{"id":"2bcf8d570917965c65fd2618756df225","title":"Live Host Discovery - NMAP","content":"IntroductionWe can find live hosts on a network by using any of the 3 scans that are named below:\n\nARP scan: This scan uses ARP requests to discover live hosts\nICMP scan: This scan uses ICMP requests to identify live hosts\nTCP&#x2F;UDP ping scan: This scan sends packets to TCP ports and UDP ports to determine live hosts.\n\nA Nmap scan usually goes through the steps shown in the figure below, although many are optional and depend on the command-line arguments you provide.\n\n\nTASK 2 - SUBNETWORKSA network segment is a group of computers connected using a shared medium. For instance, the medium can be the Ethernet switch or WiFi access point. In an IP network, a subnetwork is usually the equivalent of one or more network segments connected together and configured to use the same router. The network segment refers to a physical connection, while a subnetwork refers to a logical connection.\nIn the following network diagram, we have four network segments or subnetworks. Generally speaking, your system would be connected to one of these network segments&#x2F;subnetworks. A subnetwork, or simply a subnet, has its own IP address range and is connected to a more extensive network via a router. There might be a firewall enforcing security policies depending on each network.\n\nThe figure above shows two types of subnets:\n\nSubnets with /16, which means that the subnet mask can be written as 255.255.0.0. This subnet can have around 65 thousand hosts.\nSubnets with /24, which indicates that the subnet mask can be expressed as 255.255.255.0. This subnet can have around 250 hosts\n\nIf you are in Network A, you can use ARP only to discover the devices within that subnet (10.1.100.0&#x2F;24). Suppose you are connected to a subnet different from the subnet of the target system(s). In that case, all packets generated by your scanner will be routed via the default gateway (router) to reach the systems on another subnet; however, the ARP queries won‚Äôt be routed and hence cannot cross the subnet router. ARP is a link-layer protocol, and ARP packets are bound to their subnet.\nAnswer the questions below\nSend a packet with the following:\n\n\nFrom computer1\nTo computer1 (to indicate it is broadcast)\nPacket Type: ‚ÄúARP Request‚Äù\nData: computer6 (because we are asking for computer6 MAC address using ARP Request)\n\nHow many devices can see the ARP Request?\nAnswer : 4\nDid computer6 receive the ARP Request? (Y&#x2F;N)Answer : N\nSend a packet with the following:\n\n\nFrom computer4\nTo computer4 (to indicate it is broadcast)\nPacket Type: ‚ÄúARP Request‚Äù\nData: computer6 (because we are asking for computer6 MAC address using ARP Request)\n\nHow many devices can see the ARP Request?\nAnswer : 4\nDid computer6 reply to the ARP Request? (Y&#x2F;N)\nAnswer : Y\n\nTASK 3 - Enumerating TargetsWe mentioned the different techniques we can use for scanning in Task 1. Before we explain each in detail and put it into use against a live target, we need to specify the targets we want to scan. Generally speaking, you can provide a list, a range, or a subnet. Examples of target specification are:\n\nlist: MACHINE_IP scanme.nmap.org example.com will scan 3 IP addresses.\nrange: 10.11.12.15-20 will scan 6 IP addresses: 10.11.12.15, **10.11.12.16‚Ä¶ and 10.11.12.20.\nsubnet: MACHINE_IP/30 will scan 4 IP addresses.\n\nYou can also provide a file as input for your list of targets, nmap -iL list_of_hosts.txt.\nIf you want to check the list of hosts that Nmap will scan, you can use nmap -sL TARGETS. This option will give you a detailed list of the hosts that Nmap will scan without scanning them; however, Nmap will attempt a reverse-DNS resolution on all the targets to obtain their names. Names might reveal various information to the pentester. (If you don‚Äôt want Nmap to the DNS server, you can add -n.)\nLaunch the AttackBox using the Start AttackBox button, open the terminal when the AttackBox is ready, and use Nmap to answer the following.\nQ1 . What is the first IP address Nmap would scan if you provided 10.10.12.13/29 as your target?\nAnswer :we can use the command nmap -sL 10.10.12.13/29 \n\nso the answer is10.10.12.8\n**Q2.**How many IP addresses will Nmap scan if you provide the following range 10.10.0-255.101-125? \nwe can use the command nmap -sL **10.10.0-255.101-125** \n\nTASK - 4 Discovering Live HostsLet‚Äôs revisit the TCP&#x2F;IP layers shown in the figure next. We will leverage the protocols to discover the live hosts. Starting from bottom to top, we can use:\n\nARP from Link Layer\nICMP from Network Layer\nTCP from Transport Layer\nUDP from Transport Layer\n\n\nBefore we discuss how scanners can use each in detail, we will briefly review these four protocols. ARP has one purpose: sending a frame to the broadcast address on the network segment and asking the computer with a specific IP address to respond by providing its MAC (hardware) address.\nICMP has many types. ICMP ping uses Type 8 (Echo) and Type 0 (Echo Reply).\nIf you want to ping a system on the same subnet, an ARP query should precede the ICMP Echo.\nAlthough TCP and UDP are transport layers, for network scanning purposes, a scanner can send a specially-crafted packet to common TCP or UDP ports to check whether the target will respond. This method is efficient, especially when ICMP Echo is blocked.\nIf you have closed the network simulator, click on the ‚ÄúView Site‚Äù button in Task 2 to display it again.\nAnswer the questions below\nSend a packet with the following:\n\nFrom computer1\nTo computer3\nPacket Type: ‚ÄúPing Request‚Äù\n\nWhat is the type of packet that computer1 sent before the ping?\nAnswer: ARP REQUEST\nWhat is the type of packet that computer1 received before being able to send the ping?\nAnswer: ARP RESPONSE\nHow many computers responded to the ping request?\nAnswer: 1\nSend a packet with the following:\n\nFrom computer2\nTo computer5\nPacket Type: ‚ÄúPing Request‚Äù\n\nWhat is the name of the first device that responded to the first ARP Request?\nAnswer: Router\nWhat is the name of the first device that responded to the second ARP Request?\nAnswer: Computer5\n\nTASK 5 - Nmap Host Discovery Using ARPHow would you know which hosts are up and running? It is essential to avoid wasting our time port-scanning an offline host or an IP address not in use. There are various ways to discover online hosts. When no host discovery options are provided, Nmap follows the following approaches to discover live hosts:\n\nWhen a privileged user tries to scan targets on a local network (Ethernet), Nmap uses ARP requests. A privileged user is root or a user who belongs to sudoers and can run sudo.\nWhen a privileged user tries to scan targets outside the local network, Nmap uses ICMP echo requests, TCP ACK (Acknowledge) to port 80, TCP SYN (Synchronize) to port 443, and ICMP timestamp request.\nWhen an unprivileged user tries to scan targets outside the local network, Nmap resorts to a TCP 3-way handshake by sending SYN packets to ports 80 and 443.\n\nNmap, by default, uses a ping scan to find live hosts, then proceeds to scan live hosts only. If you want to use Nmap to discover online hosts without port-scanning the live systems, you can issue nmap -sn TARGETS. Let‚Äôs dig deeper into the different techniques used.\nARP scan is possible only if you are on the same subnet as the target systems. On an Ethernet (802.3) and WiFi (802.11), you need to know the MAC address of any system before you can communicate with it. The MAC address is necessary for the link-layer header; the header contains the source MAC address and the destination MAC address among other fields. To get the MAC address, the OS sends an ARP query. A host that replies to ARP queries is up. The ARP query only works if the target is on the same subnet as yourself, i.e., on the same Ethernet&#x2F;WiFi. You should expect to see many ARP queries generated during a Nmap scan of a local network. If you want Nmap only to perform an ARP scan without port-scanning, you can use nmap -PR -sn TARGETS, where -PR indicates that you only want an ARP scan. The following example shows Nmap using ARP for host discovery without any port scanning. We run nmap -PR -sn MACHINE_IP/24 to discover all the live systems on the same subnet as our target machine.\nPentester Terminal\n1234567891011121314pentester@TryHackMe$ sudo nmap -PR -sn 10.10.210.6/24Starting Nmap 7.60 ( https://nmap.org ) at 2021-09-02 07:12 BSTNmap scan report for ip-10-10-210-75.eu-west-1.compute.internal (10.10.210.75)Host is up (0.00013s latency).MAC Address: 02:83:75:3A:F2:89 (Unknown)Nmap scan report for ip-10-10-210-100.eu-west-1.compute.internal (10.10.210.100)Host is up (-0.100s latency).MAC Address: 02:63:D0:1B:2D:CD (Unknown)Nmap scan report for ip-10-10-210-165.eu-west-1.compute.internal (10.10.210.165)Host is up (0.00025s latency).MAC Address: 02:59:79:4F:17:B7 (Unknown)Nmap scan report for ip-10-10-210-6.eu-west-1.compute.internal (10.10.210.6)Host is up.Nmap done: 256 IP addresses (4 hosts up) scanned in 3.12 secondsIn this case, the AttackBox had the IP address 10.10.210.6, and it used ARP requests to discover the live hosts on the same subnet. ARP scan works, as shown in the figure below. Nmap sends ARP requests to all the target computers, and those online should send an ARP reply back.\n\nIf we look at the packets generated using a tool such as tcpdump or Wireshark, we will see network traffic similar to the figure below. In the figure below, Wireshark displays the source MAC address, destination MAC address, protocol, and query related to each ARP request. The source address is the MAC address of our AttackBox, while the destination is the broadcast address as we don‚Äôt know the MAC address of the target. However, we see the target‚Äôs IP address, which appears in the Info column. In the figure, we can see that we are requesting the MAC addresses of all the IP addresses on the subnet, starting with 10.10.210.1. The host with the IP address we are asking about will send an ARP reply with its MAC address, and that‚Äôs how we will know that it is online.\nTalking about ARP scans, we should mention a scanner built around ARP queries: arp-scan; it provides many options to customize your scan. Visit the arp-scan wiki for detailed information. One popular choice is arp-scan ‚Äìlocalnet or simply arp-scan -l. This command will send ARP queries to all valid IP addresses on your local networks. Moreover, if your system has more than one interface and you are interested in discovering the live hosts on one of them, you can specify the interface using -I. For instance, sudo arp-scan -I eth0 -l will send ARP queries for all valid IP addresses on the eth0 interface.\nNote that arp-scan is not installed on the AttackBox; however, it can be installed using apt install arp-scan.\nIn the example below, we scanned the subnet of the AttackBox using arp-scan ATTACKBOX_IP&#x2F;24. Since we ran this scan at a time frame close to the previous one nmap -PR -sn ATTACKBOX_IP&#x2F;24, we obtained the same three live targets.\n123456789pentester@TryHackMe$ sudo arp-scan 10.10.210.6/24Interface: eth0, datalink type: EN10MB (Ethernet)WARNING: host part of 10.10.210.6/24 is non-zeroStarting arp-scan 1.9 with 256 hosts (http://www.nta-monitor.com/tools/arp-scan/)10.10.210.75\t02:83:75:3a:f2:89\t(Unknown)10.10.210.100\t02:63:d0:1b:2d:cd\t(Unknown)10.10.210.165\t02:59:79:4F:17:B7\t(Unknown)4 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.9: 256 hosts scanned in 2.726 seconds (93.91 hosts/sec). 3 responded\nSimilarly, the command arp-scan will generate many ARP queries that we can see using tcpdump, Wireshark, or a similar tool. We can notice that the packet capture for arp-scan and nmap -PR -sn yield similar traffic patterns. Below is the Wireshark output.\n\nIf you have closed the network simulator, click on the ‚ÄúVisit Site‚Äù button in Task 2 to display it again.\nAnswer the questions below:\nWe will be sending broadcast ARP Requests packets with the following options:\n\nFrom computer1\nTo computer1 (to indicate it is broadcast)\nPacket Type: ‚ÄúARP Request‚Äù\nData: try all the possible eight devices (other than computer1) in the network: computer2, computer3, computer4, computer5, computer6, switch1, switch2, and router.\n\nHow many devices are you able to discover using ARP requests?\n3\n\nTASK 6 - NMAP HOST DISCOVERY USING ICMPWe can ping every IP address on a target network and see who would respond to our ping (ICMP Type 8&#x2F;Echo) requests with a ping reply (ICMP Type 0). Simple, isn‚Äôt it? Although this would be the most straightforward approach, it is not always reliable. Many firewalls block ICMP echo; new versions of MS Windows are configured with a host firewall that blocks ICMP echo requests by default. Remember that an ARP query will precede the ICMP request if your target is on the same subnet.\nTo use ICMP echo request to discover live hosts, add the option -PE. (Remember to add -sn if you don‚Äôt want to follow that with a port scan.) As shown in the following figure, an ICMP echo scan works by sending an ICMP echo request and expects the target to reply with an ICMP echo reply if it is online.\n\nIn the example below, we scanned the target‚Äôs subnet using nmap -PE -sn MACHINE_IP/24. This scan will send ICMP echo packets to every IP address on the subnet. Again, we expect live hosts to reply; however, it is wise to remember that many firewalls block ICMP. The output below shows the result of scanning the virtual machine‚Äôs class C subnet using sudo nmap -PE -sn MACHINE_IP/24 from the AttackBox.\n12345678910111213141516171819202122232425262728**Pentester Terminal:**pentester@TryHackMe$ sudo nmap -PE -sn 10.10.68.220/24Starting Nmap 7.60 ( https://nmap.org ) at 2021-09-02 10:16 BSTNmap scan report for ip-10-10-68-50.eu-west-1.compute.internal (10.10.68.50)Host is up (0.00017s latency).MAC Address: 02:95:36:71:5B:87 (Unknown)Nmap scan report for ip-10-10-68-52.eu-west-1.compute.internal (10.10.68.52)Host is up (0.00017s latency).MAC Address: 02:48:E8:BF:78:E7 (Unknown)Nmap scan report for ip-10-10-68-77.eu-west-1.compute.internal (10.10.68.77)Host is up (-0.100s latency).MAC Address: 02:0F:0A:1D:76:35 (Unknown)Nmap scan report for ip-10-10-68-110.eu-west-1.compute.internal (10.10.68.110)Host is up (-0.10s latency).MAC Address: 02:6B:50:E9:C2:91 (Unknown)Nmap scan report for ip-10-10-68-140.eu-west-1.compute.internal (10.10.68.140)Host is up (0.00021s latency).MAC Address: 02:58:59:63:0B:6B (Unknown)Nmap scan report for ip-10-10-68-142.eu-west-1.compute.internal (10.10.68.142)Host is up (0.00016s latency).MAC Address: 02:C6:41:51:0A:0F (Unknown)Nmap scan report for ip-10-10-68-220.eu-west-1.compute.internal (10.10.68.220)Host is up (0.00026s latency).MAC Address: 02:25:3F:DB:EE:0B (Unknown)Nmap scan report for ip-10-10-68-222.eu-west-1.compute.internal (10.10.68.222)Host is up (0.00025s latency).MAC Address: 02:28:B1:2E:B0:1B (Unknown)Nmap done: 256 IP addresses (8 hosts up) scanned in 2.11 seconds\n\nThe scan output shows that eight hosts are up; moreover, it shows their MAC addresses. Generally speaking, we don‚Äôt expect to learn the MAC addresses of the targets unless they are on the same subnet as our system. The output above indicates that Nmap didn‚Äôt need to send ICMP packets as it confirmed that these hosts are up based on the ARP responses it received.\nWe will repeat the scan above; however, this time, we will scan from a system that belongs to a different subnet. The results are similar but without the MAC addresses.\n12345678910111213141516171819Pentester Terminal pentester@TryHackMe$ sudo nmap -PE -sn 10.10.68.220/24Starting Nmap 7.92 ( https://nmap.org ) at 2021-09-02 12:16 EESTNmap scan report for 10.10.68.50Host is up (0.12s latency).Nmap scan report for 10.10.68.52Host is up (0.12s latency).Nmap scan report for 10.10.68.77Host is up (0.11s latency).Nmap scan report for 10.10.68.110Host is up (0.11s latency).Nmap scan report for 10.10.68.140Host is up (0.11s latency).Nmap scan report for 10.10.68.142Host is up (0.11s latency).Nmap scan report for 10.10.68.220Host is up (0.11s latency).Nmap scan report for 10.10.68.222Host is up (0.11s latency).Nmap done: 256 IP addresses (8 hosts up) scanned in 8.26 second\n\nIf you look at the network packets using a tool like Wireshark, you will see something similar to the image below. You can see that we have one source IP address on a different subnet than that of the destination subnet, sending ICMP echo requests to all the IP addresses in the target subnet to see which one will reply.\n\nBecause ICMP echo requests tend to be blocked, you might also consider ICMP Timestamp or ICMP Address Mask requests to tell if a system is online. Nmap uses timestamp request (ICMP Type 13) and checks whether it will get a Timestamp reply (ICMP Type 14). Adding the -PP option tells Nmap to use ICMP timestamp requests. As shown in the figure below, you expect live hosts to reply.\n\nIn the following example, we run nmap -PP -sn MACHINE_IP/24 to discover the online computers on the target machine subnet.\nPentester Terminal\n12345678910111213141516171819pentester@TryHackMe$ sudo nmap -PP -sn 10.10.68.220/24Starting Nmap 7.92 ( https://nmap.org ) at 2021-09-02 12:06 EESTNmap scan report for 10.10.68.50Host is up (0.13s latency).Nmap scan report for 10.10.68.52Host is up (0.25s latency).Nmap scan report for 10.10.68.77Host is up (0.14s latency).Nmap scan report for 10.10.68.110Host is up (0.14s latency).Nmap scan report for 10.10.68.140Host is up (0.15s latency).Nmap scan report for 10.10.68.209Host is up (0.14s latency).Nmap scan report for 10.10.68.220Host is up (0.14s latency).Nmap scan report for 10.10.68.222Host is up (0.14s latency).Nmap done: 256 IP addresses (8 hosts up) scanned in 10.93 seconds\n\nSimilar to the previous ICMP scan, this scan will send many ICMP timestamp requests to every valid IP address in the target subnet. In the Wireshark screenshot below, you can see one source IP address sending ICMP packets to every possible IP address to discover online hosts.\n\nSimilarly, Nmap uses address mask queries (ICMP Type 17) and checks whether it gets an address mask reply (ICMP Type 18). This scan can be enabled with the option -PM. As shown in the figure below, live hosts are expected to reply to ICMP address mask requests.\n\nIn an attempt to discover live hosts using ICMP address mask queries, we run the command nmap -PM -sn MACHINE_IP/24. Although, based on earlier scans, we know that at least eight hosts are up, this scan returned none. The reason is that the target system or a firewall on the route is blocking this type of ICMP packet. Therefore, it is essential to learn multiple approaches to achieve the same result. If one type of packet is being blocked, we can always choose another to discover the target network and services.\nPentester Terminal\n123pentester@TryHackMe$ sudo nmap -PM -sn 10.10.68.220/24Starting Nmap 7.92 ( https://nmap.org ) at 2021-09-02 12:13 EESTNmap done: 256 IP addresses (0 hosts up) scanned in 52.17 seconds\n\n\nAlthough we didn‚Äôt get any reply and could not figure out which hosts are online, it is essential to note that this scan sent ICMP address mask requests to every valid IP address and waited for a reply. Each ICMP request was sent twice, as we can see in the screenshot below.\n\nAnswer the questions below\nWhat is the option required to tell Nmap to use ICMP Timestamp to discover live hosts?\nCorrect Answer : -pp\nWhat is the option required to tell Nmap to use ICMP Address Mask to discover live hosts?\nCorrect Answer : -PN\nWhat is the option required to tell Nmap to use ICMP Echo to discover live hosts?\nCorrect Answer : -PE\nTASK 7 - Nmap Host Discovery Using TCP and UDPTCP¬†SYN Ping\nWe can send a packet with the SYN (Synchronize) flag set to a¬†TCP¬†port, 80 by default, and wait for a response. An open port should reply with a SYN&#x2F;ACK (Acknowledge); a closed port would result in an RST (Reset). In this case, we only check whether we will get any response to infer whether the host is up. The specific state of the port is not significant here. The figure below is a reminder of how a¬†TCP¬†3-way handshake usually works.\n\nIf you want Nmap to use¬†TCP¬†SYN ping, you can do so via the option -PS followed by the port number, range, list, or a combination of them. For example, -PS21 will target port 21, while -PS21-25 will target ports 21, 22, 23, 24, and 25. Finally -PS80,443,8080 will target the three ports 80, 443, and 8080.\nPrivileged users (root and sudoers) can send¬†TCP¬†SYN packets and don‚Äôt need to complete the¬†TCP¬†3-way handshake even if the port is open, as shown in the figure below. Unprivileged users have no choice but to complete the 3-way handshake if the port is open.\n\nWe will run nmap -PS -sn MACHINE_IP/24 to scan the target¬†VM¬†subnet. As we can see in the output below, we were able to discover five hosts.\nPentester Terminal\n123456789101112pentester@TryHackMe$ sudo nmap -PS -sn 10.10.68.220/24Starting Nmap 7.92 ( https://nmap.org ) at 2021-09-02 13:45 EESTNmap scan report for 10.10.68.52Host is up (0.10s latency).Nmap scan report for 10.10.68.121Host is up (0.16s latency).Nmap scan report for 10.10.68.125Host is up (0.089s latency).Nmap scan report for 10.10.68.134Host is up (0.13s latency).Nmap scan report for 10.10.68.220Host is up (0.11s latency).Nmap done: 256 IP addresses (5 hosts up) scanned in 17.38 seconds\n\nLet‚Äôs take a closer look at what happened behind the scenes by looking at the network traffic on Wireshark in the figure below. Technically speaking, since we didn‚Äôt specify any¬†TCP¬†ports to use in the¬†TCP¬†ping scan, Nmap used common ports; in this case, it is¬†TCP¬†port 80. Any service listening on port 80 is expected to reply, indirectly indicating that the host is online.\n\nTCP¬†ACK Ping\nAs you have guessed, this sends a packet with an ACK flag set. You must be running¬†Nmap¬†as a privileged user to be able to accomplish this. If you try it as an unprivileged user,¬†Nmap¬†will attempt a 3-way handshake.\nBy default, port 80 is used. The syntax is similar to¬†TCP¬†SYN ping. -PA should be followed by a port number, range, list, or a combination of them. For example, consider -PA21, -PA21-25 and -PA80,443,8080. If no port is specified, port 80 will be used.\nThe following figure shows that any¬†TCP¬†packet with an ACK flag should get a¬†TCP¬†packet back with an RST flag set. The target responds with the RST flag set because the¬†TCP¬†packet with the ACK flag is not part of any ongoing connection. The expected response is used to detect if the target host is up.\n\nIn this example, we run sudo nmap -PA -sn MACHINE_IP/24 to discover the online hosts on the target‚Äôs subnet. We can see that the¬†TCP¬†ACK ping scan detected five hosts as up.\nPentester Terminal\n123456789101112pentester@TryHackMe$ sudo nmap -PA -sn 10.10.68.220/24Starting Nmap 7.92 ( https://nmap.org ) at 2021-09-02 13:46 EESTNmap scan report for 10.10.68.52Host is up (0.11s latency).Nmap scan report for 10.10.68.121Host is up (0.12s latency).Nmap scan report for 10.10.68.125Host is up (0.10s latency).Nmap scan report for 10.10.68.134Host is up (0.10s latency).Nmap scan report for 10.10.68.220Host is up (0.10s latency).Nmap done: 256 IP addresses (5 hosts up) scanned in 29.89 seconds\n\nIf we peek at the network traffic as shown in the figure below, we will discover many packets with the ACK flag set and sent to port 80 of the target systems.¬†Nmap¬†sends each packet twice. The systems that don‚Äôt respond are offline or inaccessible.\n\nUDP¬†Ping\nFinally, we can use¬†UDP¬†to discover if the host is online. Contrary to TCP SYN ping, sending a¬†UDP¬†packet to an open port is not expected to lead to any reply. However, if we send a¬†UDP¬†packet to a closed¬†UDP¬†port, we expect to get an ICMP port unreachable packet; this indicates that the target system is up and available.\nIn the following figure, we see a¬†UDP¬†packet sent to an open¬†UDP¬†port and not triggering any response. However, sending a¬†UDP¬†packet to any closed¬†UDP¬†port can trigger a response indirectly indicating that the target is online.\n\n\nThe syntax to specify the ports is similar to that of¬†TCP¬†SYN ping and¬†TCP¬†ACK ping;¬†Nmap¬†uses -PU for¬†UDP¬†ping. In the following example, we use a¬†UDP¬†scan, and we discover five live hosts.\nPentester Terminal\n123456789101112pentester@TryHackMe$ sudo nmap -PU -sn 10.10.68.220/24Starting Nmap 7.92 ( https://nmap.org ) at 2021-09-02 13:45 EESTNmap scan report for 10.10.68.52Host is up (0.10s latency).Nmap scan report for 10.10.68.121Host is up (0.10s latency).Nmap scan report for 10.10.68.125Host is up (0.14s latency).Nmap scan report for 10.10.68.134Host is up (0.096s latency).Nmap scan report for 10.10.68.220Host is up (0.11s latency).Nmap done: 256 IP addresses (5 hosts up) scanned in 9.20 second\nLet‚Äôs inspect the¬†UDP¬†packets generated. In the following Wireshark screenshot, we notice Nmap sending¬†UDP¬†packets to¬†UDP¬†ports that are most likely closed. The image below shows that Nmap uses an uncommon¬†UDP¬†port to trigger an ICMP destination unreachable (port unreachable) error.\n\nMasscan\nOn a side note, Masscan uses a similar approach to discover the available systems. However, to finish its network scan quickly, Masscan is quite aggressive with the rate of packets it generates. The syntax is quite similar: -p can be followed by a port number, list, or range. Consider the following examples:\n\nmasscan MACHINE_IP/24 -p443\nmasscan MACHINE_IP/24 -p80,443\nmasscan MACHINE_IP/24 -p22-25\nmasscan MACHINE_IP/24 ‚Äê‚Äêtop-ports 100\n\nMasscan is not installed on the AttackBox; however, it can be installed using apt install masscan.\nAnswer the questions below\nWhich TCP ping scan does not require a privileged account?\nTCP SYN PING\nWhich TCP ping scan requires a privileged account?\nTCP ACK PING\nWhat option do you need to add to Nmap to run a TCP SYN ping scan on the telnet port?\n-ps23\nTASK 8 - USING REVERSE DNS LOOKUPNmap‚Äôs default behaviour is to use reverse-DNS¬†online hosts. Because the hostnames can reveal a lot, this can be a helpful step. However, if you don‚Äôt want to send such¬†DNS¬†queries, you use¬†-n¬†to skip this step.\nBy default,¬†Nmap¬†will look up online hosts; however, you can use the option¬†-R¬†to query the¬†DNS¬†server even for offline hosts. If you want to use a specific¬†DNS¬†server, you can add the¬†--dns-servers DNS_SERVER¬†option.\nAnswer the questions below\nWe want Nmap to issue a reverse DNS lookup for all the possibles hosts on a subnet, hoping to get some insights from the names. What option should we add?\nCorrect Answer : -R\n\nSUMMARY OF THE ROOM\nYou have learned how ARP, ICMP, TCP, and¬†UDP¬†can detect live hosts by completing this room. Any response from a host is an indication that it is online. Below is a quick summary of the command-line options for¬†Nmap¬†that we have covered.\n\n\n\nScan Type\nExample Command\n\n\n\nARP¬†Scan\nsudo nmap -PR -sn MACHINE_IP&#x2F;24\n\n\nICMP Echo Scan\nsudo nmap -PE¬†-sn MACHINE_IP&#x2F;24\n\n\nICMP Timestamp Scan\nsudo nmap -PP -sn MACHINE_IP&#x2F;24\n\n\nICMP Address Mask Scan\nsudo nmap -PM -sn MACHINE_IP&#x2F;24\n\n\nTCP¬†SYN Ping Scan\nsudo nmap -PS22,80,443 -sn MACHINE_IP&#x2F;30\n\n\nTCP¬†ACK Ping Scan\nsudo nmap -PA22,80,443 -sn MACHINE_IP&#x2F;30\n\n\nUDP¬†Ping Scan\nsudo nmap -PU53,161,162 -sn MACHINE_IP&#x2F;30\n\n\nRemember to add¬†-sn¬†if you are only interested in host discovery without port-scanning. Omitting¬†-sn¬†will let¬†Nmap¬†default to port-scanning the live hosts.\n\n\n\nOption\nPurpose\n\n\n\n-n\nno¬†DNS¬†lookup\n\n\n-R\nreverse-DNS¬†lookup for all hosts\n\n\n-sn\nhost discovery only\n\n\nThank YouSatvik\n","slug":"Live-Host-Discovery","date":"2024-05-16T13:59:01.000Z","categories_index":"cybersecurity,THM,NMAP","tags_index":"tryhackme,nmap,information-gathering","author_index":"Satvik"},{"id":"58abb440477d90f4f081be1f94565844","title":"Basic Port Scan - NMAP","content":"Nmap Basic Port ScansINTRODUCTIONThe next step would be checking which ports are open and listening and which ports are closed. Therefore, in this room and the next one, we focus on port scanning and the different types of port scans used by nmap. This room explains:\n\nTCP connect port scan\nTCP SYN port scan\nUDP port scan\n\nMoreover, we discuss the different options to specify the ports, the scan rate, and the number of parallel probes.\nTASK - 2 TCP and UDP PORTSIn the same sense that an IP address specifies a host on a network among many others, a TCP port or UDP port is used to identify a network service running on that host. A server provides the network service, and it adheres to a specific network protocol. Examples include providing time, responding to DNS queries, and serving web pages. A port is usually linked to a service using that specific port number. For instance, an HTTP server would bind to TCP port 80 by default; moreover, if the HTTP server supports SSL&#x2F;TLS, it would listen on TCP port 443. (TCP ports 80 and 443 are the default ports for HTTP and HTTPS; however, the webserver administrator might choose other port numbers if necessary.) Furthermore, no more than one service can listen on any TCP or UDP port (on the same IP address).\nAt the risk of oversimplification, we can classify ports in two states:\n\nOpen port indicates that there is some service listening on that port.\nClosed port indicates that there is no service listening on that port.\n\nHowever, in practical situations, we need to consider the impact of firewalls. For instance, a port might be open, but a firewall might be blocking the packets. Therefore, Nmap considers the following six states:\n\nOpen: indicates that a service is listening on the specified port.\nClosed: indicates that no service is listening on the specified port, although the port is accessible. By accessible, we mean that it is reachable and is not blocked by a firewall or other security appliances&#x2F;programs.\nFiltered: means that Nmap cannot determine if the port is open or closed because the port is not accessible. This state is usually due to a firewall preventing Nmap from reaching that port. Nmap‚Äôs packets may be blocked from reaching the port; alternatively, the responses are blocked from reaching Nmap‚Äôs host.\nUnfiltered: means that Nmap cannot determine if the port is open or closed, although the port is accessible. This state is encountered when using an ACK scan -sA.\nOpen|Filtered: This means that Nmap cannot determine whether the port is open or filtered.\nClosed|Filtered: This means that Nmap cannot decide whether a port is closed or filtered.\n\nANSWERS\nWhich service uses UDP port 53 by default?\n\nCorrect Answer: DNS\n\n\nWhich service uses TCP port 22 by default?\n\nCorrect Answer: SSH\n\n\nHow many port states does Nmap consider?\n\nCorrect Answer: 6\n\n\nWhich port state is the most interesting to discover as a pentester?\n\nCorrect Answer: Open\n\n\n\nTASK 3 - TCP FLAGSNmap supports different types of TCP port scans. To understand the difference between these port scans, we need to review the TCP header. The TCP header is the first 24 bytes of a TCP segment. The following figure shows the TCP header as defined in RFC 793. This figure looks sophisticated at first; however, it is pretty simple to understand. In the first row, we have the source TCP port number and the destination port number. We can see that the port number is allocated 16 bits (2 bytes). In the second and third rows, we have the sequence number and the acknowledgment number. Each row has 32 bits (4 bytes) allocated, with six rows total, making up 24 bytes.\nIn particular, we need to focus on the flags that Nmap can set or unset. We have highlighted the TCP flags in red. Setting a flag bit means setting its value to 1. From left to right, the TCP header flags are:\n\nURG: Urgent flag indicates that the urgent pointer filed is significant. The urgent pointer indicates that the incoming data is urgent, and that a TCP segment with the URG flag set is processed immediately without consideration of having to wait on previously sent TCP segments.\nACK: Acknowledgment flag indicates that the acknowledgment number is significant. It is used to acknowledge the receipt of a TCP segment.\nPSH: Push flag asking TCP to pass the data to the application promptly.\nRST: Reset flag is used to reset the connection. Another device, such as a firewall, might send it to tear a TCP connection. This flag is also used when data is sent to a host and there is no service on the receiving end to answer.\nSYN: Synchronize flag is used to initiate a TCP 3-way handshake and synchronize sequence numbers with the other host. The sequence number should be set randomly during TCP connection establishment.\nFIN: The sender has no more data to send.\n\nANSWERS\nWhat 3 letters represent the Reset flag?\n\nCorrect Answer: RST\n\n\nWhich flag needs to be set when you initiate a TCP connection (first packet of TCP 3-way handshake)?\n\nCorrect Answer: SYN\n\n\n\nTASK 4 - TCP CONNECT SCANTCP connect scan works by completing the TCP 3-way handshake. In standard TCP connection establishment, the client sends a TCP packet with SYN flag set, and the server responds with SYN&#x2F;ACK if the port is open; finally, the client completes the 3-way handshake by sending an ACK.\nWe are interested in learning whether the TCP port is open, not establishing a TCP connection. Hence the connection is torn as soon as its state is confirmed by sending a RST&#x2F;ACK. You can choose to run TCP connect scan using -sT.\nIt is important to note that if you are not a privileged user (root or sudoer), a TCP connect scan is the only possible option to discover open TCP ports.\nQuestion:\nLaunch the VM. Open the AttackBox and execute nmap -sT 10.10.23.101 via the terminal. A new service has been installed on this VM since our last scan. Which port number was closed in the scan above but is now open on this target VM? \n\nAnswer: 110\n\nCommand: nmap -sT 10.10.23.101\nNew service: POP3\n\n\nTASK 5 - TCP SYN SCANUnprivileged users are limited to connect scan. However, the default scan mode is SYN scan, and it requires a privileged (root or sudoer) user to run it. SYN scan does not need to complete the TCP 3-way handshake; instead, it tears down the connection once it receives a response from the server. Because we didn‚Äôt establish a TCP connection, this decreases the chances of the scan being logged. We can select this scan type by using the -sS option.\nQuestions:\nWhat is the new open port?\n\nCorrect Answer: 6667\n\n\nWhat is Nmap‚Äôs guess of the service name?\n\nCorrect Answer: irc\n\n\n\nTask 7: Fine-Tuning Scope and PerformanceYou can specify the ports you want to scan instead of the default 1000 ports. Specifying the ports is intuitive by now. Let‚Äôs see some examples:\n\nPort list: -p22,80,443 will scan ports 22, 80, and 443.\nPort range: -p1-1023 will scan all ports between 1 and 1023 inclusive, while -p20-25 will scan ports between 20 and 25 inclusive.\nYou can request the scan of all ports by using -p-, which will scan all 65535 ports. If you want to scan the most common 100 ports, add -F. Using --top-ports 10 will check the ten most common ports.\n\nYou can control the scan timing using -T&lt;0-5&gt;. -T0 is the slowest (paranoid), while -T5 is the fastest. According to the Nmap manual page, there are six templates:\n\nParanoid (0)\nSneaky (1)\nPolite (2)\nNormal (3)\nAggressive (4)\nInsane (5)\n\nTo avoid IDS alerts, you might consider -T0 or -T1. For instance, -T0 scans one port at a time and waits 5 minutes between sending each probe. If you don‚Äôt specify any timing, Nmap uses normal -T3. Note that -T5 is the most aggressive in terms of speed; however, this can affect the accuracy of the scan results due to the increased likelihood of packet loss. Note that -T4 is often used during CTFs and when learning to scan on practice targets, whereas -T1 is often used during real engagements where stealth is more important.\nAlternatively, you can choose to control the packet rate using --min-rate &lt;number&gt; and --max-rate &lt;number&gt;. For example, --max-rate 10 or --max-rate=10 ensures that your scanner is not sending more than ten packets per second.\nMoreover, you can control probing parallelization using --min-parallelism &lt;numprobes&gt; and --max-parallelism &lt;numprobes&gt;. Nmap probes the targets to discover which hosts are live and which ports are open; probing parallelization specifies the number of such probes that can be run in parallel. For instance, --min-parallelism=512 pushes Nmap to maintain at least 512 probes in parallel; these 512 probes are related to host discovery and open ports.\nTASK 8 - SUMMARYThis room covered three types of scans:\n\nTCP Connect\nTCP SYN\nUDP\n\nThese scan types should get you started discovering running TCP and UDP services on a target host.\nDONE\nTHANK YOU,Satvik Shetty\n","slug":"Basic-Port-Scan-THM","date":"2024-05-16T10:05:28.000Z","categories_index":"cybersecurity,THM","tags_index":"tryhackme,nmap,information-gathering","author_index":"Satvik"},{"id":"df002c45b5a83b11244a8755ec495303","title":"Beginner Resources 2024","content":"Online Tools and ResourcesIP and DNS Leak Testing\nipleak.net\ndiafygi.github.io&#x2F;webrtc-ips\ndnsleaktest.com\n\nTor Check üßÖ\n5deqglhxcoy3gbx6.onion\ntmkloc6vhxos3nde.onion\n\nSMS üì©\nreceive-sms-online.info\nreceive-sms-now.com\nreceivesmsonline.net\n\nFake Identity üôÉ\nfakena.me\nnames.igopaygo.com&#x2F;people&#x2F;fake_person\nfakenamegenerator.com\n\nNetwork Online Tools üåê\nyougetsignal.com\ndnswatch.info\nnirsoft.net&#x2F;countryip\ntcpiputils.com\nbgp.he.net\nsockets.com&#x2F;services.htm\nservices.ce3c.be&#x2F;ciprg\ncoffer.com&#x2F;mac_find\n\nVulnerabilities Database üéØ\ncve.mitre.org&#x2F;cve\ncvedetails.com\nosvdb.org\nkb.cert.org&#x2F;vuls\nsecunia.com&#x2F;community&#x2F;advisories&#x2F;search\nsecurityfocus.com&#x2F;bid\nlwn.net&#x2F;Vulnerabilities\ndenimgroup.com&#x2F;resources-threadfix\nvulnerability-lab.com\nsecdocs.org\nnvd.nist.gov\n\nExploits Database üí•\nexploit-db.com\nintelligentexploit.com\nshodanhq.com\npacketstormsecurity.com\n\n","slug":"Resources-2024-Beginners","date":"2024-05-15T19:12:11.000Z","categories_index":"","tags_index":"cybersecurity,resources,hacking","author_index":"Satvik"}]