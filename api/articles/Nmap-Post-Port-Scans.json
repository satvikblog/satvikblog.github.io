{"title":"Nmap Post Port Scans","uid":"2fabf1408eddff0177ed3e3bbe3ade2f","slug":"Nmap-Post-Port-Scans","date":"2024-05-18T11:07:59.000Z","updated":"2024-05-22T16:56:49.481Z","comments":true,"path":"api/articles/Nmap-Post-Port-Scans.json","keywords":null,"cover":"https://techyrick.com/wp-content/uploads/2021/09/nmap.webp","content":"<h1 id=\"TASK-1-Introduction\"><a href=\"#TASK-1-Introduction\" class=\"headerlink\" title=\"TASK 1 - Introduction:\"></a>TASK 1 - Introduction:</h1><p>This room is the last in the Nmap series (part of the Introduction to Network Security module). In this room, we focus on the steps that follow port-scanning: in particular, service detection, OS detection, Nmap scripting engine, and saving the scan results.</p>\n<p>Nmap Live Host Discovery<br>Nmap Basic Port Scans<br>Nmap Advanced Port Scans<br>Nmap Post Port Scans<br>In the first room of this series, we have learned how Nmap can enumerate targets, discover live hosts, and use reverse-DNS to find interesting names. The second and third rooms of the series focused on the basic and advanced types of scans for network ports.</p>\n<p>In the last room, as shown in the figure below, we focus on how Nmap can be used to:</p>\n<p>Detect versions of the running services (on all open ports)<br>Detect the OS based on any signs revealed by the target<br>Run Nmap’s traceroute<br>Run select Nmap scripts<br>Save the scan results in various formats<br><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5f04259cf9bf5b57aed2c476/room-content/c9724491cb38c1ebcd83b5b98f13e1d9.png\" alt=\"alt_img\"></p>\n<p>This room will focus on these steps and how to execute them after the port scan.</p>\n<h2 id=\"Questions-and-Answers-of-the-task\"><a href=\"#Questions-and-Answers-of-the-task\" class=\"headerlink\" title=\"Questions and Answers of the task:\"></a>Questions and Answers of the task:</h2><p><img src=\"https://i.imgur.com/ax8XU95.png\" alt=\"s\"></p>\n<h1 id=\"TASK-2-Service-Detection\"><a href=\"#TASK-2-Service-Detection\" class=\"headerlink\" title=\"TASK 2 - Service Detection:\"></a>TASK 2 - Service Detection:</h1><p>Once Nmap discovers open ports, you can probe the available port to detect the running service. Further investigation of open ports is an essential piece of information as the pentester can use it to learn if there are any known vulnerabilities of the service. Join Vulnerabilities 101 to learn more about searching for vulnerable services.</p>\n<p>Adding <code>-sV</code> to your Nmap command will collect and determine service and version information for the open ports. You can control the intensity with <code>--version-intensity</code> LEVEL where the level ranges between 0, the lightest, and 9, the most complete. <code>-sV --version-light</code> has an intensity of 2, while <code>-sV --version-all</code> has an intensity of 9.</p>\n<p>It is important to note that using <code>-sV</code> will force Nmap to proceed with the TCP 3-way handshake and establish the connection. The connection establishment is necessary because Nmap cannot discover the version without establishing a connection fully and communicating with the listening service. In other words, stealth SYN scan -sS is not possible when <code>-sV</code> option is chosen.</p>\n<p>The console output below shows a simple Nmap stealth SYN scan with the <code>-sV</code> option. Adding the <code>-sV</code> option leads to a new column in the output showing the version for each detected service. For instance, in the case of TCP port 22 being open, instead of 22&#x2F;tcp open ssh, we obtain 22&#x2F;tcp open ssh OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0). Notice that the SSH protocol is guessed as the service because TCP port 22 is open; Nmap didn’t need to connect to port 22 to confirm. However, -sV required connecting to this open port to grab the service banner and any version information it can get, such as nginx 1.6.2. Hence, unlike the service column, the version column is not a guess.</p>\n<p>Pentester Terminal</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pentester@TryHackMe$ sudo nmap -sV MACHINE_IP</span><br><span class=\"line\"></span><br><span class=\"line\">Starting Nmap 7.60 ( https://nmap.org ) at 2021-09-10 05:03 BST</span><br><span class=\"line\">Nmap scan report <span class=\"keyword\">for</span> MACHINE_IP</span><br><span class=\"line\">Host is up (0.0040s latency).</span><br><span class=\"line\">Not shown: 995 closed ports</span><br><span class=\"line\">PORT    STATE SERVICE VERSION</span><br><span class=\"line\">22/tcp  open  ssh     OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0)</span><br><span class=\"line\">25/tcp  open  smtp    Postfix smtpd</span><br><span class=\"line\">80/tcp  open  http    nginx 1.6.2</span><br><span class=\"line\">110/tcp open  pop3    Dovecot pop3d</span><br><span class=\"line\">111/tcp open  rpcbind 2-4 (RPC <span class=\"comment\">#100000)</span></span><br><span class=\"line\">MAC Address: 02:A0:E7:B5:B6:C5 (Unknown)</span><br><span class=\"line\">Service Info: Host:  debra2.thm.local; OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class=\"line\"></span><br><span class=\"line\">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class=\"line\">Nmap <span class=\"keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"keyword\">in</span> 8.40 seconds</span><br></pre></td></tr></table></figure>\n<p>Note that many Nmap options require root privileges. Unless you are running Nmap as root, you need to use sudo as in the example above.</p>\n<p>Start the VM. Once it is ready, open the terminal on the AttackBox to answer the following questions.</p>\n<h2 id=\"Questions-and-answers-of-the-task\"><a href=\"#Questions-and-answers-of-the-task\" class=\"headerlink\" title=\"Questions and answers of the task\"></a>Questions and answers of the task</h2><p><img src=\"https://i.imgur.com/eRBWdbO.png\" alt=\"ims\"></p>\n<h1 id=\"TASK-3-OS-Detection-and-TraceRoute\"><a href=\"#TASK-3-OS-Detection-and-TraceRoute\" class=\"headerlink\" title=\"TASK 3 - OS Detection and TraceRoute\"></a>TASK 3 - OS Detection and TraceRoute</h1><h2 id=\"OS-Detection\"><a href=\"#OS-Detection\" class=\"headerlink\" title=\"OS Detection\"></a>OS Detection</h2><p>Nmap can detect the Operating System (OS) based on its behaviour and any telltale signs in its responses. OS detection can be enabled using <code>-O</code> ; this is an uppercase O as in OS. In this example, we ran <code>nmap -sS -O  MACHINE_IP</code> on the AttackBox. Nmap detected the OS to be Linux 3.X, and then it guessed further that it was running kernel 3.13.</p>\n<p>Pentester Terminal</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pentester@TryHackMe$ sudo nmap -sS -O  MACHINE_IP</span><br><span class=\"line\"></span><br><span class=\"line\">Starting Nmap 7.60 ( https://nmap.org ) at 2021-09-10 05:04 BST</span><br><span class=\"line\">Nmap scan report <span class=\"keyword\">for</span> MACHINE_IP</span><br><span class=\"line\">Host is up (0.00099s latency).</span><br><span class=\"line\">Not shown: 994 closed ports</span><br><span class=\"line\">PORT    STATE SERVICE</span><br><span class=\"line\">22/tcp  open  ssh</span><br><span class=\"line\">25/tcp  open  smtp</span><br><span class=\"line\">80/tcp  open  http</span><br><span class=\"line\">110/tcp open  pop3</span><br><span class=\"line\">111/tcp open  rpcbind</span><br><span class=\"line\">143/tcp open  imap</span><br><span class=\"line\">MAC Address: 02:A0:E7:B5:B6:C5 (Unknown)</span><br><span class=\"line\">Device <span class=\"built_in\">type</span>: general purpose</span><br><span class=\"line\">Running: Linux 3.X</span><br><span class=\"line\">OS CPE: cpe:/o:linux:linux_kernel:3.13</span><br><span class=\"line\">OS details: Linux 3.13</span><br><span class=\"line\">Network Distance: 1 hop</span><br><span class=\"line\"></span><br><span class=\"line\">OS detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class=\"line\">Nmap <span class=\"keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"keyword\">in</span> 3.91 seconds</span><br></pre></td></tr></table></figure>\n<p>The system that we scanned and attempted to detect its OS version is running kernel version 3.16. Nmap was able to make a close guess in this case. In another case, we scanned a Fedora Linux system with kernel 5.13.14; however, Nmap detected it as Linux 2.6.X. The good news is that Nmap detected the OS correctly; the not-so-good news is that the kernel version was wrong.</p>\n<p>The OS detection is very convenient, but many factors might affect its accuracy. First and foremost, Nmap needs to find at least one open and one closed port on the target to make a reliable guess. Furthermore, the guest OS fingerprints might get distorted due to the rising use of virtualization and similar technologies. Therefore, always take the OS version with a grain of salt.</p>\n<h2 id=\"Traceroute\"><a href=\"#Traceroute\" class=\"headerlink\" title=\"Traceroute\"></a>Traceroute</h2><p>If you want Nmap to find the routers between you and the target, just add <code>--traceroute</code>. In the following example, Nmap appended a traceroute to its scan results. Note that Nmap’s traceroute works slightly different than the traceroute command found on Linux and macOS or tracert found on MS Windows. Standard traceroute starts with a packet of low TTL (Time to Live) and keeps increasing until it reaches the target. Nmap’s traceroute starts with a packet of high TTL and keeps decreasing it.</p>\n<p>In the following example, we executed <code>nmap -sS --traceroute MACHINE_IP</code> on the AttackBox. We can see that there are no routers&#x2F;hops between the two as they are connected directly.</p>\n<p>Pentester Terminal</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pentester@TryHackMe$ sudo nmap -sS --traceroute MACHINE_IP</span><br><span class=\"line\"></span><br><span class=\"line\">Starting Nmap 7.60 ( https://nmap.org ) at 2021-09-10 05:05 BST</span><br><span class=\"line\">Nmap scan report <span class=\"keyword\">for</span> MACHINE_IP</span><br><span class=\"line\">Host is up (0.0015s latency).</span><br><span class=\"line\">Not shown: 994 closed ports</span><br><span class=\"line\">PORT    STATE SERVICE</span><br><span class=\"line\">22/tcp  open  ssh</span><br><span class=\"line\">25/tcp  open  smtp</span><br><span class=\"line\">80/tcp  open  http</span><br><span class=\"line\">110/tcp open  pop3</span><br><span class=\"line\">111/tcp open  rpcbind</span><br><span class=\"line\">143/tcp open  imap</span><br><span class=\"line\">MAC Address: 02:A0:E7:B5:B6:C5 (Unknown)</span><br><span class=\"line\"></span><br><span class=\"line\">TRACEROUTE</span><br><span class=\"line\">HOP RTT     ADDRESS</span><br><span class=\"line\">1   1.48 ms MACHINE_IP</span><br><span class=\"line\"></span><br><span class=\"line\">Nmap <span class=\"keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"keyword\">in</span> 1.59 seconds</span><br></pre></td></tr></table></figure>\n<p>It is worth mentioning that many routers are configured not to send ICMP Time-to-Live exceeded, which would prevent us from discovering their IP addresses. For more information, visit the Active Reconnaissance room.</p>\n<h2 id=\"Questions-and-answers-of-this-Task\"><a href=\"#Questions-and-answers-of-this-Task\" class=\"headerlink\" title=\"Questions and answers of this Task\"></a>Questions and answers of this Task</h2><p><img src=\"https://i.imgur.com/uClVLn0.png\" alt=\"ew\"></p>\n<h1 id=\"TASK-4-NMAP-Scripting-Engine-NSE\"><a href=\"#TASK-4-NMAP-Scripting-Engine-NSE\" class=\"headerlink\" title=\"TASK -4 NMAP Scripting Engine[NSE]\"></a>TASK -4 NMAP Scripting Engine[NSE]</h1><p>A script is a piece of code that does not need to be compiled. In other words, it remains in its original human-readable form and does not need to be converted to machine language. Many programs provide additional functionality via scripts; moreover, scripts make it possible to add custom functionality that did not exist via the built-in commands. Similarly, Nmap provides support for scripts using the Lua language. A part of Nmap, Nmap Scripting Engine (NSE) is a Lua interpreter that allows Nmap to execute Nmap scripts written in Lua language. However, we don’t need to learn Lua to make use of Nmap scripts.</p>\n<p>Your Nmap default installation can easily contain close to 600 scripts. Take a look at your Nmap installation folder. On the AttackBox, check the files at &#x2F;usr&#x2F;share&#x2F;nmap&#x2F;scripts, and you will notice that there are hundreds of scripts conveniently named starting with the protocol they target. We listed all the scripts starting with the HTTP on the AttackBox in the console output below; we found around 130 scripts starting with http. With future updates, you can only expect the number of installed scripts to increase.</p>\n<p>Pentester Terminal</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pentester@AttackBox /usr/share/nmap/scripts<span class=\"comment\"># ls http*</span></span><br><span class=\"line\">http-adobe-coldfusion-apsa1301.nse      http-passwd.nse</span><br><span class=\"line\">http-affiliate-id.nse                   http-php-version.nse</span><br><span class=\"line\">http-apache-negotiation.nse             http-phpmyadmin-dir-traversal.nse</span><br><span class=\"line\">http-apache-server-status.nse           http-phpself-xss.nse</span><br><span class=\"line\">http-aspnet-debug.nse                   http-proxy-brute.nse</span><br><span class=\"line\">http-auth-finder.nse                    http-put.nse</span><br><span class=\"line\">http-auth.nse                           http-qnap-nas-info.nse</span><br><span class=\"line\">http-avaya-ipoffice-users.nse           http-referer-checker.nse</span><br><span class=\"line\">http-awstatstotals-exec.nse             http-rfi-spider.nse</span><br><span class=\"line\">http-axis2-dir-traversal.nse            http-robots.txt.nse</span><br><span class=\"line\">http-backup-finder.nse                  http-robtex-reverse-ip.nse</span><br><span class=\"line\">http-barracuda-dir-traversal.nse        http-robtex-shared-ns.nse</span><br><span class=\"line\">http-brute.nse                          http-security-headers.nse</span><br><span class=\"line\">http-cakephp-version.nse                http-server-header.nse</span><br><span class=\"line\">http-chrono.nse                         http-shellshock.nse</span><br><span class=\"line\">http-cisco-anyconnect.nse               http-sitemap-generator.nse</span><br><span class=\"line\">http-coldfusion-subzero.nse             http-slowloris-check.nse</span><br><span class=\"line\">http-comments-displayer.nse             http-slowloris.nse</span><br><span class=\"line\">http-config-backup.nse                  http-sql-injection.nse</span><br><span class=\"line\">http-cookie-flags.nse                   http-stored-xss.nse</span><br><span class=\"line\">http-cors.nse                           http-svn-enum.nse</span><br><span class=\"line\">http-cross-domain-policy.nse            http-svn-info.nse</span><br><span class=\"line\">http-csrf.nse                           http-title.nse</span><br><span class=\"line\">http-date.nse                           http-tplink-dir-traversal.nse</span><br><span class=\"line\">http-default-accounts.nse               http-trace.nse</span><br><span class=\"line\">http-devframework.nse                   http-traceroute.nse</span><br><span class=\"line\">http-dlink-backdoor.nse                 http-unsafe-output-escaping.nse</span><br><span class=\"line\">http-dombased-xss.nse                   http-useragent-tester.nse</span><br><span class=\"line\">http-domino-enum-passwords.nse          http-userdir-enum.nse</span><br><span class=\"line\">http-drupal-enum-users.nse              http-vhosts.nse</span><br><span class=\"line\">http-drupal-enum.nse                    http-virustotal.nse</span><br><span class=\"line\">http-enum.nse                           http-vlcstreamer-ls.nse</span><br><span class=\"line\">http-errors.nse                         http-vmware-path-vuln.nse</span><br><span class=\"line\">http-exif-spider.nse                    http-vuln-cve2006-3392.nse</span><br><span class=\"line\">http-favicon.nse                        http-vuln-cve2009-3960.nse</span><br><span class=\"line\">http-feed.nse                           http-vuln-cve2010-0738.nse</span><br><span class=\"line\">http-fetch.nse                          http-vuln-cve2010-2861.nse</span><br><span class=\"line\">http-fileupload-exploiter.nse           http-vuln-cve2011-3192.nse</span><br><span class=\"line\">http-form-brute.nse                     http-vuln-cve2011-3368.nse</span><br><span class=\"line\">http-form-fuzzer.nse                    http-vuln-cve2012-1823.nse</span><br><span class=\"line\">http-frontpage-login.nse                http-vuln-cve2013-0156.nse</span><br><span class=\"line\">http-generator.nse                      http-vuln-cve2013-6786.nse</span><br><span class=\"line\">http-git.nse                            http-vuln-cve2013-7091.nse</span><br><span class=\"line\">http-gitweb-projects-enum.nse           http-vuln-cve2014-2126.nse</span><br><span class=\"line\">http-google-malware.nse                 http-vuln-cve2014-2127.nse</span><br><span class=\"line\">http-grep.nse                           http-vuln-cve2014-2128.nse</span><br><span class=\"line\">http-headers.nse                        http-vuln-cve2014-2129.nse</span><br><span class=\"line\">http-huawei-hg5xx-vuln.nse              http-vuln-cve2014-3704.nse</span><br><span class=\"line\">http-icloud-findmyiphone.nse            http-vuln-cve2014-8877.nse</span><br><span class=\"line\">http-icloud-sendmsg.nse                 http-vuln-cve2015-1427.nse</span><br><span class=\"line\">http-iis-short-name-brute.nse           http-vuln-cve2015-1635.nse</span><br><span class=\"line\">http-iis-webdav-vuln.nse                http-vuln-cve2017-1001000.nse</span><br><span class=\"line\">http-internal-ip-disclosure.nse         http-vuln-cve2017-5638.nse</span><br><span class=\"line\">http-joomla-brute.nse                   http-vuln-cve2017-5689.nse</span><br><span class=\"line\">http-litespeed-sourcecode-download.nse  http-vuln-cve2017-8917.nse</span><br><span class=\"line\">http-ls.nse                             http-vuln-misfortune-cookie.nse</span><br><span class=\"line\">http-majordomo2-dir-traversal.nse       http-vuln-wnr1000-creds.nse</span><br><span class=\"line\">http-malware-host.nse                   http-waf-detect.nse</span><br><span class=\"line\">http-mcmp.nse                           http-waf-fingerprint.nse</span><br><span class=\"line\">http-method-tamper.nse                  http-webdav-scan.nse</span><br><span class=\"line\">http-methods.nse                        http-wordpress-brute.nse</span><br><span class=\"line\">http-mobileversion-checker.nse          http-wordpress-enum.nse</span><br><span class=\"line\">http-ntlm-info.nse                      http-wordpress-users.nse</span><br><span class=\"line\">http-open-proxy.nse                     http-xssed.nse</span><br><span class=\"line\">http-open-redirect.nse</span><br></pre></td></tr></table></figure>\n<p>You can specify to use any or a group of these installed scripts; moreover, you can install other user’s scripts and use them for your scans. Let’s begin with the default scripts. You can choose to run the scripts in the default category using –script&#x3D;default or simply adding -sC. In addition to default, categories include auth, broadcast, brute, default, discovery, dos, exploit, external, fuzzer, intrusive, malware, safe, version, and vuln. A brief description is shown in the following table.</p>\n<table>\n<thead>\n<tr>\n<th>Script Category</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>auth</td>\n<td>Authentication related scripts</td>\n</tr>\n<tr>\n<td>broadcast</td>\n<td>Discover hosts by sending broadcast messages</td>\n</tr>\n<tr>\n<td>brute</td>\n<td>Performs brute-force password auditing against logins</td>\n</tr>\n<tr>\n<td>default</td>\n<td>Default scripts, same as -sC</td>\n</tr>\n<tr>\n<td>discovery</td>\n<td>Retrieve accessible information, such as database tables and DNS names</td>\n</tr>\n<tr>\n<td>dos</td>\n<td>Detects servers vulnerable to Denial of Service (DoS)</td>\n</tr>\n<tr>\n<td>exploit</td>\n<td>Attempts to exploit various vulnerable services</td>\n</tr>\n<tr>\n<td>external</td>\n<td>Checks using a third-party service, such as Geoplugin and Virustotal</td>\n</tr>\n<tr>\n<td>fuzzer</td>\n<td>Launch fuzzing attacks</td>\n</tr>\n<tr>\n<td>intrusive</td>\n<td>Intrusive scripts such as brute-force attacks and exploitation</td>\n</tr>\n<tr>\n<td>malware</td>\n<td>Scans for backdoors</td>\n</tr>\n<tr>\n<td>safe</td>\n<td>Safe scripts that won’t crash the target</td>\n</tr>\n<tr>\n<td>version</td>\n<td>Retrieve service versions</td>\n</tr>\n<tr>\n<td>vuln</td>\n<td>Checks for vulnerabilities or exploit vulnerable services</td>\n</tr>\n</tbody></table>\n<p>Some scripts belong to more than one category. Moreover, some scripts launch brute-force attacks against services, while others launch DoS attacks and exploit systems. Hence, it is crucial to be careful when selecting scripts to run if you don’t want to crash services or exploit them.</p>\n<p>We use Nmap to run a SYN scan against MACHINE_IP and execute the default scripts in the console shown below. The command is sudo nmap -sS -sC MACHINE_IP, where -sC will ensure that Nmap will execute the default scripts following the SYN scan. There are new details that appear below. Take a look at the SSH service at port 22; Nmap recovered all four public keys related to the running server. Consider another example, the HTTP service at port 80; Nmap retrieved the default page title. We can see that the page has been left as default.</p>\n<p>Pentester Terminal</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pentester@TryHackMe$ sudo nmap -sS -sC MACHINE_IP</span><br><span class=\"line\"></span><br><span class=\"line\">Starting Nmap 7.60 ( https://nmap.org ) at 2021-09-10 05:08 BST</span><br><span class=\"line\">Nmap scan report <span class=\"keyword\">for</span> ip-10-10-161-170.eu-west-1.compute.internal (10.10.161.170)</span><br><span class=\"line\">Host is up (0.0011s latency).</span><br><span class=\"line\">Not shown: 994 closed ports</span><br><span class=\"line\">PORT    STATE SERVICE</span><br><span class=\"line\">22/tcp  open  ssh</span><br><span class=\"line\">| ssh-hostkey: </span><br><span class=\"line\">|   1024 d5:80:97:a3:a8:3b:57:78:2f:0a:78:ae:ad:34:24:f4 (DSA)</span><br><span class=\"line\">|   2048 aa:66:7a:45:eb:d1:8c:00:e3:12:31:d8:76:8e:ed:3a (RSA)</span><br><span class=\"line\">|   256 3d:82:72:a3:07:49:2e:cb:d9:87:db:08:c6:90:56:65 (ECDSA)</span><br><span class=\"line\">|_  256 dc:f0:0c:89:70:87:65:ba:52:b1:e9:59:f7:5d:d2:6a (EdDSA)</span><br><span class=\"line\">25/tcp  open  smtp</span><br><span class=\"line\">|_smtp-commands: debra2.thm.local, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN, </span><br><span class=\"line\">| ssl-cert: Subject: commonName=debra2.thm.local</span><br><span class=\"line\">| Not valid before: 2021-08-10T12:10:58</span><br><span class=\"line\">|_Not valid after:  2031-08-08T12:10:58</span><br><span class=\"line\">|_ssl-<span class=\"built_in\">date</span>: TLS randomness does not represent time</span><br><span class=\"line\">80/tcp  open  http</span><br><span class=\"line\">|_http-title: Welcome to nginx on Debian!</span><br><span class=\"line\">110/tcp open  pop3</span><br><span class=\"line\">|_pop3-capabilities: RESP-CODES CAPA TOP SASL UIDL PIPELINING AUTH-RESP-CODE</span><br><span class=\"line\">111/tcp open  rpcbind</span><br><span class=\"line\">| rpcinfo: </span><br><span class=\"line\">|   program version   port/proto  service</span><br><span class=\"line\">|   100000  2,3,4        111/tcp  rpcbind</span><br><span class=\"line\">|   100000  2,3,4        111/udp  rpcbind</span><br><span class=\"line\">|   100024  1          38099/tcp  status</span><br><span class=\"line\">|_  100024  1          54067/udp  status</span><br><span class=\"line\">143/tcp open  imap</span><br><span class=\"line\">|_imap-capabilities: LITERAL+ capabilities IMAP4rev1 OK Pre-login ENABLE have LOGINDISABLEDA0001 listed SASL-IR ID more post-login LOGIN-REFERRALS IDLE</span><br><span class=\"line\">MAC Address: 02:A0:E7:B5:B6:C5 (Unknown)</span><br><span class=\"line\"></span><br><span class=\"line\">Nmap <span class=\"keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"keyword\">in</span> 2.21 seconds </span><br></pre></td></tr></table></figure>\n<p>You can also specify the script by name using –script “SCRIPT-NAME” or a pattern such as –script “ftp*”, which would include ftp-brute. If you are unsure what a script does, you can open the script file with a text reader, such as less, or a text editor. In the case of ftp-brute, it states: “Performs brute force password auditing against FTP servers.” You have to be careful as some scripts are pretty intrusive. Moreover, some scripts might be for a specific server and, if chosen at random, will waste your time with no benefit. As usual, make sure that you are authorized to launch such tests on the target server.</p>\n<p>Let’s consider a benign script, http-date, which we guess would retrieve the http server date and time, and this is indeed confirmed in its description: “Gets the date from HTTP-like services. Also, it prints how much the date differs from local time…” On the AttackBox, we execute sudo nmap -sS -n –script “http-date” MACHINE_IP as shown in the console below.</p>\n<p>Pentester Terminal</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pentester@TryHackMe$ sudo nmap -sS -n --script <span class=\"string\">&quot;http-date&quot;</span> MACHINE_IP</span><br><span class=\"line\"></span><br><span class=\"line\">Starting Nmap 7.60 ( https://nmap.org ) at 2021-09-10 08:04 BST</span><br><span class=\"line\">Nmap scan report <span class=\"keyword\">for</span> MACHINE_IP</span><br><span class=\"line\">Host is up (0.0011s latency).</span><br><span class=\"line\">Not shown: 994 closed ports</span><br><span class=\"line\">PORT    STATE SERVICE</span><br><span class=\"line\">22/tcp  open  ssh</span><br><span class=\"line\">25/tcp  open  smtp</span><br><span class=\"line\">80/tcp  open  http</span><br><span class=\"line\">|_http-<span class=\"built_in\">date</span>: Fri, 10 Sep 2021 07:04:26 GMT; 0s from <span class=\"built_in\">local</span> time.</span><br><span class=\"line\">110/tcp open  pop3</span><br><span class=\"line\">111/tcp open  rpcbind</span><br><span class=\"line\">143/tcp open  imap</span><br><span class=\"line\">MAC Address: 02:44:87:82:AC:83 (Unknown)</span><br><span class=\"line\"></span><br><span class=\"line\">Nmap <span class=\"keyword\">done</span>: 1 IP address (1 host up) scanned <span class=\"keyword\">in</span> 1.78 seconds</span><br></pre></td></tr></table></figure>\n<p>Finally, you might expand the functionality of Nmap beyond the official Nmap scripts; you can write your script or download Nmap scripts from the Internet. Downloading and using a Nmap script from the Internet holds a certain level of risk. So it is a good idea not to run a script from an author you don’t trust.</p>\n<h2 id=\"Questions-and-Answers-of-the-Task\"><a href=\"#Questions-and-Answers-of-the-Task\" class=\"headerlink\" title=\"Questions and Answers of the Task\"></a>Questions and Answers of the Task</h2><p><img src=\"https://i.imgur.com/r9vAdgb.png\" alt=\"s\"></p>\n<h1 id=\"TASK-5-Saving-the-Output\"><a href=\"#TASK-5-Saving-the-Output\" class=\"headerlink\" title=\"TASK - 5 Saving the Output:\"></a>TASK - 5 Saving the Output:</h1><p>Whenever you run a Nmap scan, it is only reasonable to save the results in a file. Selecting and adopting a good naming convention for your filenames is also crucial. The number of files can quickly grow and hinder your ability to find a previous scan result. The three main formats are:</p>\n<p>-Normal<br>-Grepable (grepable)<br>-XML<br><em>There is a fourth one that we cannot recommend:</em><br>-Script Kiddie</p>\n<h3 id=\"Normal\"><a href=\"#Normal\" class=\"headerlink\" title=\"Normal\"></a>Normal</h3><p>As the name implies, the normal format is similar to the output you get on the screen when scanning a target. You can save your scan in normal format by using -oN FILENAME; N stands for normal. Here is an example of the result.</p>\n<p>Pentester Terminal</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pentester@TryHackMe$ <span class=\"built_in\">cat</span> MACHINE_IP_scan.nmap </span><br><span class=\"line\"><span class=\"comment\"># Nmap 7.60 scan initiated Fri Sep 10 05:14:19 2021 as: nmap -sS -sV -O -oN MACHINE_IP_scan MACHINE_IP</span></span><br><span class=\"line\">Nmap scan report <span class=\"keyword\">for</span> MACHINE_IP</span><br><span class=\"line\">Host is up (0.00086s latency).</span><br><span class=\"line\">Not shown: 994 closed ports</span><br><span class=\"line\">PORT    STATE SERVICE VERSION</span><br><span class=\"line\">22/tcp  open  ssh     OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0)</span><br><span class=\"line\">25/tcp  open  smtp    Postfix smtpd</span><br><span class=\"line\">80/tcp  open  http    nginx 1.6.2</span><br><span class=\"line\">110/tcp open  pop3    Dovecot pop3d</span><br><span class=\"line\">111/tcp open  rpcbind 2-4 (RPC <span class=\"comment\">#100000)</span></span><br><span class=\"line\">143/tcp open  imap    Dovecot imapd</span><br><span class=\"line\">MAC Address: 02:A0:E7:B5:B6:C5 (Unknown)</span><br><span class=\"line\">Device <span class=\"built_in\">type</span>: general purpose</span><br><span class=\"line\">Running: Linux 3.X</span><br><span class=\"line\">OS CPE: cpe:/o:linux:linux_kernel:3.13</span><br><span class=\"line\">OS details: Linux 3.13</span><br><span class=\"line\">Network Distance: 1 hop</span><br><span class=\"line\">Service Info: Host:  debra2.thm.local; OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class=\"line\"></span><br><span class=\"line\">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class=\"line\"><span class=\"comment\"># Nmap done at Fri Sep 10 05:14:28 2021 -- 1 IP address (1 host up) scanned in 9.99 seconds</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"Grepable\"><a href=\"#Grepable\" class=\"headerlink\" title=\"Grepable\"></a>Grepable</h3><p>The grepable format has its name from the command grep; grep stands for Global Regular Expression Printer. In simple terms, it makes filtering the scan output for specific keywords or terms efficient. You can save the scan result in grepable format using -oG FILENAME. The scan output, displayed above in normal format, is shown in the console below using grepable format. The normal output is 21 lines; however, the grepable output is only 4 lines. The main reason is that Nmap wants to make each line meaningful and complete when the user applies grep. As a result, in grepable output, the lines are so long and are not convenient to read compared to normal output.</p>\n<p>Pentester Terminal</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pentester@TryHackMe$ <span class=\"built_in\">cat</span> MACHINE_IP_scan.gnmap </span><br><span class=\"line\"><span class=\"comment\"># Nmap 7.60 scan initiated Fri Sep 10 05:14:19 2021 as: nmap -sS -sV -O -oG MACHINE_IP_scan MACHINE_IP</span></span><br><span class=\"line\">Host: MACHINE_IP\tStatus: Up</span><br><span class=\"line\">Host: MACHINE_IP\tPorts: 22/open/tcp//ssh//OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0)/, 25/open/tcp//smtp//Postfix smtpd/, 80/open/tcp//http//nginx 1.6.2/, 110/open/tcp//pop3//Dovecot pop3d/, 111/open/tcp//rpcbind//2-4 (RPC <span class=\"comment\">#100000)/, 143/open/tcp//imap//Dovecot imapd/\tIgnored State: closed (994)\tOS: Linux 3.13\tSeq Index: 257\tIP ID Seq: All zeros</span></span><br><span class=\"line\"><span class=\"comment\"># Nmap done at Fri Sep 10 05:14:28 2021 -- 1 IP address (1 host up) scanned in 9.99 seconds</span></span><br></pre></td></tr></table></figure>\n<p>An example use of grep is grep KEYWORD TEXT_FILE; this command will display all the lines containing the provided keyword. Let’s compare the output of using grep on normal output and grepable output. You will notice that the former does not provide the IP address of the host. Instead, it returned 80&#x2F;tcp open http nginx 1.6.2, making it very inconvenient if you are sifting through the scan results of multiple systems. However, the latter provides enough information, such as the host’s IP address, in each line to make it complete.</p>\n<p>Pentester Terminal</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pentester@TryHackMe$ grep http MACHINE_IP_scan.nmap </span><br><span class=\"line\">80/tcp  open  http    nginx 1.6.2</span><br><span class=\"line\">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class=\"line\">Pentester Terminal</span><br><span class=\"line\">pentester@TryHackMe$ grep http MACHINE_IP_scan.gnmap </span><br><span class=\"line\">Host: MACHINE_IP\tPorts: 22/open/tcp//ssh//OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0)/, 25/open/tcp//smtp//Postfix smtpd/, 80/open/tcp//http//nginx 1.6.2/, 110/open/tcp//pop3//Dovecot pop3d/, 111/open/tcp//rpcbind//2-4 (RPC <span class=\"comment\">#100000)/, 143/open/tcp//imap//Dovecot imapd/\tIgnored State: closed (994)\tOS: Linux 3.13\tSeq Index: 257\tIP ID Seq: All zeros</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"XML\"><a href=\"#XML\" class=\"headerlink\" title=\"XML\"></a>XML</h3><p>The third format is XML. You can save the scan results in XML format using -oX FILENAME. The XML format would be most convenient to process the output in other programs. Conveniently enough, you can save the scan output in all three formats using -oA FILENAME to combine -oN, -oG, and -oX for normal, grepable, and XML.</p>\n<h3 id=\"Script-Kiddie\"><a href=\"#Script-Kiddie\" class=\"headerlink\" title=\"Script Kiddie\"></a>Script Kiddie</h3><p>A fourth format is script kiddie. You can see that this format is useless if you want to search the output for any interesting keywords or keep the results for future reference. However, you can use it to save the output of the scan nmap -sS 127.0.0.1 -oS FILENAME, display the output filename, and look 31337 in front of friends who are not tech-savvy.</p>\n<p>Pentester Terminal</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pentester@TryHackMe$ <span class=\"built_in\">cat</span> MACHINE_IP_scan.kiddie </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$tart</span>!ng nMaP 7.60 ( httpz://nMap.0rG ) at 2021-09-10 05:17 B<span class=\"variable\">$T</span></span><br><span class=\"line\">Nmap scan rEp0rt f0r |p-10-10-161-170.EU-w3<span class=\"variable\">$t</span>-1.C0mputE.intErnaL (10.10.161.170)</span><br><span class=\"line\">HOSt !s uP (0.00095s LatEncy).</span><br><span class=\"line\">N0T <span class=\"variable\">$H0wn</span>: 994 closed pOrtS</span><br><span class=\"line\">PoRT    st4Te SeRViC3 VERS1on</span><br><span class=\"line\">22/tcp  Open  ssH     Op3n$<span class=\"variable\">$H</span> 6.7p1 Deb|an 5+dEb8u8 (pr0t0COl 2.0)</span><br><span class=\"line\">25/tCp  Op3n  SmTp    P0<span class=\"variable\">$Tf</span>!x Smtpd</span><br><span class=\"line\">80/tcp  0p3n  http    Ng1nx 1.6.2</span><br><span class=\"line\">110/tCP 0pen  pOP3    d0v3coT P0p3D</span><br><span class=\"line\">111/TcP op3n  RpcbInd 2-4 (RPC <span class=\"comment\">#100000)</span></span><br><span class=\"line\">143/Tcp opEn  Imap    Dovecot 1mApd</span><br><span class=\"line\">mAC 4Ddr3sz: 02:40:e7:B5:B6:c5 (Unknown)</span><br><span class=\"line\">Netw0rk d!stanc3: 1 h0p</span><br><span class=\"line\"><span class=\"variable\">$3rv1c3</span> InFO: Ho<span class=\"variable\">$t</span>:  dEBra2.thM.lOcal; 0s: Linux; cPe: cP3:/0:linux:l|nux_k3rnel</span><br><span class=\"line\"></span><br><span class=\"line\">0S and servIc3 D3tEcti0n pErf0rm3d. Plea<span class=\"variable\">$e</span> r3p0rt any !nc0RrecT rE<span class=\"variable\">$ultz</span> at hTtpz://nmap.0rg/<span class=\"variable\">$ubmit</span>/ .</span><br><span class=\"line\">Nmap d0nE: 1 |P addr3SS (1 hoSt up) <span class=\"variable\">$CaNnEd</span> !n 21.80 s3c0Ndz </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Questions-and-answers-of-this-Task-1\"><a href=\"#Questions-and-answers-of-this-Task-1\" class=\"headerlink\" title=\"Questions and answers of this Task\"></a>Questions and answers of this Task</h2><p><img src=\"https://i.imgur.com/xwAvJoG.png\" alt=\"kk\"></p>\n<h1 id=\"SUMMARY\"><a href=\"#SUMMARY\" class=\"headerlink\" title=\"SUMMARY\"></a>SUMMARY</h1><p>Summary of Nmap Options</p>\n<p>In this room, we learned how to detect the running services and their versions along with the host operating system. We learned how to enable traceroute and we covered selecting one or more scripts to aid in penetration testing. Finally, we covered the different formats to save the scan results for future reference. The table below summarizes the most important options we covered in this room.</p>\n<table>\n<thead>\n<tr>\n<th>Option</th>\n<th>Meaning</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-sV</td>\n<td>determine service&#x2F;version info on open ports</td>\n</tr>\n<tr>\n<td>-sV –version-light</td>\n<td>try the most likely probes (2)</td>\n</tr>\n<tr>\n<td>-sV –version-all</td>\n<td>try all available probes (9)</td>\n</tr>\n<tr>\n<td>-O</td>\n<td>detect OS</td>\n</tr>\n<tr>\n<td>–traceroute</td>\n<td>run traceroute to target</td>\n</tr>\n<tr>\n<td>–script&#x3D;SCRIPTS</td>\n<td>Nmap scripts to run</td>\n</tr>\n<tr>\n<td>-sC or –script&#x3D;default</td>\n<td>run default scripts</td>\n</tr>\n<tr>\n<td>-A</td>\n<td>equivalent to -sV -O -sC –traceroute</td>\n</tr>\n<tr>\n<td>-oN</td>\n<td>save output in normal format</td>\n</tr>\n<tr>\n<td>-oG</td>\n<td>save output in grepable format</td>\n</tr>\n<tr>\n<td>-oX</td>\n<td>save output in XML format</td>\n</tr>\n<tr>\n<td>-oA</td>\n<td>save output in normal, XML and Grepable formats</td>\n</tr>\n</tbody></table>\n<p>Thank you,<br><em>Author : <code>Satvik ❤️</code></em></p>\n","feature":false,"text":"TASK 1 - Introduction:This room is the last in the Nmap series (part of the Intr...","permalink":"/post/Nmap-Post-Port-Scans","photos":[],"count_time":{"symbolsCount":"25k","symbolsTime":"23 mins."},"categories":[{"name":"cybersecurity","slug":"cybersecurity","count":11,"path":"api/categories/cybersecurity.json"},{"name":"THM","slug":"cybersecurity/THM","count":11,"path":"api/categories/cybersecurity/THM.json"},{"name":"NMAP","slug":"cybersecurity/THM/NMAP","count":3,"path":"api/categories/cybersecurity/THM/NMAP.json"}],"tags":[{"name":"tryhackme","slug":"tryhackme","count":11,"path":"api/tags/tryhackme.json"},{"name":"nmap","slug":"nmap","count":4,"path":"api/tags/nmap.json"},{"name":"information-gathering","slug":"information-gathering","count":4,"path":"api/tags/information-gathering.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#TASK-1-Introduction\"><span class=\"toc-text\">TASK 1 - Introduction:</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Questions-and-Answers-of-the-task\"><span class=\"toc-text\">Questions and Answers of the task:</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#TASK-2-Service-Detection\"><span class=\"toc-text\">TASK 2 - Service Detection:</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Questions-and-answers-of-the-task\"><span class=\"toc-text\">Questions and answers of the task</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#TASK-3-OS-Detection-and-TraceRoute\"><span class=\"toc-text\">TASK 3 - OS Detection and TraceRoute</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#OS-Detection\"><span class=\"toc-text\">OS Detection</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Traceroute\"><span class=\"toc-text\">Traceroute</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Questions-and-answers-of-this-Task\"><span class=\"toc-text\">Questions and answers of this Task</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#TASK-4-NMAP-Scripting-Engine-NSE\"><span class=\"toc-text\">TASK -4 NMAP Scripting Engine[NSE]</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Questions-and-Answers-of-the-Task\"><span class=\"toc-text\">Questions and Answers of the Task</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#TASK-5-Saving-the-Output\"><span class=\"toc-text\">TASK - 5 Saving the Output:</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Normal\"><span class=\"toc-text\">Normal</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Grepable\"><span class=\"toc-text\">Grepable</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#XML\"><span class=\"toc-text\">XML</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Script-Kiddie\"><span class=\"toc-text\">Script Kiddie</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Questions-and-answers-of-this-Task-1\"><span class=\"toc-text\">Questions and answers of this Task</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#SUMMARY\"><span class=\"toc-text\">SUMMARY</span></a></li></ol>","author":{"name":"Satvik","slug":"blog-author","avatar":"https://media.licdn.com/dms/image/D5603AQHDAkzc5VpLcQ/profile-displayphoto-shrink_800_800/0/1708273426443?e=1721260800&v=beta&t=6mDy44GnhG2deGxjMd9TUFy-WKUpt7jNSNcdJD47uYc","link":"https://media.licdn.com/dms/image/D5603AQHDAkzc5VpLcQ/profile-displayphoto-shrink_800_800/0/1708273426443?e=1721260800&v=beta&t=6mDy44GnhG2deGxjMd9TUFy-WKUpt7jNSNcdJD47uYc","description":"An Aspiring Penetration Tester & a security Enthusiast 🚀 127.0.0.1 / sudo rm -rf / 😁 Dont Drink and Root 👀","socials":{"github":"https://github.com/satvik-vs","twitter":"https://twitter.com/SatvikVemulap2","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"instagram":{"icon":"fab fa-instagram","link":"https://instagram.com/satvikshetty"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"John The Ripper - THM Walkthrough","uid":"5f7b8ef4b9940ed8e2c482b3c33809b3","slug":"John-The-Ripper","date":"2024-05-20T11:12:16.000Z","updated":"2024-05-20T19:14:59.555Z","comments":true,"path":"api/articles/John-The-Ripper.json","keywords":null,"cover":"https://tryhackme-images.s3.amazonaws.com/room-icons/00b6a8786d69f4bd3f4aa2683411421e.jpeg","text":"Hello Hackers 🚀Today we will be solving the challenges in John The Ripper room o...","permalink":"/post/John-The-Ripper","photos":[],"count_time":{"symbolsCount":"31k","symbolsTime":"28 mins."},"categories":[{"name":"cybersecurity","slug":"cybersecurity","count":11,"path":"api/categories/cybersecurity.json"},{"name":"THM","slug":"cybersecurity/THM","count":11,"path":"api/categories/cybersecurity/THM.json"},{"name":"cryptography","slug":"cybersecurity/THM/cryptography","count":2,"path":"api/categories/cybersecurity/THM/cryptography.json"}],"tags":[{"name":"tryhackme","slug":"tryhackme","count":11,"path":"api/tags/tryhackme.json"},{"name":"cryptography","slug":"cryptography","count":2,"path":"api/tags/cryptography.json"},{"name":"hashing","slug":"hashing","count":2,"path":"api/tags/hashing.json"}],"author":{"name":"Satvik","slug":"blog-author","avatar":"https://media.licdn.com/dms/image/D5603AQHDAkzc5VpLcQ/profile-displayphoto-shrink_800_800/0/1708273426443?e=1721260800&v=beta&t=6mDy44GnhG2deGxjMd9TUFy-WKUpt7jNSNcdJD47uYc","link":"https://media.licdn.com/dms/image/D5603AQHDAkzc5VpLcQ/profile-displayphoto-shrink_800_800/0/1708273426443?e=1721260800&v=beta&t=6mDy44GnhG2deGxjMd9TUFy-WKUpt7jNSNcdJD47uYc","description":"An Aspiring Penetration Tester & a security Enthusiast 🚀 127.0.0.1 / sudo rm -rf / 😁 Dont Drink and Root 👀","socials":{"github":"https://github.com/satvik-vs","twitter":"https://twitter.com/SatvikVemulap2","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"instagram":{"icon":"fab fa-instagram","link":"https://instagram.com/satvikshetty"}}}}},"next_post":{"title":"Nmap Advanced Port Scans","uid":"cea3414c622367bb74c9fe88dd9fca82","slug":"Nmap-Advanced-Port-Scans","date":"2024-05-16T15:27:44.000Z","updated":"2024-05-17T16:08:17.345Z","comments":true,"path":"api/articles/Nmap-Advanced-Port-Scans.json","keywords":null,"cover":"https://tryhackme-images.s3.amazonaws.com/room-icons/4c839414544f794b63aafc6ed841848b.png","text":"Cheatsheet of the commands used in this room Port Scan Type Example Command TCP ...","permalink":"/post/Nmap-Advanced-Port-Scans","photos":[],"count_time":{"symbolsCount":"29k","symbolsTime":"27 mins."},"categories":[{"name":"cybersecurity","slug":"cybersecurity","count":11,"path":"api/categories/cybersecurity.json"},{"name":"THM","slug":"cybersecurity/THM","count":11,"path":"api/categories/cybersecurity/THM.json"},{"name":"NMAP","slug":"cybersecurity/THM/NMAP","count":3,"path":"api/categories/cybersecurity/THM/NMAP.json"}],"tags":[{"name":"tryhackme","slug":"tryhackme","count":11,"path":"api/tags/tryhackme.json"},{"name":"nmap","slug":"nmap","count":4,"path":"api/tags/nmap.json"},{"name":"information-gathering","slug":"information-gathering","count":4,"path":"api/tags/information-gathering.json"}],"author":{"name":"Satvik","slug":"blog-author","avatar":"https://media.licdn.com/dms/image/D5603AQHDAkzc5VpLcQ/profile-displayphoto-shrink_800_800/0/1708273426443?e=1721260800&v=beta&t=6mDy44GnhG2deGxjMd9TUFy-WKUpt7jNSNcdJD47uYc","link":"https://media.licdn.com/dms/image/D5603AQHDAkzc5VpLcQ/profile-displayphoto-shrink_800_800/0/1708273426443?e=1721260800&v=beta&t=6mDy44GnhG2deGxjMd9TUFy-WKUpt7jNSNcdJD47uYc","description":"An Aspiring Penetration Tester & a security Enthusiast 🚀 127.0.0.1 / sudo rm -rf / 😁 Dont Drink and Root 👀","socials":{"github":"https://github.com/satvik-vs","twitter":"https://twitter.com/SatvikVemulap2","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"instagram":{"icon":"fab fa-instagram","link":"https://instagram.com/satvikshetty"}}}}}}