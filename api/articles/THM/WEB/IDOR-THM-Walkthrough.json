{"title":"IDOR - THM Walkthrough","uid":"3e8a6fee12ff22738278818798983478","slug":"THM/WEB/IDOR-THM-Walkthrough","date":"2024-06-04T09:53:27.000Z","updated":"2024-06-04T10:38:16.185Z","comments":true,"path":"api/articles/THM/WEB/IDOR-THM-Walkthrough.json","keywords":null,"cover":"https://tryhackme-images.s3.amazonaws.com/room-icons/92b349206a2901c187e32ad074eae45c.png","content":"<p><strong>Hello Hackers</strong> üíå<br><strong>Today we are gonna walkthrough a new room in <code>Web Fundamentals</code> called <code>IDOR</code> on #TryHackMe</strong><br><strong>Lets start</strong> üöÄ</p>\n<a href=\"https://notes.satvik.live/web-fundamentals-path/idor-room/\" style=\"text-decoration:none;\">\n  <button style=\"\n    background: linear-gradient(90deg, rgba(0,123,255,1) 0%, rgba(0,102,204,1) 100%);\n    border: none; /* Remove borders */\n    color: white; /* White text */\n    padding: 10px 20px; /* Some padding */\n    text-align: center; /* Centered text */\n    text-decoration: none; /* Remove underline */\n    display: flex; /* Use flexbox */\n    align-items: center; /* Center items vertically */\n    justify-content: center; /* Center items horizontally */\n    font-size: 16px; /* Increase font size */\n    margin: 4px 2px; /* Add some margin */\n    cursor: pointer; /* Add a pointer on hover */\n    border-radius: 12px; /* Rounded corners */\n    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Add shadow */\n    transition: transform 0.2s; /* Animation for hover effect */\n    height: 40px; /* Fixed height for better alignment */\n  \" onmouseover=\"this.style.transform='scale(1.05)';\" onmouseout=\"this.style.transform='scale(1.0)';\">\n    View notes üëÄ\n  </button>\n</a>\n\n<h1 id=\"TASK-1-What-is-an-IDOR\"><a href=\"#TASK-1-What-is-an-IDOR\" class=\"headerlink\" title=\"TASK 1 - What is an IDOR\"></a>TASK 1 - What is an IDOR</h1><p>In this room, you‚Äôre going to learn what an IDOR vulnerability is, what they look like, how to find them and a practical task exploiting a real case scenario.</p>\n<p><strong>What is an IDOR?</strong></p>\n<p>IDOR stands for Insecure Direct Object Reference and is a type of access control vulnerability.</p>\n<p>This type of vulnerability can occur when a web server receives user-supplied input to retrieve objects (files, data, documents), too much trust has been placed on the input data, and it is not validated on the server-side to confirm the requested object belongs to the user requesting it.</p>\n<h2 id=\"Questions-and-answers-in-the-task\"><a href=\"#Questions-and-answers-in-the-task\" class=\"headerlink\" title=\"Questions and answers in the task\"></a>Questions and answers in the task</h2><p><strong>1. What does IDOR stand for?</strong><br>Answer: <code>Insecure Direct Object Reference</code></p>\n<h1 id=\"TASK-2-An-IDOR-Example\"><a href=\"#TASK-2-An-IDOR-Example\" class=\"headerlink\" title=\"TASK 2 - An IDOR Example\"></a>TASK 2 - An IDOR Example</h1><p>Imagine you‚Äôve just signed up for an online service, and you want to change your profile information. The link you click on goes to <a href=\"http://online-service.thm/profile?user_id=1305\">http://online-service.thm/profile?user_id=1305</a>, and you can see your information.</p>\n<p>Curiosity gets the better of you, and you try changing the user_id value to 1000 instead (<a href=\"http://online-service.thm/profile?user_id=1000\">http://online-service.thm/profile?user_id=1000</a>), and to your surprise, you can now see another user‚Äôs information. You‚Äôve now discovered an IDOR vulnerability! Ideally, there should be a check on the website to confirm that the user information belongs to the user logged requesting it.</p>\n<p>Using what you‚Äôve learnt above, click on the View Site button and try and receive a flag by discovering and exploiting an IDOR vulnerability</p>\n<p><em>Click on View Site</em></p>\n<h2 id=\"Questions-and-Answers-in-the-task\"><a href=\"#Questions-and-Answers-in-the-task\" class=\"headerlink\" title=\"Questions and Answers in the task\"></a>Questions and Answers in the task</h2><p><strong>1. What is the Flag from the IDOR example website?</strong><br>Answer: </p>\n<ul>\n<li>click on view site button</li>\n<li>go through the mails and analyze the link structure</li>\n</ul>\n<p><img src=\"https://dl.dropbox.com/scl/fi/58catl2ayt65v0xyft4ez/t2-1.png?rlkey=enj7qw3f0vj81axzirtflrf1x&st=cne51cm0&dl=0\" alt=\"t2 1\"></p>\n<ul>\n<li>The link in the second mail could be an IDOR , because it‚Äôs having order ID in the URL . Lets dive into it</li>\n<li>click on the link and try to change the ORDER ID to 1000 from 1234</li>\n</ul>\n<p><img src=\"https://dl.dropbox.com/scl/fi/1rhbit4vbn777wbagjqhu/t2-2.png?rlkey=crq2gj7jut2p07kmgpa119npn&st=t9v80tjp&dl=0\" alt=\"t2 2\"></p>\n<ul>\n<li>Hurray ! We have succesfully exploited an IDOR Vulnerability in the site</li>\n<li>Flag : <code>THM&#123;IDOR-VULN-FOUND&#125;</code></li>\n</ul>\n<h1 id=\"TASK-3-Finding-IDORs-in-Encoded-IDs\"><a href=\"#TASK-3-Finding-IDORs-in-Encoded-IDs\" class=\"headerlink\" title=\"TASK 3 - Finding IDORs in Encoded IDs\"></a>TASK 3 - Finding IDORs in Encoded IDs</h1><p><strong>Encoded IDs</strong><br>When passing data from page to page either by post data, query strings, or cookies, web developers will often first take the raw data and encode it. Encoding ensures that the receiving web server will be able to understand the contents. Encoding changes binary data into an ASCII string commonly using the <code>a-z, A-Z, 0-9 and =</code> character for padding. The most common encoding technique on the web is base64 encoding and can usually be pretty easy to spot. You can use websites like <code>https://www.base64decode.org/</code> to decode the string, then edit the data and re-encode it again using <code>https://www.base64encode.org/</code> and then resubmit the web request to see if there is a change in the response.</p>\n<p>See the image below as a graphical example of this process:</p>\n<p><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/5f2cbe5c4ab4a274420bc9a9afc9202d.png\" alt=\"img\"></p>\n<h2 id=\"Questins-and-Answers-in-the-Task\"><a href=\"#Questins-and-Answers-in-the-Task\" class=\"headerlink\" title=\"Questins and Answers in the Task\"></a>Questins and Answers in the Task</h2><p><strong>1. What is a common type of encoding used by websites?</strong><br>Answer: <code>base64</code></p>\n<h1 id=\"TASK-4-Finding-IDORs-in-Hashed-IDs\"><a href=\"#TASK-4-Finding-IDORs-in-Hashed-IDs\" class=\"headerlink\" title=\"TASK 4 - Finding IDORs in Hashed IDs\"></a>TASK 4 - Finding IDORs in Hashed IDs</h1><p><strong>Hashed IDs</strong></p>\n<p>Hashed IDs are a little bit more complicated to deal with than encoded ones, but they may follow a predictable pattern, such as being the hashed version of the integer value. For example, the Id number 123 would become 202cb962ac59075b964b07152d234b70 if md5 hashing were in use.</p>\n<p>It‚Äôs worthwhile putting any discovered hashes through a web service such as <a href=\"https://crackstation.net/\">https://crackstation.net/</a> (which has a database of billions of hash to value results) to see if we can find any matches.</p>\n<h2 id=\"Questions-and-Answers-in-te-Task\"><a href=\"#Questions-and-Answers-in-te-Task\" class=\"headerlink\" title=\"Questions and Answers in te Task\"></a>Questions and Answers in te Task</h2><p><strong>1. What is a common algorithm used for hashing IDs?</strong><br>Answer: <code>MD5</code></p>\n<h1 id=\"TASK-5-Finding-IDORs-in-Unpredictable-IDs\"><a href=\"#TASK-5-Finding-IDORs-in-Unpredictable-IDs\" class=\"headerlink\" title=\"TASK 5 - Finding IDORs in Unpredictable IDs\"></a>TASK 5 - Finding IDORs in Unpredictable IDs</h1><p><strong>Unpredictable IDs</strong></p>\n<p>If the Id cannot be detected using the above methods, an excellent method of IDOR detection is to create two accounts and swap the Id numbers between them. If you can view the other users‚Äô content using their Id number while still being logged in with a different account (or not logged in at all), you‚Äôve found a valid IDOR vulnerability.</p>\n<h2 id=\"Answer-the-questions-below\"><a href=\"#Answer-the-questions-below\" class=\"headerlink\" title=\"Answer the questions below\"></a>Answer the questions below</h2><p><strong>1. What is the minimum number of accounts you need to create to check for IDORs between accounts?</strong><br>Answer: <code>2</code></p>\n<h1 id=\"TASK-6-Where-are-IDORs-located\"><a href=\"#TASK-6-Where-are-IDORs-located\" class=\"headerlink\" title=\"TASK 6 - Where are IDORs located\"></a>TASK 6 - Where are IDORs located</h1><p><strong>Where are they located?</strong></p>\n<p>The vulnerable endpoint you‚Äôre targeting may not always be something you see in the address bar. It could be content your browser loads in via an AJAX request or something that you find referenced in a JavaScript file. </p>\n<p>Sometimes endpoints could have an unreferenced parameter that may have been of some use during development and got pushed to production. For example, you may notice a call to <code>/user/details</code> displaying your user information (authenticated through your session). But through an attack known as parameter mining, you discover a parameter called user_id that you can use to display other users‚Äô information, for example, <code>/user/details?user_id=123</code>.</p>\n<h1 id=\"TASK-7-A-Practical-IDOR-Example\"><a href=\"#TASK-7-A-Practical-IDOR-Example\" class=\"headerlink\" title=\"TASK 7 - A Practical IDOR Example\"></a>TASK 7 - A Practical IDOR Example</h1><p>Begin by pressing the Start Machine button; once started, click the below link and open it in a new browser tab:</p>\n<p><a href=\"https://10-10-23-47.p.thmlabs.com/\">https://10-10-23-47.p.thmlabs.com</a></p>\n<p>Firstly you‚Äôll need to log in. To do this, click on the customer‚Äôs section and create an account. Once logged in, click on the Your Account tab. </p>\n<p>The Your Account section gives you the ability to change your information such as username, email address and password. You‚Äôll notice the username and email fields pre-filled in with your information.  </p>\n<p>We‚Äôll start by investigating how this information gets pre-filled. If you open your browser developer tools, select the network tab and then refresh the page, you‚Äôll see a call to an endpoint with the path <code>/api/v1/customer?id=&#123;user_id&#125;.</code></p>\n<p>This page returns in JSON format your user id, username and email address. We can see from the path that the user information shown is taken from the query string‚Äôs id parameter (see below image).</p>\n<p><img src=\"https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/5d71d3fe747a8c8934564feddfc69f75.png\" alt=\"i\"></p>\n<p>You can try testing this id parameter for an IDOR vulnerability by changing the id to another user‚Äôs id. Try selecting users with IDs 1 and 3 and then answer the questions below.</p>\n<h2 id=\"Questions-and-ANswers-in-the-Task\"><a href=\"#Questions-and-ANswers-in-the-Task\" class=\"headerlink\" title=\"Questions and ANswers in the Task\"></a>Questions and ANswers in the Task</h2><p><strong>1. What is the username for user id 1?</strong><br>Answer:</p>\n<ul>\n<li>To know the user name of used id 1 , we need to go to network tab in developer tools </li>\n<li>select the USER ID Field and open it in new tab</li>\n</ul>\n<p><img src=\"https://dl.dropbox.com/scl/fi/gp0vsxes911s6yxob3hvu/t7-1.png?rlkey=mlkaxbhv8lx9xymjfq2cqip74&st=nhy1stdr&dl=0\" alt=\"t7 1\"></p>\n<ul>\n<li>Now change the user id to 1 in the link opened in new tab</li>\n</ul>\n<p><img src=\"https://dl.dropbox.com/scl/fi/qwa0vg1jnl7bv9dn01tfs/t7-2.png?rlkey=squf91yjwrwzo4zrtdjzigq4f&st=3r1y6shv&dl=0\" alt=\"t7 2\"></p>\n<ul>\n<li>We can see the details of with USER ID : 1 </li>\n<li>Name : <code>adam84</code></li>\n</ul>\n<p><strong>2. What is the email address for user id 3?</strong></p>\n<p>Answer:</p>\n<ul>\n<li>Just change the user ID to <em>3</em> in the URL</li>\n</ul>\n<p><img src=\"https://dl.dropbox.com/scl/fi/p3s8p09xcbfvtyq2xqbve/t7-3.png?rlkey=c0bhoznrw5rgvz3riwc88lzbf&st=yi91si94&dl=0\" alt=\" t7 3\"></p>\n<ul>\n<li>Email : <code>j@fakemail.thm</code></li>\n</ul>\n<p><strong>Thank You</strong> üíå<br><strong>Author:</strong> <code>Satvik Shetty</code>üßë‚Äçüíª<br><strong>See you again in another writeup</strong></p>\n","text":"Hello Hackers üíåToday we are gonna walkthrough a new room in Web Fundamentals cal...","permalink":"/post/THM/WEB/IDOR-THM-Walkthrough","photos":[],"count_time":{"symbolsCount":"6.5k","symbolsTime":"6 mins."},"categories":[{"name":"cybersecurity","slug":"cybersecurity","count":19,"path":"api/categories/cybersecurity.json"},{"name":"THM","slug":"cybersecurity/THM","count":18,"path":"api/categories/cybersecurity/THM.json"},{"name":"web","slug":"cybersecurity/THM/web","count":12,"path":"api/categories/cybersecurity/THM/web.json"}],"tags":[{"name":"tryhackme","slug":"tryhackme","count":18,"path":"api/tags/tryhackme.json"},{"name":"web","slug":"web","count":12,"path":"api/tags/web.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#TASK-1-What-is-an-IDOR\"><span class=\"toc-text\">TASK 1 - What is an IDOR</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Questions-and-answers-in-the-task\"><span class=\"toc-text\">Questions and answers in the task</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#TASK-2-An-IDOR-Example\"><span class=\"toc-text\">TASK 2 - An IDOR Example</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Questions-and-Answers-in-the-task\"><span class=\"toc-text\">Questions and Answers in the task</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#TASK-3-Finding-IDORs-in-Encoded-IDs\"><span class=\"toc-text\">TASK 3 - Finding IDORs in Encoded IDs</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Questins-and-Answers-in-the-Task\"><span class=\"toc-text\">Questins and Answers in the Task</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#TASK-4-Finding-IDORs-in-Hashed-IDs\"><span class=\"toc-text\">TASK 4 - Finding IDORs in Hashed IDs</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Questions-and-Answers-in-te-Task\"><span class=\"toc-text\">Questions and Answers in te Task</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#TASK-5-Finding-IDORs-in-Unpredictable-IDs\"><span class=\"toc-text\">TASK 5 - Finding IDORs in Unpredictable IDs</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Answer-the-questions-below\"><span class=\"toc-text\">Answer the questions below</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#TASK-6-Where-are-IDORs-located\"><span class=\"toc-text\">TASK 6 - Where are IDORs located</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#TASK-7-A-Practical-IDOR-Example\"><span class=\"toc-text\">TASK 7 - A Practical IDOR Example</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Questions-and-ANswers-in-the-Task\"><span class=\"toc-text\">Questions and ANswers in the Task</span></a></li></ol></li></ol>","author":{"name":"Satvik","slug":"blog-author","avatar":"https://dl.dropbox.com/scl/fi/00hpz9sf96v4gugpvx7t9/profile.jpg?rlkey=yet0g0rb9ofkl806vvhmkjail&st=3rw0pj88&dl=0","link":"https://dl.dropbox.com/scl/fi/00hpz9sf96v4gugpvx7t9/profile.jpg?rlkey=yet0g0rb9ofkl806vvhmkjail&st=3rw0pj88&dl=0","description":"An Aspiring Penetration Tester & a security Enthusiast üöÄ 127.0.0.1 / sudo rm -rf / üòÅ Dont Drink and Root üëÄ","socials":{"github":"https://github.com/satvik-vs","twitter":"https://twitter.com/SatvikVemulap2","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"instagram":{"icon":"fab fa-instagram","link":"https://instagram.com/satvikshetty"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"SSRF Walkthrough - THM","uid":"6937fd4b35dfe494a27e1637f94b0a2f","slug":"THM/WEB/SSRF-Walkthrough-THM","date":"2024-06-07T13:14:36.000Z","updated":"2024-06-07T17:30:48.641Z","comments":true,"path":"api/articles/THM/WEB/SSRF-Walkthrough-THM.json","keywords":null,"cover":"https://tryhackme-images.s3.amazonaws.com/room-icons/268e10b8ee0b53d1074b2a7fd5b1a789.png","text":"Hello Hackers üíåToday we are gonna walkthrough a new room in Web Fundamentals cal...","permalink":"/post/THM/WEB/SSRF-Walkthrough-THM","photos":[],"count_time":{"symbolsCount":"8.8k","symbolsTime":"8 mins."},"categories":[{"name":"cybersecurity","slug":"cybersecurity","count":19,"path":"api/categories/cybersecurity.json"},{"name":"THM","slug":"cybersecurity/THM","count":18,"path":"api/categories/cybersecurity/THM.json"},{"name":"web","slug":"cybersecurity/THM/web","count":12,"path":"api/categories/cybersecurity/THM/web.json"}],"tags":[{"name":"tryhackme","slug":"tryhackme","count":18,"path":"api/tags/tryhackme.json"},{"name":"web","slug":"web","count":12,"path":"api/tags/web.json"}],"author":{"name":"Satvik","slug":"blog-author","avatar":"https://dl.dropbox.com/scl/fi/00hpz9sf96v4gugpvx7t9/profile.jpg?rlkey=yet0g0rb9ofkl806vvhmkjail&st=3rw0pj88&dl=0","link":"https://dl.dropbox.com/scl/fi/00hpz9sf96v4gugpvx7t9/profile.jpg?rlkey=yet0g0rb9ofkl806vvhmkjail&st=3rw0pj88&dl=0","description":"An Aspiring Penetration Tester & a security Enthusiast üöÄ 127.0.0.1 / sudo rm -rf / üòÅ Dont Drink and Root üëÄ","socials":{"github":"https://github.com/satvik-vs","twitter":"https://twitter.com/SatvikVemulap2","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"instagram":{"icon":"fab fa-instagram","link":"https://instagram.com/satvikshetty"}}}}},"next_post":{"title":"Authentication Bypass - THM Walkthrough","uid":"b98fdad01f5200d25c912ff8eb29e414","slug":"THM/WEB/Authentication-Bypass-THM-Walkthrough","date":"2024-06-03T10:20:32.000Z","updated":"2024-06-11T10:09:19.402Z","comments":true,"path":"api/articles/THM/WEB/Authentication-Bypass-THM-Walkthrough.json","keywords":null,"cover":"https://tryhackme-images.s3.amazonaws.com/room-icons/098ee61b8842b7e6fc27e9eea9d7e1dc.png","text":"Hello Hackers üíåToday we are going to walkthrough a new room called Authenticatio...","permalink":"/post/THM/WEB/Authentication-Bypass-THM-Walkthrough","photos":[],"count_time":{"symbolsCount":"15k","symbolsTime":"14 mins."},"categories":[{"name":"cybersecurity","slug":"cybersecurity","count":19,"path":"api/categories/cybersecurity.json"},{"name":"THM","slug":"cybersecurity/THM","count":18,"path":"api/categories/cybersecurity/THM.json"},{"name":"web","slug":"cybersecurity/THM/web","count":12,"path":"api/categories/cybersecurity/THM/web.json"}],"tags":[{"name":"tryhackme","slug":"tryhackme","count":18,"path":"api/tags/tryhackme.json"},{"name":"web","slug":"web","count":12,"path":"api/tags/web.json"}],"author":{"name":"Satvik","slug":"blog-author","avatar":"https://dl.dropbox.com/scl/fi/00hpz9sf96v4gugpvx7t9/profile.jpg?rlkey=yet0g0rb9ofkl806vvhmkjail&st=3rw0pj88&dl=0","link":"https://dl.dropbox.com/scl/fi/00hpz9sf96v4gugpvx7t9/profile.jpg?rlkey=yet0g0rb9ofkl806vvhmkjail&st=3rw0pj88&dl=0","description":"An Aspiring Penetration Tester & a security Enthusiast üöÄ 127.0.0.1 / sudo rm -rf / üòÅ Dont Drink and Root üëÄ","socials":{"github":"https://github.com/satvik-vs","twitter":"https://twitter.com/SatvikVemulap2","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"instagram":{"icon":"fab fa-instagram","link":"https://instagram.com/satvikshetty"}}}}}}